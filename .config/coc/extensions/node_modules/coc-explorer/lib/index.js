var ub=Object.create;var ui=Object.defineProperty,db=Object.defineProperties,pb=Object.getOwnPropertyDescriptor,mb=Object.getOwnPropertyDescriptors,hb=Object.getOwnPropertyNames,Of=Object.getOwnPropertySymbols,gb=Object.getPrototypeOf,Af=Object.prototype.hasOwnProperty,wb=Object.prototype.propertyIsEnumerable;var Pf=(t,e,r)=>e in t?ui(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,S=(t,e)=>{for(var r in e||(e={}))Af.call(e,r)&&Pf(t,r,e[r]);if(Of)for(var r of Of(e))wb.call(e,r)&&Pf(t,r,e[r]);return t},U=(t,e)=>db(t,mb(e));var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),xb=(t,e)=>{for(var r in e)ui(t,r,{get:e[r],enumerable:!0})},_f=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of hb(e))!Af.call(t,i)&&i!==r&&ui(t,i,{get:()=>e[i],enumerable:!(o=pb(e,i))||o.enumerable});return t};var _=(t,e,r)=>(r=t!=null?ub(gb(t)):{},_f(e||!t||!t.__esModule?ui(r,"default",{value:t,enumerable:!0}):r,t)),bb=t=>_f(ui({},"__esModule",{value:!0}),t);var Mf=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var kf=(t,e,r)=>(Mf(t,e,"read from private field"),r?r.call(t):e.get(t)),Rf=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Lf=(t,e,r,o)=>(Mf(t,e,"write to private field"),o?o.call(t,r):e.set(t,r),r);var Hp=L((A,jp)=>{A=jp.exports=M;var $;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?$=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:$=function(){};A.SEMVER_SPEC_VERSION="2.0.0";var Js=256,Kn=Number.MAX_SAFE_INTEGER||9007199254740991,Qs=16,F=A.re=[],y=A.src=[],w=A.tokens={},Wp=0;function k(t){w[t]=Wp++}k("NUMERICIDENTIFIER");y[w.NUMERICIDENTIFIER]="0|[1-9]\\d*";k("NUMERICIDENTIFIERLOOSE");y[w.NUMERICIDENTIFIERLOOSE]="[0-9]+";k("NONNUMERICIDENTIFIER");y[w.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";k("MAINVERSION");y[w.MAINVERSION]="("+y[w.NUMERICIDENTIFIER]+")\\.("+y[w.NUMERICIDENTIFIER]+")\\.("+y[w.NUMERICIDENTIFIER]+")";k("MAINVERSIONLOOSE");y[w.MAINVERSIONLOOSE]="("+y[w.NUMERICIDENTIFIERLOOSE]+")\\.("+y[w.NUMERICIDENTIFIERLOOSE]+")\\.("+y[w.NUMERICIDENTIFIERLOOSE]+")";k("PRERELEASEIDENTIFIER");y[w.PRERELEASEIDENTIFIER]="(?:"+y[w.NUMERICIDENTIFIER]+"|"+y[w.NONNUMERICIDENTIFIER]+")";k("PRERELEASEIDENTIFIERLOOSE");y[w.PRERELEASEIDENTIFIERLOOSE]="(?:"+y[w.NUMERICIDENTIFIERLOOSE]+"|"+y[w.NONNUMERICIDENTIFIER]+")";k("PRERELEASE");y[w.PRERELEASE]="(?:-("+y[w.PRERELEASEIDENTIFIER]+"(?:\\."+y[w.PRERELEASEIDENTIFIER]+")*))";k("PRERELEASELOOSE");y[w.PRERELEASELOOSE]="(?:-?("+y[w.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+y[w.PRERELEASEIDENTIFIERLOOSE]+")*))";k("BUILDIDENTIFIER");y[w.BUILDIDENTIFIER]="[0-9A-Za-z-]+";k("BUILD");y[w.BUILD]="(?:\\+("+y[w.BUILDIDENTIFIER]+"(?:\\."+y[w.BUILDIDENTIFIER]+")*))";k("FULL");k("FULLPLAIN");y[w.FULLPLAIN]="v?"+y[w.MAINVERSION]+y[w.PRERELEASE]+"?"+y[w.BUILD]+"?";y[w.FULL]="^"+y[w.FULLPLAIN]+"$";k("LOOSEPLAIN");y[w.LOOSEPLAIN]="[v=\\s]*"+y[w.MAINVERSIONLOOSE]+y[w.PRERELEASELOOSE]+"?"+y[w.BUILD]+"?";k("LOOSE");y[w.LOOSE]="^"+y[w.LOOSEPLAIN]+"$";k("GTLT");y[w.GTLT]="((?:<|>)?=?)";k("XRANGEIDENTIFIERLOOSE");y[w.XRANGEIDENTIFIERLOOSE]=y[w.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";k("XRANGEIDENTIFIER");y[w.XRANGEIDENTIFIER]=y[w.NUMERICIDENTIFIER]+"|x|X|\\*";k("XRANGEPLAIN");y[w.XRANGEPLAIN]="[v=\\s]*("+y[w.XRANGEIDENTIFIER]+")(?:\\.("+y[w.XRANGEIDENTIFIER]+")(?:\\.("+y[w.XRANGEIDENTIFIER]+")(?:"+y[w.PRERELEASE]+")?"+y[w.BUILD]+"?)?)?";k("XRANGEPLAINLOOSE");y[w.XRANGEPLAINLOOSE]="[v=\\s]*("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+y[w.XRANGEIDENTIFIERLOOSE]+")(?:"+y[w.PRERELEASELOOSE]+")?"+y[w.BUILD]+"?)?)?";k("XRANGE");y[w.XRANGE]="^"+y[w.GTLT]+"\\s*"+y[w.XRANGEPLAIN]+"$";k("XRANGELOOSE");y[w.XRANGELOOSE]="^"+y[w.GTLT]+"\\s*"+y[w.XRANGEPLAINLOOSE]+"$";k("COERCE");y[w.COERCE]="(^|[^\\d])(\\d{1,"+Qs+"})(?:\\.(\\d{1,"+Qs+"}))?(?:\\.(\\d{1,"+Qs+"}))?(?:$|[^\\d])";k("COERCERTL");F[w.COERCERTL]=new RegExp(y[w.COERCE],"g");k("LONETILDE");y[w.LONETILDE]="(?:~>?)";k("TILDETRIM");y[w.TILDETRIM]="(\\s*)"+y[w.LONETILDE]+"\\s+";F[w.TILDETRIM]=new RegExp(y[w.TILDETRIM],"g");var NS="$1~";k("TILDE");y[w.TILDE]="^"+y[w.LONETILDE]+y[w.XRANGEPLAIN]+"$";k("TILDELOOSE");y[w.TILDELOOSE]="^"+y[w.LONETILDE]+y[w.XRANGEPLAINLOOSE]+"$";k("LONECARET");y[w.LONECARET]="(?:\\^)";k("CARETTRIM");y[w.CARETTRIM]="(\\s*)"+y[w.LONECARET]+"\\s+";F[w.CARETTRIM]=new RegExp(y[w.CARETTRIM],"g");var TS="$1^";k("CARET");y[w.CARET]="^"+y[w.LONECARET]+y[w.XRANGEPLAIN]+"$";k("CARETLOOSE");y[w.CARETLOOSE]="^"+y[w.LONECARET]+y[w.XRANGEPLAINLOOSE]+"$";k("COMPARATORLOOSE");y[w.COMPARATORLOOSE]="^"+y[w.GTLT]+"\\s*("+y[w.LOOSEPLAIN]+")$|^$";k("COMPARATOR");y[w.COMPARATOR]="^"+y[w.GTLT]+"\\s*("+y[w.FULLPLAIN]+")$|^$";k("COMPARATORTRIM");y[w.COMPARATORTRIM]="(\\s*)"+y[w.GTLT]+"\\s*("+y[w.LOOSEPLAIN]+"|"+y[w.XRANGEPLAIN]+")";F[w.COMPARATORTRIM]=new RegExp(y[w.COMPARATORTRIM],"g");var SS="$1$2$3";k("HYPHENRANGE");y[w.HYPHENRANGE]="^\\s*("+y[w.XRANGEPLAIN]+")\\s+-\\s+("+y[w.XRANGEPLAIN]+")\\s*$";k("HYPHENRANGELOOSE");y[w.HYPHENRANGELOOSE]="^\\s*("+y[w.XRANGEPLAINLOOSE]+")\\s+-\\s+("+y[w.XRANGEPLAINLOOSE]+")\\s*$";k("STAR");y[w.STAR]="(<|>)?=?\\s*\\*";for(Ut=0;Ut<Wp;Ut++)$(Ut,y[Ut]),F[Ut]||(F[Ut]=new RegExp(y[Ut]));var Ut;A.parse=Ar;function Ar(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof M)return t;if(typeof t!="string"||t.length>Js)return null;var r=e.loose?F[w.LOOSE]:F[w.FULL];if(!r.test(t))return null;try{return new M(t,e)}catch{return null}}A.valid=CS;function CS(t,e){var r=Ar(t,e);return r?r.version:null}A.clean=IS;function IS(t,e){var r=Ar(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}A.SemVer=M;function M(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof M){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>Js)throw new TypeError("version is longer than "+Js+" characters");if(!(this instanceof M))return new M(t,e);$("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?F[w.LOOSE]:F[w.FULL]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Kn||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Kn||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Kn||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(o){if(/^[0-9]+$/.test(o)){var i=+o;if(i>=0&&i<Kn)return i}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}M.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};M.prototype.toString=function(){return this.version};M.prototype.compare=function(t){return $("SemVer.compare",this.version,this.options,t),t instanceof M||(t=new M(t,this.options)),this.compareMain(t)||this.comparePre(t)};M.prototype.compareMain=function(t){return t instanceof M||(t=new M(t,this.options)),Pr(this.major,t.major)||Pr(this.minor,t.minor)||Pr(this.patch,t.patch)};M.prototype.comparePre=function(t){if(t instanceof M||(t=new M(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],o=t.prerelease[e];if($("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return Pr(r,o)}while(++e)};M.prototype.compareBuild=function(t){t instanceof M||(t=new M(t,this.options));var e=0;do{var r=this.build[e],o=t.build[e];if($("prerelease compare",e,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r===o)continue;return Pr(r,o)}while(++e)};M.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};A.inc=OS;function OS(t,e,r,o){typeof r=="string"&&(o=r,r=void 0);try{return new M(t,r).inc(e,o).version}catch{return null}}A.diff=PS;function PS(t,e){if(Zs(t,e))return null;var r=Ar(t),o=Ar(e),i="";if(r.prerelease.length||o.prerelease.length){i="pre";var n="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==o[a])return i+a;return n}A.compareIdentifiers=Pr;var Dp=/^[0-9]+$/;function Pr(t,e){var r=Dp.test(t),o=Dp.test(e);return r&&o&&(t=+t,e=+e),t===e?0:r&&!o?-1:o&&!r?1:t<e?-1:1}A.rcompareIdentifiers=AS;function AS(t,e){return Pr(e,t)}A.major=_S;function _S(t,e){return new M(t,e).major}A.minor=MS;function MS(t,e){return new M(t,e).minor}A.patch=kS;function kS(t,e){return new M(t,e).patch}A.compare=yt;function yt(t,e,r){return new M(t,r).compare(new M(e,r))}A.compareLoose=RS;function RS(t,e){return yt(t,e,!0)}A.compareBuild=LS;function LS(t,e,r){var o=new M(t,r),i=new M(e,r);return o.compare(i)||o.compareBuild(i)}A.rcompare=DS;function DS(t,e,r){return yt(e,t,r)}A.sort=BS;function BS(t,e){return t.sort(function(r,o){return A.compareBuild(r,o,e)})}A.rsort=WS;function WS(t,e){return t.sort(function(r,o){return A.compareBuild(o,r,e)})}A.gt=Pi;function Pi(t,e,r){return yt(t,e,r)>0}A.lt=Xn;function Xn(t,e,r){return yt(t,e,r)<0}A.eq=Zs;function Zs(t,e,r){return yt(t,e,r)===0}A.neq=Fp;function Fp(t,e,r){return yt(t,e,r)!==0}A.gte=el;function el(t,e,r){return yt(t,e,r)>=0}A.lte=tl;function tl(t,e,r){return yt(t,e,r)<=0}A.cmp=Qn;function Qn(t,e,r,o){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Zs(t,r,o);case"!=":return Fp(t,r,o);case">":return Pi(t,r,o);case">=":return el(t,r,o);case"<":return Xn(t,r,o);case"<=":return tl(t,r,o);default:throw new TypeError("Invalid operator: "+e)}}A.Comparator=He;function He(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof He){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof He))return new He(t,e);$("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===_o?this.value="":this.value=this.operator+this.semver.version,$("comp",this)}var _o={};He.prototype.parse=function(t){var e=this.options.loose?F[w.COMPARATORLOOSE]:F[w.COMPARATOR],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new M(r[2],this.options.loose):this.semver=_o};He.prototype.toString=function(){return this.value};He.prototype.test=function(t){if($("Comparator.test",t,this.options.loose),this.semver===_o||t===_o)return!0;if(typeof t=="string")try{t=new M(t,this.options)}catch{return!1}return Qn(t,this.operator,this.semver,this.options)};He.prototype.intersects=function(t,e){if(!(t instanceof He))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return this.value===""?!0:(r=new re(t.value,e),Jn(this.value,r,e));if(t.operator==="")return t.value===""?!0:(r=new re(this.value,e),Jn(t.semver,r,e));var o=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),n=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=Qn(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),l=Qn(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return o||i||n&&a||s||l};A.Range=re;function re(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof re)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new re(t.raw,e);if(t instanceof He)return new re(t.value,e);if(!(this instanceof re))return new re(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}re.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};re.prototype.toString=function(){return this.range};re.prototype.parseRange=function(t){var e=this.options.loose;t=t.trim();var r=e?F[w.HYPHENRANGELOOSE]:F[w.HYPHENRANGE];t=t.replace(r,zS),$("hyphen replace",t),t=t.replace(F[w.COMPARATORTRIM],SS),$("comparator trim",t,F[w.COMPARATORTRIM]),t=t.replace(F[w.TILDETRIM],NS),t=t.replace(F[w.CARETTRIM],TS),t=t.split(/\s+/).join(" ");var o=e?F[w.COMPARATORLOOSE]:F[w.COMPARATOR],i=t.split(" ").map(function(n){return jS(n,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(n){return!!n.match(o)})),i=i.map(function(n){return new He(n,this.options)},this),i};re.prototype.intersects=function(t,e){if(!(t instanceof re))throw new TypeError("a Range is required");return this.set.some(function(r){return Bp(r,e)&&t.set.some(function(o){return Bp(o,e)&&r.every(function(i){return o.every(function(n){return i.intersects(n,e)})})})})};function Bp(t,e){for(var r=!0,o=t.slice(),i=o.pop();r&&o.length;)r=o.every(function(n){return i.intersects(n,e)}),i=o.pop();return r}A.toComparators=FS;function FS(t,e){return new re(t,e).set.map(function(r){return r.map(function(o){return o.value}).join(" ").trim().split(" ")})}function jS(t,e){return $("comp",t,e),t=GS(t,e),$("caret",t),t=HS(t,e),$("tildes",t),t=qS(t,e),$("xrange",t),t=YS(t,e),$("stars",t),t}function Oe(t){return!t||t.toLowerCase()==="x"||t==="*"}function HS(t,e){return t.trim().split(/\s+/).map(function(r){return $S(r,e)}).join(" ")}function $S(t,e){var r=e.loose?F[w.TILDELOOSE]:F[w.TILDE];return t.replace(r,function(o,i,n,a,s){$("tilde",t,o,i,n,a,s);var l;return Oe(i)?l="":Oe(n)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Oe(a)?l=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":s?($("replaceTilde pr",s),l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+(+n+1)+".0"):l=">="+i+"."+n+"."+a+" <"+i+"."+(+n+1)+".0",$("tilde return",l),l})}function GS(t,e){return t.trim().split(/\s+/).map(function(r){return US(r,e)}).join(" ")}function US(t,e){$("caret",t,e);var r=e.loose?F[w.CARETLOOSE]:F[w.CARET];return t.replace(r,function(o,i,n,a,s){$("caret",t,o,i,n,a,s);var l;return Oe(i)?l="":Oe(n)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Oe(a)?i==="0"?l=">="+i+"."+n+".0 <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+".0 <"+(+i+1)+".0.0":s?($("replaceCaret pr",s),i==="0"?n==="0"?l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+n+"."+(+a+1):l=">="+i+"."+n+"."+a+"-"+s+" <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+"."+a+"-"+s+" <"+(+i+1)+".0.0"):($("no pr"),i==="0"?n==="0"?l=">="+i+"."+n+"."+a+" <"+i+"."+n+"."+(+a+1):l=">="+i+"."+n+"."+a+" <"+i+"."+(+n+1)+".0":l=">="+i+"."+n+"."+a+" <"+(+i+1)+".0.0"),$("caret return",l),l})}function qS(t,e){return $("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return VS(r,e)}).join(" ")}function VS(t,e){t=t.trim();var r=e.loose?F[w.XRANGELOOSE]:F[w.XRANGE];return t.replace(r,function(o,i,n,a,s,l){$("xRange",t,o,i,n,a,s,l);var c=Oe(n),f=c||Oe(a),u=f||Oe(s),d=u;return i==="="&&d&&(i=""),l=e.includePrerelease?"-0":"",c?i===">"||i==="<"?o="<0.0.0-0":o="*":i&&d?(f&&(a=0),s=0,i===">"?(i=">=",f?(n=+n+1,a=0,s=0):(a=+a+1,s=0)):i==="<="&&(i="<",f?n=+n+1:a=+a+1),o=i+n+"."+a+"."+s+l):f?o=">="+n+".0.0"+l+" <"+(+n+1)+".0.0"+l:u&&(o=">="+n+"."+a+".0"+l+" <"+n+"."+(+a+1)+".0"+l),$("xRange return",o),o})}function YS(t,e){return $("replaceStars",t,e),t.trim().replace(F[w.STAR],"")}function zS(t,e,r,o,i,n,a,s,l,c,f,u,d){return Oe(r)?e="":Oe(o)?e=">="+r+".0.0":Oe(i)?e=">="+r+"."+o+".0":e=">="+e,Oe(l)?s="":Oe(c)?s="<"+(+l+1)+".0.0":Oe(f)?s="<"+l+"."+(+c+1)+".0":u?s="<="+l+"."+c+"."+f+"-"+u:s="<="+s,(e+" "+s).trim()}re.prototype.test=function(t){if(!t)return!1;if(typeof t=="string")try{t=new M(t,this.options)}catch{return!1}for(var e=0;e<this.set.length;e++)if(KS(this.set[e],t,this.options))return!0;return!1};function KS(t,e,r){for(var o=0;o<t.length;o++)if(!t[o].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(o=0;o<t.length;o++)if($(t[o].semver),t[o].semver!==_o&&t[o].semver.prerelease.length>0){var i=t[o].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}A.satisfies=Jn;function Jn(t,e,r){try{e=new re(e,r)}catch{return!1}return e.test(t)}A.maxSatisfying=XS;function XS(t,e,r){var o=null,i=null;try{var n=new re(e,r)}catch{return null}return t.forEach(function(a){n.test(a)&&(!o||i.compare(a)===-1)&&(o=a,i=new M(o,r))}),o}A.minSatisfying=QS;function QS(t,e,r){var o=null,i=null;try{var n=new re(e,r)}catch{return null}return t.forEach(function(a){n.test(a)&&(!o||i.compare(a)===1)&&(o=a,i=new M(o,r))}),o}A.minVersion=JS;function JS(t,e){t=new re(t,e);var r=new M("0.0.0");if(t.test(r)||(r=new M("0.0.0-0"),t.test(r)))return r;r=null;for(var o=0;o<t.set.length;++o){var i=t.set[o];i.forEach(function(n){var a=new M(n.semver.version);switch(n.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Pi(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+n.operator)}})}return r&&t.test(r)?r:null}A.validRange=ZS;function ZS(t,e){try{return new re(t,e).range||"*"}catch{return null}}A.ltr=eC;function eC(t,e,r){return rl(t,e,"<",r)}A.gtr=tC;function tC(t,e,r){return rl(t,e,">",r)}A.outside=rl;function rl(t,e,r,o){t=new M(t,o),e=new re(e,o);var i,n,a,s,l;switch(r){case">":i=Pi,n=tl,a=Xn,s=">",l=">=";break;case"<":i=Xn,n=el,a=Pi,s="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Jn(t,e,o))return!1;for(var c=0;c<e.set.length;++c){var f=e.set[c],u=null,d=null;if(f.forEach(function(p){p.semver===_o&&(p=new He(">=0.0.0")),u=u||p,d=d||p,i(p.semver,u.semver,o)?u=p:a(p.semver,d.semver,o)&&(d=p)}),u.operator===s||u.operator===l||(!d.operator||d.operator===s)&&n(t,d.semver))return!1;if(d.operator===l&&a(t,d.semver))return!1}return!0}A.prerelease=rC;function rC(t,e){var r=Ar(t,e);return r&&r.prerelease.length?r.prerelease:null}A.intersects=oC;function oC(t,e,r){return t=new re(t,r),e=new re(e,r),t.intersects(e)}A.coerce=iC;function iC(t,e){if(t instanceof M)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};var r=null;if(!e.rtl)r=t.match(F[w.COERCE]);else{for(var o;(o=F[w.COERCERTL].exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||o.index+o[0].length!==r.index+r[0].length)&&(r=o),F[w.COERCERTL].lastIndex=o.index+o[1].length+o[2].length;F[w.COERCERTL].lastIndex=-1}return r===null?null:Ar(r[2]+"."+(r[3]||"0")+"."+(r[4]||"0"),e)}});var Yp=L((nF,ol)=>{"use strict";var Zn=require("fs"),vt=require("path"),{promisify:$p}=require("util"),nC=Hp(),Gp=nC.satisfies(process.version,">=10.12.0"),Up=t=>{if(process.platform==="win32"&&/[<>:"|?*]/.test(t.replace(vt.parse(t).root,""))){let r=new Error(`Path contains invalid characters: ${t}`);throw r.code="EINVAL",r}},qp=t=>S(S({},{mode:511,fs:Zn}),t),Vp=t=>{let e=new Error(`operation not permitted, mkdir '${t}'`);return e.code="EPERM",e.errno=-4048,e.path=t,e.syscall="mkdir",e},aC=async(t,e)=>{Up(t),e=qp(e);let r=$p(e.fs.mkdir),o=$p(e.fs.stat);if(Gp&&e.fs.mkdir===Zn.mkdir){let n=vt.resolve(t);return await r(n,{mode:e.mode,recursive:!0}),n}let i=async n=>{try{return await r(n,e.mode),n}catch(a){if(a.code==="EPERM")throw a;if(a.code==="ENOENT"){if(vt.dirname(n)===n)throw Vp(n);if(a.message.includes("null bytes"))throw a;return await i(vt.dirname(n)),i(n)}try{if(!(await o(n)).isDirectory())throw new Error("The path is not a directory")}catch{throw a}return n}};return i(vt.resolve(t))};ol.exports=aC;ol.exports.sync=(t,e)=>{if(Up(t),e=qp(e),Gp&&e.fs.mkdirSync===Zn.mkdirSync){let o=vt.resolve(t);return Zn.mkdirSync(o,{mode:e.mode,recursive:!0}),o}let r=o=>{try{e.fs.mkdirSync(o,e.mode)}catch(i){if(i.code==="EPERM")throw i;if(i.code==="ENOENT"){if(vt.dirname(o)===o)throw Vp(o);if(i.message.includes("null bytes"))throw i;return r(vt.dirname(o)),r(o)}try{if(!e.fs.statSync(o).isDirectory())throw new Error("The path is not a directory")}catch{throw i}}return o};return r(vt.resolve(t))}});var zp=L(il=>{var _r=require("path"),Vt=process.platform==="win32",qt=require("fs"),sC=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function lC(){var t;if(sC){var e=new Error;t=r}else t=o;return t;function r(i){i&&(e.message=i.message,i=e,o(i))}function o(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var n="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(n):console.error(n)}}}}function cC(t){return typeof t=="function"?t:lC()}var aF=_r.normalize;Vt?Et=/(.*?)(?:[\/\\]+|$)/g:Et=/(.*?)(?:[\/]+|$)/g;var Et;Vt?Ai=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Ai=/^[\/]*/;var Ai;il.realpathSync=function(e,r){if(e=_r.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var o=e,i={},n={},a,s,l,c;f();function f(){var g=Ai.exec(e);a=g[0].length,s=g[0],l=g[0],c="",Vt&&!n[l]&&(qt.lstatSync(l),n[l]=!0)}for(;a<e.length;){Et.lastIndex=a;var u=Et.exec(e);if(c=s,s+=u[0],l=c+u[1],a=Et.lastIndex,!(n[l]||r&&r[l]===l)){var d;if(r&&Object.prototype.hasOwnProperty.call(r,l))d=r[l];else{var p=qt.lstatSync(l);if(!p.isSymbolicLink()){n[l]=!0,r&&(r[l]=l);continue}var m=null;if(!Vt){var h=p.dev.toString(32)+":"+p.ino.toString(32);i.hasOwnProperty(h)&&(m=i[h])}m===null&&(qt.statSync(l),m=qt.readlinkSync(l)),d=_r.resolve(c,m),r&&(r[l]=d),Vt||(i[h]=m)}e=_r.resolve(d,e.slice(a)),f()}}return r&&(r[o]=e),e};il.realpath=function(e,r,o){if(typeof o!="function"&&(o=cC(r),r=null),e=_r.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(o.bind(null,null,r[e]));var i=e,n={},a={},s,l,c,f;u();function u(){var g=Ai.exec(e);s=g[0].length,l=g[0],c=g[0],f="",Vt&&!a[c]?qt.lstat(c,function(x){if(x)return o(x);a[c]=!0,d()}):process.nextTick(d)}function d(){if(s>=e.length)return r&&(r[i]=e),o(null,e);Et.lastIndex=s;var g=Et.exec(e);return f=l,l+=g[0],c=f+g[1],s=Et.lastIndex,a[c]||r&&r[c]===c?process.nextTick(d):r&&Object.prototype.hasOwnProperty.call(r,c)?h(r[c]):qt.lstat(c,p)}function p(g,x){if(g)return o(g);if(!x.isSymbolicLink())return a[c]=!0,r&&(r[c]=c),process.nextTick(d);if(!Vt){var b=x.dev.toString(32)+":"+x.ino.toString(32);if(n.hasOwnProperty(b))return m(null,n[b],c)}qt.stat(c,function(T){if(T)return o(T);qt.readlink(c,function(I,H){Vt||(n[b]=H),m(I,H)})})}function m(g,x,b){if(g)return o(g);var T=_r.resolve(f,x);r&&(r[b]=T),h(T)}function h(g){e=_r.resolve(g,e.slice(s)),u()}}});var ll=L((lF,Jp)=>{Jp.exports=Yt;Yt.realpath=Yt;Yt.sync=sl;Yt.realpathSync=sl;Yt.monkeypatch=uC;Yt.unmonkeypatch=dC;var Mo=require("fs"),nl=Mo.realpath,al=Mo.realpathSync,fC=process.version,Kp=/^v[0-5]\./.test(fC),Xp=zp();function Qp(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function Yt(t,e,r){if(Kp)return nl(t,e,r);typeof e=="function"&&(r=e,e=null),nl(t,e,function(o,i){Qp(o)?Xp.realpath(t,e,r):r(o,i)})}function sl(t,e){if(Kp)return al(t,e);try{return al(t,e)}catch(r){if(Qp(r))return Xp.realpathSync(t,e);throw r}}function uC(){Mo.realpath=Yt,Mo.realpathSync=sl}function dC(){Mo.realpath=nl,Mo.realpathSync=al}});var em=L((cF,Zp)=>{Zp.exports=function(t,e){for(var r=[],o=0;o<t.length;o++){var i=e(t[o],o);pC(i)?r.push.apply(r,i):r.push(i)}return r};var pC=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var nm=L((fF,im)=>{"use strict";im.exports=rm;function rm(t,e,r){t instanceof RegExp&&(t=tm(t,r)),e instanceof RegExp&&(e=tm(e,r));var o=om(t,e,r);return o&&{start:o[0],end:o[1],pre:r.slice(0,o[0]),body:r.slice(o[0]+t.length,o[1]),post:r.slice(o[1]+e.length)}}function tm(t,e){var r=e.match(t);return r?r[0]:null}rm.range=om;function om(t,e,r){var o,i,n,a,s,l=r.indexOf(t),c=r.indexOf(e,l+1),f=l;if(l>=0&&c>0){if(t===e)return[l,c];for(o=[],n=r.length;f>=0&&!s;)f==l?(o.push(f),l=r.indexOf(t,f+1)):o.length==1?s=[o.pop(),c]:(i=o.pop(),i<n&&(n=i,a=c),c=r.indexOf(e,f+1)),f=l<c&&l>=0?l:c;o.length&&(s=[n,a])}return s}});var pm=L((uF,dm)=>{var mC=em(),am=nm();dm.exports=wC;var sm="\0SLASH"+Math.random()+"\0",lm="\0OPEN"+Math.random()+"\0",fl="\0CLOSE"+Math.random()+"\0",cm="\0COMMA"+Math.random()+"\0",fm="\0PERIOD"+Math.random()+"\0";function cl(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function hC(t){return t.split("\\\\").join(sm).split("\\{").join(lm).split("\\}").join(fl).split("\\,").join(cm).split("\\.").join(fm)}function gC(t){return t.split(sm).join("\\").split(lm).join("{").split(fl).join("}").split(cm).join(",").split(fm).join(".")}function um(t){if(!t)return[""];var e=[],r=am("{","}",t);if(!r)return t.split(",");var o=r.pre,i=r.body,n=r.post,a=o.split(",");a[a.length-1]+="{"+i+"}";var s=um(n);return n.length&&(a[a.length-1]+=s.shift(),a.push.apply(a,s)),e.push.apply(e,a),e}function wC(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),ko(hC(t),!0).map(gC)):[]}function xC(t){return"{"+t+"}"}function bC(t){return/^-?0\d/.test(t)}function yC(t,e){return t<=e}function vC(t,e){return t>=e}function ko(t,e){var r=[],o=am("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),n=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),a=i||n,s=o.body.indexOf(",")>=0;if(!a&&!s)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+fl+o.post,ko(t)):[t];var l;if(a)l=o.body.split(/\.\./);else if(l=um(o.body),l.length===1&&(l=ko(l[0],!1).map(xC),l.length===1)){var f=o.post.length?ko(o.post,!1):[""];return f.map(function(oo){return o.pre+l[0]+oo})}var c=o.pre,f=o.post.length?ko(o.post,!1):[""],u;if(a){var d=cl(l[0]),p=cl(l[1]),m=Math.max(l[0].length,l[1].length),h=l.length==3?Math.abs(cl(l[2])):1,g=yC,x=p<d;x&&(h*=-1,g=vC);var b=l.some(bC);u=[];for(var T=d;g(T,p);T+=h){var I;if(n)I=String.fromCharCode(T),I==="\\"&&(I="");else if(I=String(T),b){var H=m-I.length;if(H>0){var qe=new Array(H+1).join("0");T<0?I="-"+qe+I.slice(1):I=qe+I}}u.push(I)}}else u=mC(l,function(mt){return ko(mt,!1)});for(var Re=0;Re<u.length;Re++)for(var Ne=0;Ne<f.length;Ne++){var Se=c+u[Re]+f[Ne];(!e||a||Se)&&r.push(Se)}return r}});var Ro=L((dF,xm)=>{xm.exports=Be;Be.Minimatch=ve;var _i=function(){try{return require("path")}catch{}}()||{sep:"/"};Be.sep=_i.sep;var pl=Be.GLOBSTAR=ve.GLOBSTAR={},EC=pm(),mm={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ul="[^/]",dl=ul+"*?",NC="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",TC="(?:(?!(?:\\/|^)\\.).)*?",hm=SC("().*{}+?[]^$\\!");function SC(t){return t.split("").reduce(function(e,r){return e[r]=!0,e},{})}var gm=/\/+/;Be.filter=CC;function CC(t,e){return e=e||{},function(r,o,i){return Be(r,t,e)}}function zt(t,e){e=e||{};var r={};return Object.keys(t).forEach(function(o){r[o]=t[o]}),Object.keys(e).forEach(function(o){r[o]=e[o]}),r}Be.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return Be;var e=Be,r=function(i,n,a){return e(i,n,zt(t,a))};return r.Minimatch=function(i,n){return new e.Minimatch(i,zt(t,n))},r.Minimatch.defaults=function(i){return e.defaults(zt(t,i)).Minimatch},r.filter=function(i,n){return e.filter(i,zt(t,n))},r.defaults=function(i){return e.defaults(zt(t,i))},r.makeRe=function(i,n){return e.makeRe(i,zt(t,n))},r.braceExpand=function(i,n){return e.braceExpand(i,zt(t,n))},r.match=function(o,i,n){return e.match(o,i,zt(t,n))},r};ve.defaults=function(t){return Be.defaults(t).Minimatch};function Be(t,e,r){return ta(e),r||(r={}),!r.nocomment&&e.charAt(0)==="#"?!1:new ve(e,r).match(t)}function ve(t,e){if(!(this instanceof ve))return new ve(t,e);ta(t),e||(e={}),t=t.trim(),!e.allowWindowsEscape&&_i.sep!=="/"&&(t=t.split(_i.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ve.prototype.debug=function(){};ve.prototype.make=IC;function IC(){var t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,r),r=this.globParts=r.map(function(o){return o.split(gm)}),this.debug(this.pattern,r),r=r.map(function(o,i,n){return o.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(o){return o.indexOf(!1)===-1}),this.debug(this.pattern,r),this.set=r}ve.prototype.parseNegate=OC;function OC(){var t=this.pattern,e=!1,r=this.options,o=0;if(!r.nonegate){for(var i=0,n=t.length;i<n&&t.charAt(i)==="!";i++)e=!e,o++;o&&(this.pattern=t.substr(o)),this.negate=e}}Be.braceExpand=function(t,e){return wm(t,e)};ve.prototype.braceExpand=wm;function wm(t,e){return e||(this instanceof ve?e=this.options:e={}),t=typeof t>"u"?this.pattern:t,ta(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:EC(t)}var PC=1024*64,ta=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>PC)throw new TypeError("pattern is too long")};ve.prototype.parse=AC;var ea={};function AC(t,e){ta(t);var r=this.options;if(t==="**")if(r.noglobstar)t="*";else return pl;if(t==="")return"";var o="",i=!!r.nocase,n=!1,a=[],s=[],l,c=!1,f=-1,u=-1,d=t.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",p=this;function m(){if(l){switch(l){case"*":o+=dl,i=!0;break;case"?":o+=ul,i=!0;break;default:o+="\\"+l;break}p.debug("clearStateChar %j %j",l,o),l=!1}}for(var h=0,g=t.length,x;h<g&&(x=t.charAt(h));h++){if(this.debug("%s	%s %s %j",t,h,o,x),n&&hm[x]){o+="\\"+x,n=!1;continue}switch(x){case"/":return!1;case"\\":m(),n=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,h,o,x),c){this.debug("  in class"),x==="!"&&h===u+1&&(x="^"),o+=x;continue}p.debug("call clearStateChar %j",l),m(),l=x,r.noext&&m();continue;case"(":if(c){o+="(";continue}if(!l){o+="\\(";continue}a.push({type:l,start:h-1,reStart:o.length,open:mm[l].open,close:mm[l].close}),o+=l==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",l,o),l=!1;continue;case")":if(c||!a.length){o+="\\)";continue}m(),i=!0;var b=a.pop();o+=b.close,b.type==="!"&&s.push(b),b.reEnd=o.length;continue;case"|":if(c||!a.length||n){o+="\\|",n=!1;continue}m(),o+="|";continue;case"[":if(m(),c){o+="\\"+x;continue}c=!0,u=h,f=o.length,o+=x;continue;case"]":if(h===u+1||!c){o+="\\"+x,n=!1;continue}var T=t.substring(u+1,h);try{RegExp("["+T+"]")}catch{var I=this.parse(T,ea);o=o.substr(0,f)+"\\["+I[0]+"\\]",i=i||I[1],c=!1;continue}i=!0,c=!1,o+=x;continue;default:m(),n?n=!1:hm[x]&&!(x==="^"&&c)&&(o+="\\"),o+=x}}for(c&&(T=t.substr(u+1),I=this.parse(T,ea),o=o.substr(0,f)+"\\["+I[0],i=i||I[1]),b=a.pop();b;b=a.pop()){var H=o.slice(b.reStart+b.open.length);this.debug("setting tail",o,b),H=H.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Cf,If,Bs){return Bs||(Bs="\\"),If+If+Bs+"|"}),this.debug(`tail=%j
   %s`,H,H,b,o);var qe=b.type==="*"?dl:b.type==="?"?ul:"\\"+b.type;i=!0,o=o.slice(0,b.reStart)+qe+"\\("+H}m(),n&&(o+="\\\\");var Re=!1;switch(o.charAt(0)){case"[":case".":case"(":Re=!0}for(var Ne=s.length-1;Ne>-1;Ne--){var Se=s[Ne],mt=o.slice(0,Se.reStart),oo=o.slice(Se.reStart,Se.reEnd-8),Nr=o.slice(Se.reEnd-8,Se.reEnd),Ve=o.slice(Se.reEnd);Nr+=Ve;var Tr=mt.split("(").length-1,At=Ve;for(h=0;h<Tr;h++)At=At.replace(/\)[+*?]?/,"");Ve=At;var pn="";Ve===""&&e!==ea&&(pn="$");var cb=mt+oo+Ve+pn+Nr;o=cb}if(o!==""&&i&&(o="(?=.)"+o),Re&&(o=d+o),e===ea)return[o,i];if(!i)return MC(t);var fb=r.nocase?"i":"";try{var Ds=new RegExp("^"+o+"$",fb)}catch{return new RegExp("$.")}return Ds._glob=t,Ds._src=o,Ds}Be.makeRe=function(t,e){return new ve(t,e||{}).makeRe()};ve.prototype.makeRe=_C;function _C(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?dl:e.dot?NC:TC,o=e.nocase?"i":"",i=t.map(function(n){return n.map(function(a){return a===pl?r:typeof a=="string"?kC(a):a._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,o)}catch{this.regexp=!1}return this.regexp}Be.match=function(t,e,r){r=r||{};var o=new ve(e,r);return t=t.filter(function(i){return o.match(i)}),o.options.nonull&&!t.length&&t.push(e),t};ve.prototype.match=function(e,r){if(typeof r>"u"&&(r=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;var o=this.options;_i.sep!=="/"&&(e=e.split(_i.sep).join("/")),e=e.split(gm),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var n,a;for(a=e.length-1;a>=0&&(n=e[a],!n);a--);for(a=0;a<i.length;a++){var s=i[a],l=e;o.matchBase&&s.length===1&&(l=[n]);var c=this.matchOne(l,s,r);if(c)return o.flipNegate?!0:!this.negate}return o.flipNegate?!1:this.negate};ve.prototype.matchOne=function(t,e,r){var o=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,n=0,a=t.length,s=e.length;i<a&&n<s;i++,n++){this.debug("matchOne loop");var l=e[n],c=t[i];if(this.debug(e,l,c),l===!1)return!1;if(l===pl){this.debug("GLOBSTAR",[e,l,c]);var f=i,u=n+1;if(u===s){for(this.debug("** at the end");i<a;i++)if(t[i]==="."||t[i]===".."||!o.dot&&t[i].charAt(0)===".")return!1;return!0}for(;f<a;){var d=t[f];if(this.debug(`
globstar while`,t,f,e,u,d),this.matchOne(t.slice(f),e.slice(u),r))return this.debug("globstar found match!",f,a,d),!0;if(d==="."||d===".."||!o.dot&&d.charAt(0)==="."){this.debug("dot detected!",t,f,e,u);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(r&&(this.debug(`
>>> no match, partial?`,t,f,e,u),f===a))}var p;if(typeof l=="string"?(p=c===l,this.debug("string match",l,c,p)):(p=c.match(l),this.debug("pattern match",l,c,p)),!p)return!1}if(i===a&&n===s)return!0;if(i===a)return r;if(n===s)return i===a-1&&t[i]==="";throw new Error("wtf?")};function MC(t){return t.replace(/\\(.)/g,"$1")}function kC(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var bm=L((pF,ml)=>{typeof Object.create=="function"?ml.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ml.exports=function(e,r){if(r){e.super_=r;var o=function(){};o.prototype=r.prototype,e.prototype=new o,e.prototype.constructor=e}}});var ym=L((mF,gl)=>{try{if(hl=require("util"),typeof hl.inherits!="function")throw"";gl.exports=hl.inherits}catch{gl.exports=bm()}var hl});var oa=L((hF,ra)=>{"use strict";function vm(t){return t.charAt(0)==="/"}function Em(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=e.exec(t),o=r[1]||"",i=Boolean(o&&o.charAt(1)!==":");return Boolean(r[2]||i)}ra.exports=process.platform==="win32"?Em:vm;ra.exports.posix=vm;ra.exports.win32=Em});var xl=L(Kt=>{Kt.setopts=FC;Kt.ownProp=Nm;Kt.makeAbs=Mi;Kt.finish=jC;Kt.mark=HC;Kt.isIgnored=Sm;Kt.childrenIgnored=$C;function Nm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var RC=require("fs"),Lo=require("path"),LC=Ro(),Tm=oa(),wl=LC.Minimatch;function DC(t,e){return t.localeCompare(e,"en")}function BC(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(WC))}function WC(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new wl(r,{dot:!0})}return{matcher:new wl(t,{dot:!0}),gmatcher:e}}function FC(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||RC,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),BC(t,r),t.changedCwd=!1;var o=process.cwd();Nm(r,"cwd")?(t.cwd=Lo.resolve(r.cwd),t.changedCwd=t.cwd!==o):t.cwd=o,t.root=r.root||Lo.resolve(t.cwd,"/"),t.root=Lo.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=Tm(t.cwd)?t.cwd:Mi(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new wl(e,r),t.options=t.minimatch.options}function jC(t){for(var e=t.nounique,r=e?[]:Object.create(null),o=0,i=t.matches.length;o<i;o++){var n=t.matches[o];if(!n||Object.keys(n).length===0){if(t.nonull){var a=t.minimatch.globSet[o];e?r.push(a):r[a]=!0}}else{var s=Object.keys(n);e?r.push.apply(r,s):s.forEach(function(l){r[l]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(DC)),t.mark){for(var o=0;o<r.length;o++)r[o]=t._mark(r[o]);t.nodir&&(r=r.filter(function(l){var c=!/\/$/.test(l),f=t.cache[l]||t.cache[Mi(t,l)];return c&&f&&(c=f!=="DIR"&&!Array.isArray(f)),c}))}t.ignore.length&&(r=r.filter(function(l){return!Sm(t,l)})),t.found=r}function HC(t,e){var r=Mi(t,e),o=t.cache[r],i=e;if(o){var n=o==="DIR"||Array.isArray(o),a=e.slice(-1)==="/";if(n&&!a?i+="/":!n&&a&&(i=i.slice(0,-1)),i!==e){var s=Mi(t,i);t.statCache[s]=t.statCache[r],t.cache[s]=t.cache[r]}}return i}function Mi(t,e){var r=e;return e.charAt(0)==="/"?r=Lo.join(t.root,e):Tm(e)||e===""?r=e:t.changedCwd?r=Lo.resolve(t.cwd,e):r=Lo.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function Sm(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function $C(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}});var Am=L((yF,Pm)=>{Pm.exports=Om;Om.GlobSync=de;var GC=ll(),Cm=Ro(),wF=Cm.Minimatch,xF=vl().Glob,bF=require("util"),bl=require("path"),Im=require("assert"),ia=oa(),Mr=xl(),UC=Mr.setopts,yl=Mr.ownProp,qC=Mr.childrenIgnored,VC=Mr.isIgnored;function Om(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new de(t,e).found}function de(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof de))return new de(t,e);if(UC(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var o=0;o<r;o++)this._process(this.minimatch.set[o],o,!1);this._finish()}de.prototype._finish=function(){if(Im(this instanceof de),this.realpath){var t=this;this.matches.forEach(function(e,r){var o=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i);var n=GC.realpathSync(i,t.realpathCache);o[n]=!0}catch(a){if(a.syscall==="stat")o[t._makeAbs(i)]=!0;else throw a}})}Mr.finish(this)};de.prototype._process=function(t,e,r){Im(this instanceof de);for(var o=0;typeof t[o]=="string";)o++;var i;switch(o){case t.length:this._processSimple(t.join("/"),e);return;case 0:i=null;break;default:i=t.slice(0,o).join("/");break}var n=t.slice(o),a;i===null?a=".":((ia(i)||ia(t.join("/")))&&(!i||!ia(i))&&(i="/"+i),a=i);var s=this._makeAbs(a);if(!qC(this,a)){var l=n[0]===Cm.GLOBSTAR;l?this._processGlobStar(i,a,s,n,e,r):this._processReaddir(i,a,s,n,e,r)}};de.prototype._processReaddir=function(t,e,r,o,i,n){var a=this._readdir(r,n);if(!!a){for(var s=o[0],l=!!this.minimatch.negate,c=s._glob,f=this.dot||c.charAt(0)===".",u=[],d=0;d<a.length;d++){var p=a[d];if(p.charAt(0)!=="."||f){var m;l&&!t?m=!p.match(s):m=p.match(s),m&&u.push(p)}}var h=u.length;if(h!==0){if(o.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var d=0;d<h;d++){var p=u[d];t&&(t.slice(-1)!=="/"?p=t+"/"+p:p=t+p),p.charAt(0)==="/"&&!this.nomount&&(p=bl.join(this.root,p)),this._emitMatch(i,p)}return}o.shift();for(var d=0;d<h;d++){var p=u[d],g;t?g=[t,p]:g=[p],this._process(g.concat(o),i,n)}}}};de.prototype._emitMatch=function(t,e){if(!VC(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var o=this.cache[r];if(o==="DIR"||Array.isArray(o))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};de.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r,o;try{r=this.fs.lstatSync(t)}catch(n){if(n.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,!i&&r&&!r.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};de.prototype._readdir=function(t,e){var r;if(e&&!yl(this.symlinks,t))return this._readdirInGlobStar(t);if(yl(this.cache,t)){var o=this.cache[t];if(!o||o==="FILE")return null;if(Array.isArray(o))return o}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(i){return this._readdirError(t,i),null}};de.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var o=e[r];t==="/"?o=t+o:o=t+"/"+o,this.cache[o]=!0}return this.cache[t]=e,e};de.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var o=new Error(e.code+" invalid cwd "+this.cwd);throw o.path=this.cwd,o.code=e.code,o}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};de.prototype._processGlobStar=function(t,e,r,o,i,n){var a=this._readdir(r,n);if(!!a){var s=o.slice(1),l=t?[t]:[],c=l.concat(s);this._process(c,i,!1);var f=a.length,u=this.symlinks[r];if(!(u&&n))for(var d=0;d<f;d++){var p=a[d];if(!(p.charAt(0)==="."&&!this.dot)){var m=l.concat(a[d],s);this._process(m,i,!0);var h=l.concat(a[d],o);this._process(h,i,!0)}}}};de.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!r){if(t&&ia(t)&&!this.nomount){var o=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=bl.join(this.root,t):(t=bl.resolve(this.root,t),o&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};de.prototype._stat=function(t){var e=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&yl(this.cache,e)){var a=this.cache[e];if(Array.isArray(a)&&(a="DIR"),!r||a==="DIR")return a;if(r&&a==="FILE")return!1}var o,i=this.statCache[e];if(!i){var n;try{n=this.fs.lstatSync(e)}catch(s){if(s&&(s.code==="ENOENT"||s.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(n&&n.isSymbolicLink())try{i=this.fs.statSync(e)}catch{i=n}else i=n}this.statCache[e]=i;var a=!0;return i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,r&&a==="FILE"?!1:a};de.prototype._mark=function(t){return Mr.mark(this,t)};de.prototype._makeAbs=function(t){return Mr.makeAbs(this,t)}});var El=L((vF,Mm)=>{Mm.exports=_m;function _m(t,e){if(t&&e)return _m(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(o){r[o]=t[o]}),r;function r(){for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var n=t.apply(this,o),a=o[o.length-1];return typeof n=="function"&&n!==a&&Object.keys(a).forEach(function(s){n[s]=a[s]}),n}}});var Tl=L((EF,Nl)=>{var km=El();Nl.exports=km(na);Nl.exports.strict=km(Rm);na.proto=na(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return na(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Rm(this)},configurable:!0})});function na(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Rm(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var Dm=L((NF,Lm)=>{var YC=El(),ki=Object.create(null),zC=Tl();Lm.exports=YC(KC);function KC(t,e){return ki[t]?(ki[t].push(e),null):(ki[t]=[e],XC(t))}function XC(t){return zC(function e(){var r=ki[t],o=r.length,i=QC(arguments);try{for(var n=0;n<o;n++)r[n].apply(null,i)}finally{r.length>o?(r.splice(0,o),process.nextTick(function(){e.apply(null,i)})):delete ki[t]}})}function QC(t){for(var e=t.length,r=[],o=0;o<e;o++)r[o]=t[o];return r}});var vl=L((CF,Wm)=>{Wm.exports=kr;var JC=ll(),Bm=Ro(),TF=Bm.Minimatch,ZC=ym(),eI=require("events").EventEmitter,Sl=require("path"),Cl=require("assert"),Ri=oa(),Ol=Am(),Rr=xl(),tI=Rr.setopts,Il=Rr.ownProp,Pl=Dm(),SF=require("util"),rI=Rr.childrenIgnored,oI=Rr.isIgnored,iI=Tl();function kr(t,e,r){if(typeof e=="function"&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return Ol(t,e)}return new G(t,e,r)}kr.sync=Ol;var nI=kr.GlobSync=Ol.GlobSync;kr.glob=kr;function aI(t,e){if(e===null||typeof e!="object")return t;for(var r=Object.keys(e),o=r.length;o--;)t[r[o]]=e[r[o]];return t}kr.hasMagic=function(t,e){var r=aI({},e);r.noprocess=!0;var o=new G(t,r),i=o.minimatch.set;if(!t)return!1;if(i.length>1)return!0;for(var n=0;n<i[0].length;n++)if(typeof i[0][n]!="string")return!0;return!1};kr.Glob=G;ZC(G,eI);function G(t,e,r){if(typeof e=="function"&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new nI(t,e)}if(!(this instanceof G))return new G(t,e,r);tI(this,t,e),this._didRealPath=!1;var o=this.minimatch.set.length;this.matches=new Array(o),typeof r=="function"&&(r=iI(r),this.on("error",r),this.on("end",function(l){r(null,l)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(o===0)return s();for(var n=!0,a=0;a<o;a++)this._process(this.minimatch.set[a],a,!1,s);n=!1;function s(){--i._processing,i._processing<=0&&(n?process.nextTick(function(){i._finish()}):i._finish())}}G.prototype._finish=function(){if(Cl(this instanceof G),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Rr.finish(this),this.emit("end",this.found)}};G.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,o);function o(){--t===0&&e._finish()}};G.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var o=Object.keys(r),i=this,n=o.length;if(n===0)return e();var a=this.matches[t]=Object.create(null);o.forEach(function(s,l){s=i._makeAbs(s),JC.realpath(s,i.realpathCache,function(c,f){c?c.syscall==="stat"?a[s]=!0:i.emit("error",c):a[f]=!0,--n===0&&(i.matches[t]=a,e())})})};G.prototype._mark=function(t){return Rr.mark(this,t)};G.prototype._makeAbs=function(t){return Rr.makeAbs(this,t)};G.prototype.abort=function(){this.aborted=!0,this.emit("abort")};G.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};G.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var o=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<o.length;e++){var i=o[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};G.prototype._process=function(t,e,r,o){if(Cl(this instanceof G),Cl(typeof o=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,r,o]);return}for(var i=0;typeof t[i]=="string";)i++;var n;switch(i){case t.length:this._processSimple(t.join("/"),e,o);return;case 0:n=null;break;default:n=t.slice(0,i).join("/");break}var a=t.slice(i),s;n===null?s=".":((Ri(n)||Ri(t.join("/")))&&(!n||!Ri(n))&&(n="/"+n),s=n);var l=this._makeAbs(s);if(rI(this,s))return o();var c=a[0]===Bm.GLOBSTAR;c?this._processGlobStar(n,s,l,a,e,r,o):this._processReaddir(n,s,l,a,e,r,o)}};G.prototype._processReaddir=function(t,e,r,o,i,n,a){var s=this;this._readdir(r,n,function(l,c){return s._processReaddir2(t,e,r,o,i,n,c,a)})};G.prototype._processReaddir2=function(t,e,r,o,i,n,a,s){if(!a)return s();for(var l=o[0],c=!!this.minimatch.negate,f=l._glob,u=this.dot||f.charAt(0)===".",d=[],p=0;p<a.length;p++){var m=a[p];if(m.charAt(0)!=="."||u){var h;c&&!t?h=!m.match(l):h=m.match(l),h&&d.push(m)}}var g=d.length;if(g===0)return s();if(o.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<g;p++){var m=d[p];t&&(t!=="/"?m=t+"/"+m:m=t+m),m.charAt(0)==="/"&&!this.nomount&&(m=Sl.join(this.root,m)),this._emitMatch(i,m)}return s()}o.shift();for(var p=0;p<g;p++){var m=d[p],x;t&&(t!=="/"?m=t+"/"+m:m=t+m),this._process([m].concat(o),i,n,s)}s()};G.prototype._emitMatch=function(t,e){if(!this.aborted&&!oI(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var r=Ri(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var o=this.cache[r];if(o==="DIR"||Array.isArray(o))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}};G.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var r="lstat\0"+t,o=this,i=Pl(r,n);i&&o.fs.lstat(t,i);function n(a,s){if(a&&a.code==="ENOENT")return e();var l=s&&s.isSymbolicLink();o.symlinks[t]=l,!l&&s&&!s.isDirectory()?(o.cache[t]="FILE",e()):o._readdir(t,!1,e)}};G.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=Pl("readdir\0"+t+"\0"+e,r),!!r)){if(e&&!Il(this.symlinks,t))return this._readdirInGlobStar(t,r);if(Il(this.cache,t)){var o=this.cache[t];if(!o||o==="FILE")return r();if(Array.isArray(o))return r(null,o)}var i=this;i.fs.readdir(t,sI(this,t,r))}};function sI(t,e,r){return function(o,i){o?t._readdirError(e,o,r):t._readdirEntries(e,i,r)}}G.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var o=0;o<e.length;o++){var i=e[o];t==="/"?i=t+i:i=t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}};G.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var o=this._makeAbs(t);if(this.cache[o]="FILE",o===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return r()}};G.prototype._processGlobStar=function(t,e,r,o,i,n,a){var s=this;this._readdir(r,n,function(l,c){s._processGlobStar2(t,e,r,o,i,n,c,a)})};G.prototype._processGlobStar2=function(t,e,r,o,i,n,a,s){if(!a)return s();var l=o.slice(1),c=t?[t]:[],f=c.concat(l);this._process(f,i,!1,s);var u=this.symlinks[r],d=a.length;if(u&&n)return s();for(var p=0;p<d;p++){var m=a[p];if(!(m.charAt(0)==="."&&!this.dot)){var h=c.concat(a[p],l);this._process(h,i,!0,s);var g=c.concat(a[p],o);this._process(g,i,!0,s)}}s()};G.prototype._processSimple=function(t,e,r){var o=this;this._stat(t,function(i,n){o._processSimple2(t,e,i,n,r)})};G.prototype._processSimple2=function(t,e,r,o,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!o)return i();if(t&&Ri(t)&&!this.nomount){var n=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Sl.join(this.root,t):(t=Sl.resolve(this.root,t),n&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()};G.prototype._stat=function(t,e){var r=this._makeAbs(t),o=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&Il(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!o||i==="DIR")return e(null,i);if(o&&i==="FILE")return e()}var n,a=this.statCache[r];if(a!==void 0){if(a===!1)return e(null,a);var s=a.isDirectory()?"DIR":"FILE";return o&&s==="FILE"?e():e(null,s,a)}var l=this,c=Pl("stat\0"+r,f);c&&l.fs.lstat(r,c);function f(u,d){if(d&&d.isSymbolicLink())return l.fs.stat(r,function(p,m){p?l._stat2(t,r,null,d,e):l._stat2(t,r,p,m,e)});l._stat2(t,r,u,d,e)}};G.prototype._stat2=function(t,e,r,o,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[e]=!1,i();var n=t.slice(-1)==="/";if(this.statCache[e]=o,e.slice(-1)==="/"&&o&&!o.isDirectory())return i(null,!1,o);var a=!0;return o&&(a=o.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,n&&a==="FILE"?i():i(null,a,o)}});var Vm=L((IF,qm)=>{var z=require("assert"),$m=require("path"),Fm=require("fs"),Do;try{Do=vl()}catch{}var lI={nosort:!0,silent:!0},Al=0,Li=process.platform==="win32",Gm=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||Fm[r],r=r+"Sync",t[r]=t[r]||Fm[r]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&Do===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||lI},Ml=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),z(t,"rimraf: missing path"),z.equal(typeof t,"string","rimraf: path should be a string"),z.equal(typeof r,"function","rimraf: callback function required"),z(e,"rimraf: invalid options argument provided"),z.equal(typeof e,"object","rimraf: options should be object"),Gm(e);let o=0,i=null,n=0,a=l=>{i=i||l,--n===0&&r(i)},s=(l,c)=>{if(l)return r(l);if(n=c.length,n===0)return r();c.forEach(f=>{let u=d=>{if(d){if((d.code==="EBUSY"||d.code==="ENOTEMPTY"||d.code==="EPERM")&&o<e.maxBusyTries)return o++,setTimeout(()=>_l(f,e,u),o*100);if(d.code==="EMFILE"&&Al<e.emfileWait)return setTimeout(()=>_l(f,e,u),Al++);d.code==="ENOENT"&&(d=null)}Al=0,a(d)};_l(f,e,u)})};if(e.disableGlob||!Do.hasMagic(t))return s(null,[t]);e.lstat(t,(l,c)=>{if(!l)return s(null,[t]);Do(t,e.glob,s)})},_l=(t,e,r)=>{z(t),z(e),z(typeof r=="function"),e.lstat(t,(o,i)=>{if(o&&o.code==="ENOENT")return r(null);if(o&&o.code==="EPERM"&&Li&&jm(t,e,o,r),i&&i.isDirectory())return aa(t,e,o,r);e.unlink(t,n=>{if(n){if(n.code==="ENOENT")return r(null);if(n.code==="EPERM")return Li?jm(t,e,n,r):aa(t,e,n,r);if(n.code==="EISDIR")return aa(t,e,n,r)}return r(n)})})},jm=(t,e,r,o)=>{z(t),z(e),z(typeof o=="function"),e.chmod(t,438,i=>{i?o(i.code==="ENOENT"?null:r):e.stat(t,(n,a)=>{n?o(n.code==="ENOENT"?null:r):a.isDirectory()?aa(t,e,r,o):e.unlink(t,o)})})},Hm=(t,e,r)=>{z(t),z(e);try{e.chmodSync(t,438)}catch(i){if(i.code==="ENOENT")return;throw r}let o;try{o=e.statSync(t)}catch(i){if(i.code==="ENOENT")return;throw r}o.isDirectory()?sa(t,e,r):e.unlinkSync(t)},aa=(t,e,r,o)=>{z(t),z(e),z(typeof o=="function"),e.rmdir(t,i=>{i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?cI(t,e,o):i&&i.code==="ENOTDIR"?o(r):o(i)})},cI=(t,e,r)=>{z(t),z(e),z(typeof r=="function"),e.readdir(t,(o,i)=>{if(o)return r(o);let n=i.length;if(n===0)return e.rmdir(t,r);let a;i.forEach(s=>{Ml($m.join(t,s),e,l=>{if(!a){if(l)return r(a=l);--n===0&&e.rmdir(t,r)}})})})},Um=(t,e)=>{e=e||{},Gm(e),z(t,"rimraf: missing path"),z.equal(typeof t,"string","rimraf: path should be a string"),z(e,"rimraf: missing options"),z.equal(typeof e,"object","rimraf: options should be object");let r;if(e.disableGlob||!Do.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch{r=Do.sync(t,e.glob)}if(!!r.length)for(let o=0;o<r.length;o++){let i=r[o],n;try{n=e.lstatSync(i)}catch(a){if(a.code==="ENOENT")return;a.code==="EPERM"&&Li&&Hm(i,e,a)}try{n&&n.isDirectory()?sa(i,e,null):e.unlinkSync(i)}catch(a){if(a.code==="ENOENT")return;if(a.code==="EPERM")return Li?Hm(i,e,a):sa(i,e,a);if(a.code!=="EISDIR")throw a;sa(i,e,a)}}},sa=(t,e,r)=>{z(t),z(e);try{e.rmdirSync(t)}catch(o){if(o.code==="ENOENT")return;if(o.code==="ENOTDIR")throw r;(o.code==="ENOTEMPTY"||o.code==="EEXIST"||o.code==="EPERM")&&fI(t,e)}},fI=(t,e)=>{z(t),z(e),e.readdirSync(t).forEach(i=>Um($m.join(t,i),e));let r=Li?100:1,o=0;do{let i=!0;try{let n=e.rmdirSync(t,e);return i=!1,n}finally{if(++o<r&&i)continue}}while(!0)};qm.exports=Ml;Ml.sync=Um});var Qm=L((OF,Xm)=>{Xm.exports=Km;Km.sync=dI;var Ym=require("fs");function uI(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var o=0;o<r.length;o++){var i=r[o].toLowerCase();if(i&&t.substr(-i.length).toLowerCase()===i)return!0}return!1}function zm(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:uI(e,r)}function Km(t,e,r){Ym.stat(t,function(o,i){r(o,o?!1:zm(i,t,e))})}function dI(t,e){return zm(Ym.statSync(t),t,e)}});var rh=L((PF,th)=>{th.exports=Zm;Zm.sync=pI;var Jm=require("fs");function Zm(t,e,r){Jm.stat(t,function(o,i){r(o,o?!1:eh(i,e))})}function pI(t,e){return eh(Jm.statSync(t),e)}function eh(t,e){return t.isFile()&&mI(t,e)}function mI(t,e){var r=t.mode,o=t.uid,i=t.gid,n=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),a=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),s=parseInt("100",8),l=parseInt("010",8),c=parseInt("001",8),f=s|l,u=r&c||r&l&&i===a||r&s&&o===n||r&f&&n===0;return u}});var ih=L((_F,oh)=>{var AF=require("fs"),la;process.platform==="win32"||global.TESTING_WINDOWS?la=Qm():la=rh();oh.exports=kl;kl.sync=hI;function kl(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(o,i){kl(t,e||{},function(n,a){n?i(n):o(a)})})}la(t,e||{},function(o,i){o&&(o.code==="EACCES"||e&&e.ignoreErrors)&&(o=null,i=!1),r(o,i)})}function hI(t,e){try{return la.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var uh=L((MF,fh)=>{var Bo=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",nh=require("path"),gI=Bo?";":":",ah=ih(),sh=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),lh=(t,e)=>{let r=e.colon||gI,o=t.match(/\//)||Bo&&t.match(/\\/)?[""]:[...Bo?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],i=Bo?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",n=Bo?i.split(r):[""];return Bo&&t.indexOf(".")!==-1&&n[0]!==""&&n.unshift(""),{pathEnv:o,pathExt:n,pathExtExe:i}},ch=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:o,pathExt:i,pathExtExe:n}=lh(t,e),a=[],s=c=>new Promise((f,u)=>{if(c===o.length)return e.all&&a.length?f(a):u(sh(t));let d=o[c],p=/^".*"$/.test(d)?d.slice(1,-1):d,m=nh.join(p,t),h=!p&&/^\.[\\\/]/.test(t)?t.slice(0,2)+m:m;f(l(h,c,0))}),l=(c,f,u)=>new Promise((d,p)=>{if(u===i.length)return d(s(f+1));let m=i[u];ah(c+m,{pathExt:n},(h,g)=>{if(!h&&g)if(e.all)a.push(c+m);else return d(c+m);return d(l(c,f,u+1))})});return r?s(0).then(c=>r(null,c),r):s(0)},wI=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:o,pathExtExe:i}=lh(t,e),n=[];for(let a=0;a<r.length;a++){let s=r[a],l=/^".*"$/.test(s)?s.slice(1,-1):s,c=nh.join(l,t),f=!l&&/^\.[\\\/]/.test(t)?t.slice(0,2)+c:c;for(let u=0;u<o.length;u++){let d=f+o[u];try{if(ah.sync(d,{pathExt:i}))if(e.all)n.push(d);else return d}catch{}}}if(e.all&&n.length)return n;if(e.nothrow)return null;throw sh(t)};fh.exports=ch;ch.sync=wI});var Oh=L((JF,Ih)=>{"use strict";Ih.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var Hl=L((ZF,Ah)=>{var Wi=Oh(),Ph={};for(let t of Object.keys(Wi))Ph[Wi[t]]=t;var N={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};Ah.exports=N;for(let t of Object.keys(N)){if(!("channels"in N[t]))throw new Error("missing channels property: "+t);if(!("labels"in N[t]))throw new Error("missing channel labels property: "+t);if(N[t].labels.length!==N[t].channels)throw new Error("channel and label counts mismatch: "+t);let{channels:e,labels:r}=N[t];delete N[t].channels,delete N[t].labels,Object.defineProperty(N[t],"channels",{value:e}),Object.defineProperty(N[t],"labels",{value:r})}N.rgb.hsl=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.min(e,r,o),n=Math.max(e,r,o),a=n-i,s,l;n===i?s=0:e===n?s=(r-o)/a:r===n?s=2+(o-e)/a:o===n&&(s=4+(e-r)/a),s=Math.min(s*60,360),s<0&&(s+=360);let c=(i+n)/2;return n===i?l=0:c<=.5?l=a/(n+i):l=a/(2-n-i),[s,l*100,c*100]};N.rgb.hsv=function(t){let e,r,o,i,n,a=t[0]/255,s=t[1]/255,l=t[2]/255,c=Math.max(a,s,l),f=c-Math.min(a,s,l),u=function(d){return(c-d)/6/f+1/2};return f===0?(i=0,n=0):(n=f/c,e=u(a),r=u(s),o=u(l),a===c?i=o-r:s===c?i=1/3+e-o:l===c&&(i=2/3+r-e),i<0?i+=1:i>1&&(i-=1)),[i*360,n*100,c*100]};N.rgb.hwb=function(t){let e=t[0],r=t[1],o=t[2],i=N.rgb.hsl(t)[0],n=1/255*Math.min(e,Math.min(r,o));return o=1-1/255*Math.max(e,Math.max(r,o)),[i,n*100,o*100]};N.rgb.cmyk=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.min(1-e,1-r,1-o),n=(1-e-i)/(1-i)||0,a=(1-r-i)/(1-i)||0,s=(1-o-i)/(1-i)||0;return[n*100,a*100,s*100,i*100]};function EI(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}N.rgb.keyword=function(t){let e=Ph[t];if(e)return e;let r=1/0,o;for(let i of Object.keys(Wi)){let n=Wi[i],a=EI(t,n);a<r&&(r=a,o=i)}return o};N.keyword.rgb=function(t){return Wi[t]};N.rgb.xyz=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92;let i=e*.4124+r*.3576+o*.1805,n=e*.2126+r*.7152+o*.0722,a=e*.0193+r*.1192+o*.9505;return[i*100,n*100,a*100]};N.rgb.lab=function(t){let e=N.rgb.xyz(t),r=e[0],o=e[1],i=e[2];r/=95.047,o/=100,i/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;let n=116*o-16,a=500*(r-o),s=200*(o-i);return[n,a,s]};N.hsl.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100,i,n,a;if(r===0)return a=o*255,[a,a,a];o<.5?i=o*(1+r):i=o+r-o*r;let s=2*o-i,l=[0,0,0];for(let c=0;c<3;c++)n=e+1/3*-(c-1),n<0&&n++,n>1&&n--,6*n<1?a=s+(i-s)*6*n:2*n<1?a=i:3*n<2?a=s+(i-s)*(2/3-n)*6:a=s,l[c]=a*255;return l};N.hsl.hsv=function(t){let e=t[0],r=t[1]/100,o=t[2]/100,i=r,n=Math.max(o,.01);o*=2,r*=o<=1?o:2-o,i*=n<=1?n:2-n;let a=(o+r)/2,s=o===0?2*i/(n+i):2*r/(o+r);return[e,s*100,a*100]};N.hsv.rgb=function(t){let e=t[0]/60,r=t[1]/100,o=t[2]/100,i=Math.floor(e)%6,n=e-Math.floor(e),a=255*o*(1-r),s=255*o*(1-r*n),l=255*o*(1-r*(1-n));switch(o*=255,i){case 0:return[o,l,a];case 1:return[s,o,a];case 2:return[a,o,l];case 3:return[a,s,o];case 4:return[l,a,o];case 5:return[o,a,s]}};N.hsv.hsl=function(t){let e=t[0],r=t[1]/100,o=t[2]/100,i=Math.max(o,.01),n,a;a=(2-r)*o;let s=(2-r)*i;return n=r*i,n/=s<=1?s:2-s,n=n||0,a/=2,[e,n*100,a*100]};N.hwb.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100,i=r+o,n;i>1&&(r/=i,o/=i);let a=Math.floor(6*e),s=1-o;n=6*e-a,(a&1)!==0&&(n=1-n);let l=r+n*(s-r),c,f,u;switch(a){default:case 6:case 0:c=s,f=l,u=r;break;case 1:c=l,f=s,u=r;break;case 2:c=r,f=s,u=l;break;case 3:c=r,f=l,u=s;break;case 4:c=l,f=r,u=s;break;case 5:c=s,f=r,u=l;break}return[c*255,f*255,u*255]};N.cmyk.rgb=function(t){let e=t[0]/100,r=t[1]/100,o=t[2]/100,i=t[3]/100,n=1-Math.min(1,e*(1-i)+i),a=1-Math.min(1,r*(1-i)+i),s=1-Math.min(1,o*(1-i)+i);return[n*255,a*255,s*255]};N.xyz.rgb=function(t){let e=t[0]/100,r=t[1]/100,o=t[2]/100,i,n,a;return i=e*3.2406+r*-1.5372+o*-.4986,n=e*-.9689+r*1.8758+o*.0415,a=e*.0557+r*-.204+o*1.057,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,n=n>.0031308?1.055*n**(1/2.4)-.055:n*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,i=Math.min(Math.max(0,i),1),n=Math.min(Math.max(0,n),1),a=Math.min(Math.max(0,a),1),[i*255,n*255,a*255]};N.xyz.lab=function(t){let e=t[0],r=t[1],o=t[2];e/=95.047,r/=100,o/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;let i=116*r-16,n=500*(e-r),a=200*(r-o);return[i,n,a]};N.lab.xyz=function(t){let e=t[0],r=t[1],o=t[2],i,n,a;n=(e+16)/116,i=r/500+n,a=n-o/200;let s=n**3,l=i**3,c=a**3;return n=s>.008856?s:(n-16/116)/7.787,i=l>.008856?l:(i-16/116)/7.787,a=c>.008856?c:(a-16/116)/7.787,i*=95.047,n*=100,a*=108.883,[i,n,a]};N.lab.lch=function(t){let e=t[0],r=t[1],o=t[2],i;i=Math.atan2(o,r)*360/2/Math.PI,i<0&&(i+=360);let a=Math.sqrt(r*r+o*o);return[e,a,i]};N.lch.lab=function(t){let e=t[0],r=t[1],i=t[2]/360*2*Math.PI,n=r*Math.cos(i),a=r*Math.sin(i);return[e,n,a]};N.rgb.ansi16=function(t,e=null){let[r,o,i]=t,n=e===null?N.rgb.hsv(t)[2]:e;if(n=Math.round(n/50),n===0)return 30;let a=30+(Math.round(i/255)<<2|Math.round(o/255)<<1|Math.round(r/255));return n===2&&(a+=60),a};N.hsv.ansi16=function(t){return N.rgb.ansi16(N.hsv.rgb(t),t[2])};N.rgb.ansi256=function(t){let e=t[0],r=t[1],o=t[2];return e===r&&r===o?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)};N.ansi16.rgb=function(t){let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];let r=(~~(t>50)+1)*.5,o=(e&1)*r*255,i=(e>>1&1)*r*255,n=(e>>2&1)*r*255;return[o,i,n]};N.ansi256.rgb=function(t){if(t>=232){let n=(t-232)*10+8;return[n,n,n]}t-=16;let e,r=Math.floor(t/36)/5*255,o=Math.floor((e=t%36)/6)/5*255,i=e%6/5*255;return[r,o,i]};N.rgb.hex=function(t){let r=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};N.hex.rgb=function(t){let e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let r=e[0];e[0].length===3&&(r=r.split("").map(s=>s+s).join(""));let o=parseInt(r,16),i=o>>16&255,n=o>>8&255,a=o&255;return[i,n,a]};N.rgb.hcg=function(t){let e=t[0]/255,r=t[1]/255,o=t[2]/255,i=Math.max(Math.max(e,r),o),n=Math.min(Math.min(e,r),o),a=i-n,s,l;return a<1?s=n/(1-a):s=0,a<=0?l=0:i===e?l=(r-o)/a%6:i===r?l=2+(o-e)/a:l=4+(e-r)/a,l/=6,l%=1,[l*360,a*100,s*100]};N.hsl.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=r<.5?2*e*r:2*e*(1-r),i=0;return o<1&&(i=(r-.5*o)/(1-o)),[t[0],o*100,i*100]};N.hsv.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=e*r,i=0;return o<1&&(i=(r-o)/(1-o)),[t[0],o*100,i*100]};N.hcg.rgb=function(t){let e=t[0]/360,r=t[1]/100,o=t[2]/100;if(r===0)return[o*255,o*255,o*255];let i=[0,0,0],n=e%1*6,a=n%1,s=1-a,l=0;switch(Math.floor(n)){case 0:i[0]=1,i[1]=a,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=a;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=a,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return l=(1-r)*o,[(r*i[0]+l)*255,(r*i[1]+l)*255,(r*i[2]+l)*255]};N.hcg.hsv=function(t){let e=t[1]/100,r=t[2]/100,o=e+r*(1-e),i=0;return o>0&&(i=e/o),[t[0],i*100,o*100]};N.hcg.hsl=function(t){let e=t[1]/100,o=t[2]/100*(1-e)+.5*e,i=0;return o>0&&o<.5?i=e/(2*o):o>=.5&&o<1&&(i=e/(2*(1-o))),[t[0],i*100,o*100]};N.hcg.hwb=function(t){let e=t[1]/100,r=t[2]/100,o=e+r*(1-e);return[t[0],(o-e)*100,(1-o)*100]};N.hwb.hcg=function(t){let e=t[1]/100,r=t[2]/100,o=1-r,i=o-e,n=0;return i<1&&(n=(o-i)/(1-i)),[t[0],i*100,n*100]};N.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};N.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};N.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};N.gray.hsl=function(t){return[0,0,t[0]]};N.gray.hsv=N.gray.hsl;N.gray.hwb=function(t){return[0,100,t[0]]};N.gray.cmyk=function(t){return[0,0,0,t[0]]};N.gray.lab=function(t){return[t[0],0,0]};N.gray.hex=function(t){let e=Math.round(t[0]/100*255)&255,o=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(o.length)+o};N.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}});var Mh=L((ej,_h)=>{var Ea=Hl();function NI(){let t={},e=Object.keys(Ea);for(let r=e.length,o=0;o<r;o++)t[e[o]]={distance:-1,parent:null};return t}function TI(t){let e=NI(),r=[t];for(e[t].distance=0;r.length;){let o=r.pop(),i=Object.keys(Ea[o]);for(let n=i.length,a=0;a<n;a++){let s=i[a],l=e[s];l.distance===-1&&(l.distance=e[o].distance+1,l.parent=o,r.unshift(s))}}return e}function SI(t,e){return function(r){return e(t(r))}}function CI(t,e){let r=[e[t].parent,t],o=Ea[e[t].parent][t],i=e[t].parent;for(;e[i].parent;)r.unshift(e[i].parent),o=SI(Ea[e[i].parent][i],o),i=e[i].parent;return o.conversion=r,o}_h.exports=function(t){let e=TI(t),r={},o=Object.keys(e);for(let i=o.length,n=0;n<i;n++){let a=o[n];e[a].parent!==null&&(r[a]=CI(a,e))}return r}});var Fi=L((tj,kh)=>{var $l=Hl(),II=Mh(),jo={},OI=Object.keys($l);function PI(t){let e=function(...r){let o=r[0];return o==null?o:(o.length>1&&(r=o),t(r))};return"conversion"in t&&(e.conversion=t.conversion),e}function AI(t){let e=function(...r){let o=r[0];if(o==null)return o;o.length>1&&(r=o);let i=t(r);if(typeof i=="object")for(let n=i.length,a=0;a<n;a++)i[a]=Math.round(i[a]);return i};return"conversion"in t&&(e.conversion=t.conversion),e}OI.forEach(t=>{jo[t]={},Object.defineProperty(jo[t],"channels",{value:$l[t].channels}),Object.defineProperty(jo[t],"labels",{value:$l[t].labels});let e=II(t);Object.keys(e).forEach(o=>{let i=e[o];jo[t][o]=AI(i),jo[t][o].raw=PI(i)})});kh.exports=jo});var yg=L((A5,Ba)=>{var Zh,eg,tg,rg,og,ig,ng,ag,sg,La,rc,lg,cg,fg,Vo,ug,dg,pg,mg,hg,gg,wg,xg,bg,Da;(function(t){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(o){t(r(e,r(o)))}):typeof Ba=="object"&&typeof Ba.exports=="object"?t(r(e,r(Ba.exports))):t(r(e));function r(o,i){return o!==e&&(typeof Object.create=="function"?Object.defineProperty(o,"__esModule",{value:!0}):o.__esModule=!0),function(n,a){return o[n]=i?i(n,a):a}}})(function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o[n]=i[n])};Zh=function(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(o,i);function n(){this.constructor=o}o.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)},eg=Object.assign||function(o){for(var i,n=1,a=arguments.length;n<a;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(o[s]=i[s])}return o},tg=function(o,i){var n={};for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&i.indexOf(a)<0&&(n[a]=o[a]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(o);s<a.length;s++)i.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(o,a[s])&&(n[a[s]]=o[a[s]]);return n},rg=function(o,i,n,a){var s=arguments.length,l=s<3?i:a===null?a=Object.getOwnPropertyDescriptor(i,n):a,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,i,n,a);else for(var f=o.length-1;f>=0;f--)(c=o[f])&&(l=(s<3?c(l):s>3?c(i,n,l):c(i,n))||l);return s>3&&l&&Object.defineProperty(i,n,l),l},og=function(o,i){return function(n,a){i(n,a,o)}},ig=function(o,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,i)},ng=function(o,i,n,a){function s(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function f(p){try{d(a.next(p))}catch(m){c(m)}}function u(p){try{d(a.throw(p))}catch(m){c(m)}}function d(p){p.done?l(p.value):s(p.value).then(f,u)}d((a=a.apply(o,i||[])).next())})},ag=function(o,i){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,s,l,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(d){return function(p){return u([d,p])}}function u(d){if(a)throw new TypeError("Generator is already executing.");for(;n;)try{if(a=1,s&&(l=d[0]&2?s.return:d[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,d[1])).done)return l;switch(s=0,l&&(d=[d[0]&2,l.value]),d[0]){case 0:case 1:l=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,s=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!l||d[1]>l[0]&&d[1]<l[3])){n.label=d[1];break}if(d[0]===6&&n.label<l[1]){n.label=l[1],l=d;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(d);break}l[2]&&n.ops.pop(),n.trys.pop();continue}d=i.call(o,n)}catch(p){d=[6,p],s=0}finally{a=l=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},sg=function(o,i){for(var n in o)n!=="default"&&!Object.prototype.hasOwnProperty.call(i,n)&&Da(i,o,n)},Da=Object.create?function(o,i,n,a){a===void 0&&(a=n);var s=Object.getOwnPropertyDescriptor(i,n);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(o,a,s)}:function(o,i,n,a){a===void 0&&(a=n),o[a]=i[n]},La=function(o){var i=typeof Symbol=="function"&&Symbol.iterator,n=i&&o[i],a=0;if(n)return n.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&a>=o.length&&(o=void 0),{value:o&&o[a++],done:!o}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")},rc=function(o,i){var n=typeof Symbol=="function"&&o[Symbol.iterator];if(!n)return o;var a=n.call(o),s,l=[],c;try{for(;(i===void 0||i-- >0)&&!(s=a.next()).done;)l.push(s.value)}catch(f){c={error:f}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(c)throw c.error}}return l},lg=function(){for(var o=[],i=0;i<arguments.length;i++)o=o.concat(rc(arguments[i]));return o},cg=function(){for(var o=0,i=0,n=arguments.length;i<n;i++)o+=arguments[i].length;for(var a=Array(o),s=0,i=0;i<n;i++)for(var l=arguments[i],c=0,f=l.length;c<f;c++,s++)a[s]=l[c];return a},fg=function(o,i,n){if(n||arguments.length===2)for(var a=0,s=i.length,l;a<s;a++)(l||!(a in i))&&(l||(l=Array.prototype.slice.call(i,0,a)),l[a]=i[a]);return o.concat(l||Array.prototype.slice.call(i))},Vo=function(o){return this instanceof Vo?(this.v=o,this):new Vo(o)},ug=function(o,i,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(o,i||[]),s,l=[];return s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s;function c(h){a[h]&&(s[h]=function(g){return new Promise(function(x,b){l.push([h,g,x,b])>1||f(h,g)})})}function f(h,g){try{u(a[h](g))}catch(x){m(l[0][3],x)}}function u(h){h.value instanceof Vo?Promise.resolve(h.value.v).then(d,p):m(l[0][2],h)}function d(h){f("next",h)}function p(h){f("throw",h)}function m(h,g){h(g),l.shift(),l.length&&f(l[0][0],l[0][1])}},dg=function(o){var i,n;return i={},a("next"),a("throw",function(s){throw s}),a("return"),i[Symbol.iterator]=function(){return this},i;function a(s,l){i[s]=o[s]?function(c){return(n=!n)?{value:Vo(o[s](c)),done:s==="return"}:l?l(c):c}:l}},pg=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=o[Symbol.asyncIterator],n;return i?i.call(o):(o=typeof La=="function"?La(o):o[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(l){n[l]=o[l]&&function(c){return new Promise(function(f,u){c=o[l](c),s(f,u,c.done,c.value)})}}function s(l,c,f,u){Promise.resolve(u).then(function(d){l({value:d,done:f})},c)}},mg=function(o,i){return Object.defineProperty?Object.defineProperty(o,"raw",{value:i}):o.raw=i,o};var r=Object.create?function(o,i){Object.defineProperty(o,"default",{enumerable:!0,value:i})}:function(o,i){o.default=i};hg=function(o){if(o&&o.__esModule)return o;var i={};if(o!=null)for(var n in o)n!=="default"&&Object.prototype.hasOwnProperty.call(o,n)&&Da(i,o,n);return r(i,o),i},gg=function(o){return o&&o.__esModule?o:{default:o}},wg=function(o,i,n,a){if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?o!==i||!a:!i.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?a:n==="a"?a.call(o):a?a.value:i.get(o)},xg=function(o,i,n,a,s){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?o!==i||!s:!i.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?s.call(o,n):s?s.value=n:i.set(o,n),n},bg=function(o,i){if(i===null||typeof i!="object"&&typeof i!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?i===o:o.has(i)},t("__extends",Zh),t("__assign",eg),t("__rest",tg),t("__decorate",rg),t("__param",og),t("__metadata",ig),t("__awaiter",ng),t("__generator",ag),t("__exportStar",sg),t("__createBinding",Da),t("__values",La),t("__read",rc),t("__spread",lg),t("__spreadArrays",cg),t("__spreadArray",fg),t("__await",Vo),t("__asyncGenerator",ug),t("__asyncDelegator",dg),t("__asyncValues",pg),t("__makeTemplateObject",mg),t("__importStar",hg),t("__importDefault",gg),t("__classPrivateFieldGet",wg),t("__classPrivateFieldSet",xg),t("__classPrivateFieldIn",bg)})});var Qg=L((FG,pc)=>{"use strict";var Xg=(t,e,r)=>new Promise((o,i)=>{if(r=Object.assign({concurrency:1/0},r),typeof e!="function")throw new TypeError("Mapper function is required");let{concurrency:n}=r;if(!(typeof n=="number"&&n>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${n}\` (${typeof n})`);let a=[],s=t[Symbol.iterator](),l=!1,c=!1,f=0,u=0,d=()=>{if(l)return;let p=s.next(),m=u;if(u++,p.done){c=!0,f===0&&o(a);return}f++,Promise.resolve(p.value).then(h=>e(h,m)).then(h=>{a[m]=h,f--,d()},h=>{l=!0,i(h)})};for(let p=0;p<n&&(d(),!c);p++);});pc.exports=Xg;pc.exports.default=Xg});var hc=L((jG,mc)=>{"use strict";var QI=Qg(),Jg=async(t,e,r)=>(await QI(t,(i,n)=>Promise.all([e(i,n),i]),r)).filter(i=>Boolean(i[0])).map(i=>i[1]);mc.exports=Jg;mc.exports.default=Jg});var iw=L((tU,bc)=>{"use strict";var ew=require("child_process").exec,tw=require("child_process").execSync,rs=require("fs"),Zg=require("path"),rw=rs.access,ow=rs.accessSync,Zo=rs.constants||rs,wc=process.platform=="win32",tO=function(t,e){rw(t,Zo.F_OK,function(r){e(!r)})},rO=function(t){try{return ow(t,Zo.F_OK),!1}catch{return!0}},oO=function(t,e){rw(t,Zo.F_OK|Zo.X_OK,function(r){e(null,!r)})},iO=function(t){try{return ow(t,Zo.F_OK|Zo.X_OK),!0}catch{return!1}},nO=function(t,e,r){tO(t,function(o){if(!o){var i=ew("command -v "+e+" 2>/dev/null && { echo >&1 "+e+"; exit 0; }",function(n,a,s){r(null,!!a)});return}oO(t,r)})},aO=function(t,e,r){if(!/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(t)){r(null,!1);return}var o=ew("where "+e,function(i){i!==null?r(null,!1):r(null,!0)})},sO=function(t,e){if(rO(t))try{var r=tw("command -v "+e+" 2>/dev/null && { echo >&1 "+e+"; exit 0; }");return!!r}catch{return!1}return iO(t)},lO=function(t,e,r){if(!/^(?!(?:.*\s|.*\.|\W+)$)(?:[a-zA-Z]:)?(?:(?:[^<>:"\|\?\*\n])+(?:\/\/|\/|\\\\|\\)?)+$/m.test(t))return!1;try{var o=tw("where "+e,{stdio:[]});return!!o}catch{return!1}},xc=function(t){return/[^A-Za-z0-9_\/:=-]/.test(t)&&(t="'"+t.replace(/'/g,"'\\''")+"'",t=t.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t};wc&&(xc=function(t){var e=/[\\]/.test(t);if(e){var r='"'+Zg.dirname(t)+'"',o='"'+Zg.basename(t)+'"';return r+":"+o}return'"'+t+'"'});bc.exports=function t(e,r){var o=xc(e);if(!r&&typeof Promise<"u")return new Promise(function(i,n){t(e,function(a,s){s?i(e):n(a)})});wc?aO(e,o,r):nO(e,o,r)};bc.exports.sync=function(t){var e=xc(t);return wc?lO(t,e):sO(t,e)}});var aw=L((rU,nw)=>{nw.exports=iw()});var Cw=L(sr=>{"use strict";var fO=sr&&sr.__awaiter||function(t,e,r,o){function i(n){return n instanceof r?n:new r(function(a){a(n)})}return new(r||(r=Promise))(function(n,a){function s(f){try{c(o.next(f))}catch(u){a(u)}}function l(f){try{c(o.throw(f))}catch(u){a(u)}}function c(f){f.done?n(f.value):i(f.value).then(s,l)}c((o=o.apply(t,e||[])).next())})};Object.defineProperty(sr,"__esModule",{value:!0});sr.isBinaryFileSync=sr.isBinaryFile=void 0;var ar=require("fs"),Cc=require("util"),uO=Cc.promisify(ar.stat),dO=Cc.promisify(ar.open),pO=Cc.promisify(ar.close),Zi=512,Sc=class{constructor(e,r){this.fileBuffer=e,this.size=r,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let r=new Array;for(let o=0;o<e;o++)r[o]=this.nextByte();return r}};function Tc(t){let e=0,r=0;for(;!t.hasError();){let o=t.nextByte();if(r=r|(o&127)<<7*e,(o&128)===0)break;e++}return r}function mO(t){switch(Tc(t)&7){case 0:return Tc(t),!0;case 1:return t.next(8),!0;case 2:let o=Tc(t);return t.next(o),!0;case 5:return t.next(4),!0}return!1}function hO(t,e){let r=new Sc(t,e),o=0;for(;;){if(!mO(r)&&!r.hasError())return!1;if(r.hasError())break;o++}return o>0}function gO(t,e){return fO(this,void 0,void 0,function*(){if(Tw(t)){let r=yield uO(t);Sw(r);let o=yield dO(t,"r"),i=Buffer.alloc(Zi);return new Promise((n,a)=>{ar.read(o,i,0,Zi,0,(s,l,c)=>{pO(o),s?a(s):n(is(i,l))})})}else return e===void 0&&(e=t.length),is(t,e)})}sr.isBinaryFile=gO;function wO(t,e){if(Tw(t)){let r=ar.statSync(t);Sw(r);let o=ar.openSync(t,"r"),i=Buffer.alloc(Zi),n=ar.readSync(o,i,0,Zi,0);return ar.closeSync(o),is(i,n)}else return e===void 0&&(e=t.length),is(t,e)}sr.isBinaryFileSync=wO;function is(t,e){if(e===0)return!1;let r=0,o=Math.min(e,Zi);if(e>=3&&t[0]===239&&t[1]===187&&t[2]===191||e>=4&&t[0]===0&&t[1]===0&&t[2]===254&&t[3]===255||e>=4&&t[0]===255&&t[1]===254&&t[2]===0&&t[3]===0||e>=4&&t[0]===132&&t[1]===49&&t[2]===149&&t[3]===51)return!1;if(o>=5&&t.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&t[0]===254&&t[1]===255||e>=2&&t[0]===255&&t[1]===254)return!1;for(let i=0;i<o;i++){if(t[i]===0)return!0;if((t[i]<7||t[i]>14)&&(t[i]<32||t[i]>127)){if(t[i]>193&&t[i]<224&&i+1<o){if(i++,t[i]>127&&t[i]<192)continue}else if(t[i]>223&&t[i]<240&&i+2<o&&(i++,t[i]>127&&t[i]<192&&t[i+1]>127&&t[i+1]<192)){i++;continue}if(r++,i>=32&&r*100/o>10)return!0}}return!!(r*100/o>10||r>1&&hO(t,o))}function Tw(t){return typeof t=="string"}function Sw(t){if(!t.isFile())throw new Error("Path provided was not a file!")}});var Gc=L((xV,cx)=>{"use strict";var lx=require("fs"),$c;function PO(){try{return lx.statSync("/.dockerenv"),!0}catch{return!1}}function AO(){try{return lx.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}cx.exports=()=>($c===void 0&&($c=PO()||AO()),$c)});var dx=L((bV,Uc)=>{"use strict";var _O=require("os"),MO=require("fs"),fx=Gc(),ux=()=>{if(process.platform!=="linux")return!1;if(_O.release().toLowerCase().includes("microsoft"))return!fx();try{return MO.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!fx():!1}catch{return!1}};process.env.__IS_WSL_TEST__?Uc.exports=ux:Uc.exports=ux()});var mx=L((yV,px)=>{"use strict";px.exports=(t,e,r)=>{let o=i=>Object.defineProperty(t,e,{value:i,enumerable:!0,writable:!0});return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get(){let i=r();return o(i),i},set(i){o(i)}}),t}});var vx=L((vV,yx)=>{var kO=require("path"),RO=require("child_process"),{promises:qc,constants:bx}=require("fs"),Ts=dx(),LO=Gc(),Vc=mx(),hx=kO.join(__dirname,"xdg-open"),{platform:li,arch:gx}=process,DO=(()=>{let t="/mnt/",e;return async function(){if(e)return e;let r="/etc/wsl.conf",o=!1;try{await qc.access(r,bx.F_OK),o=!0}catch{}if(!o)return t;let i=await qc.readFile(r,{encoding:"utf8"}),n=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(i);return n?(e=n.groups.mountPoint.trim(),e=e.endsWith("/")?e:`${e}/`,e):t}})(),wx=async(t,e)=>{let r;for(let o of t)try{return await e(o)}catch(i){r=i}throw r},Ss=async t=>{if(t=S({wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1},t),Array.isArray(t.app))return wx(t.app,s=>Ss(U(S({},t),{app:s})));let{name:e,arguments:r=[]}=t.app||{};if(r=[...r],Array.isArray(e))return wx(e,s=>Ss(U(S({},t),{app:{name:s,arguments:r}})));let o,i=[],n={};if(li==="darwin")o="open",t.wait&&i.push("--wait-apps"),t.background&&i.push("--background"),t.newInstance&&i.push("--new"),e&&i.push("-a",e);else if(li==="win32"||Ts&&!LO()){let s=await DO();o=Ts?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,i.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),Ts||(n.windowsVerbatimArguments=!0);let l=["Start"];t.wait&&l.push("-Wait"),e?(l.push(`"\`"${e}\`""`,"-ArgumentList"),t.target&&r.unshift(t.target)):t.target&&l.push(`"${t.target}"`),r.length>0&&(r=r.map(c=>`"\`"${c}\`""`),l.push(r.join(","))),t.target=Buffer.from(l.join(" "),"utf16le").toString("base64")}else{if(e)o=e;else{let s=!__dirname||__dirname==="/",l=!1;try{await qc.access(hx,bx.X_OK),l=!0}catch{}o=process.versions.electron||li==="android"||s||!l?"xdg-open":hx}r.length>0&&i.push(...r),t.wait||(n.stdio="ignore",n.detached=!0)}t.target&&i.push(t.target),li==="darwin"&&r.length>0&&i.push("--args",...r);let a=RO.spawn(o,i,n);return t.wait?new Promise((s,l)=>{a.once("error",l),a.once("close",c=>{if(t.allowNonzeroExitCode&&c>0){l(new Error(`Exited with code ${c}`));return}s(a)})}):(a.unref(),a)},Yc=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a `target`");return Ss(U(S({},e),{target:t}))},BO=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a `name`");let{arguments:r=[]}=e||{};if(r!=null&&!Array.isArray(r))throw new TypeError("Expected `appArguments` as Array type");return Ss(U(S({},e),{app:{name:t,arguments:r}}))};function xx(t){if(typeof t=="string"||Array.isArray(t))return t;let{[gx]:e}=t;if(!e)throw new Error(`${gx} is not supported`);return e}function zc({[li]:t},{wsl:e}){if(e&&Ts)return xx(e);if(!t)throw new Error(`${li} is not supported`);return xx(t)}var Cs={};Vc(Cs,"chrome",()=>zc({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));Vc(Cs,"firefox",()=>zc({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));Vc(Cs,"edge",()=>zc({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));Yc.apps=Cs;Yc.openApp=BO;yx.exports=Yc});var Wx=L((s6,Bx)=>{"use strict";var YO=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],zO=["B","kiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],KO=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],XO=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Dx=(t,e,r)=>{let o=t;return typeof e=="string"||Array.isArray(e)?o=t.toLocaleString(e,r):(e===!0||r!==void 0)&&(o=t.toLocaleString(void 0,r)),o};Bx.exports=(t,e)=>{if(!Number.isFinite(t))throw new TypeError(`Expected a finite number, got ${typeof t}: ${t}`);e=Object.assign({bits:!1,binary:!1},e);let r=e.bits?e.binary?XO:KO:e.binary?zO:YO;if(e.signed&&t===0)return` 0 ${r[0]}`;let o=t<0,i=o?"-":e.signed?"+":"";o&&(t=-t);let n;if(e.minimumFractionDigits!==void 0&&(n={minimumFractionDigits:e.minimumFractionDigits}),e.maximumFractionDigits!==void 0&&(n=Object.assign({maximumFractionDigits:e.maximumFractionDigits},n)),t<1){let c=Dx(t,e.locale,n);return i+c+" "+r[0]}let a=Math.min(Math.floor(e.binary?Math.log(t)/Math.log(1024):Math.log10(t)/3),r.length-1);t/=Math.pow(e.binary?1024:1e3,a),n||(t=t.toPrecision(3));let s=Dx(Number(t),e.locale,n),l=r[a];return i+s+" "+l}});var V1={};xb(V1,{activate:()=>q1});module.exports=bb(V1);var so=require("coc.nvim");var ao=require("coc.nvim");var xi=require("coc.nvim");var Fs=require("coc.nvim");var di=t=>t.filter(e=>e!=null);var vb=require("coc.nvim");var Df=require("coc.nvim");var yb=process.platform==="win32",K1=process.platform==="darwin",X1=process.platform==="linux",Ws=process.env.NODE_ENV==="test";async function Bf(t){return await Df.workspace.nvim.call("strdisplaywidth",[t])}var pi=require("coc.nvim"),jf=_(require("util"));var mn=["trace","debug","info","warn","error","fatal","off"],Eb=mn.indexOf("error");function Wf(t){return`${t.toLocaleString()} ${t.getMilliseconds().toString().padStart(3,"0")}`}var mi=class{constructor(e){this.channelName=e,this.timeMarkers=new Map,this.levelStatus="trace",this.levelNumber=mn.indexOf(this.levelStatus),this.appendLine=r=>{this.outputChannel.appendLine(r)},this.log=(r,o)=>{var i,n;let a=mn[r];if(a<this.levelNumber)return;let s=`[${Wf(new Date)}] [${r}]: `;if(o instanceof Error){this.appendLine(`${s}${(i=o.stack)!==null&&i!==void 0?i:o.toString()}`),pi.window.showMessage(o.message,"error"),Ws&&console.error((n=o.stack)!==null&&n!==void 0?n:o.toString());return}this.appendLine(`${s}${o}`),a>Eb&&(pi.window.showMessage(o,"error"),Ws&&console.error(o))},this.trace=r=>{this.log("trace",r)},this.debug=r=>{this.log("debug",r)},this.info=r=>{this.log("info",r)},this.warn=r=>{this.log("warn",r)},this.error=r=>{r instanceof Error||(r=new Error(r)),this.log("error",r)},this.fatal=r=>{this.log("fatal",r)}}set level(e){this.levelStatus=e,this.levelNumber=mn[e]}get level(){return this.levelStatus}dispose(){var e;(e=this.outputChannel_)===null||e===void 0||e.dispose()}get outputChannel(){return this.outputChannel_||(this.outputChannel_=pi.window.createOutputChannel(this.channelName)),this.outputChannel_}time(e="default"){this.timeMarkers.set(e,new Date().valueOf())}timeElapsed(e="default"){let r=this.timeMarkers.get(e);if(r!==void 0)return new Date().valueOf()-r}timeLog(e="default"){let r=this.timeElapsed(e);r!==void 0&&this.appendLine(`${e}: ${r} ms`)}measureTime(e){let r=new Date().valueOf(),o=e();return"then"in o?o.then(i=>[i,new Date().valueOf()-r]):[o,new Date().valueOf()-r]}measureTask(e,r="default",o="info"){let i=this.measureTime(e);if(!("then"in i)){let[n,a]=i;return this.log(o,`[measureTask] ${r}: ${a} ms`),n}return i.then(([n,a])=>(this.log(o,`${r}: ${a} ms`),n))}asyncCatch(e){return async(...r)=>{try{return await e(...r)}catch(o){this.error(o)}}}prettyPrint(...e){this.info(Ff(...e)),pi.window.showMessage(`[${Wf(new Date)}] ${Ff(...e)}`)}},Le=new mi("coc-helper");function Ff(...t){return t.map(e=>jf.default.inspect(e)).join(" ")}var Nb="coc-helper",Tb="0.13.0",Sb="Helpers for coc.nvim",Cb="lib/esm/index.js",Ib="lib/cjs/index.js",Ob="https://github.com/weirongxu/coc-helper",Pb="git@github.com:weirongxu/coc-helper.git",Ab="Weirong Xu <weirongxu.raidou@gmail.com>",_b="MIT",Mb=["lib","tests","jest.config.js","JestHelper.js","JestHelper.d.ts"],kb={clean:"rimraf lib","copy:pkg":"cpy --rename=_package.json package.json src/","build:esm":"tsc -p ./tsconfig.prod.json --module es2020 --outDir lib/esm","build:cjs":"tsc -p ./tsconfig.prod.json --module commonjs --outDir lib/cjs",build:"npm-run-all clean copy:pkg build:esm build:cjs",lint:"eslint src --ext ts","setup:test-env":"node ./tests/setup.js",prepare:"run-s clean setup:test-env build",unittest:"jest --runInBand --detectOpenHandles --forceExit",test:"npm-run-all copy:pkg lint unittest"},Rb={coc:"^0.0.77"},Lb=["*"],Db={singleQuote:!0,printWidth:80,semi:!0,trailingComma:"all"},Bb={"coc.nvim":"*"},Wb={"@chemzqm/neovim":"^5.4.0","@raidou/eslint-config-base":"^1.5.0","@types/eslint":"^8.2.1","@types/jest":"^27.0.1","@types/node":"^17.0.6","@types/rimraf":"^3.0.2","@types/uuid":"^8.3.1","coc.nvim":"0.0.81-next.0","cpy-cli":"^3.1.1",eslint:"^8.6.0",jest:"^27.2.0",log4js:"^6.3.0","npm-run-all":"^4.1.5",prettier:"^2.5.1","ts-jest":"^27.0.5","type-fest":"^2.3.2",typescript:"^4.4.3"},Fb={rimraf:"^3.0.2",uuid:"^8.3.2"},Hf={name:Nb,version:Tb,description:Sb,module:Cb,main:Ib,homepage:Ob,repository:Pb,author:Ab,license:_b,files:Mb,scripts:kb,engines:Rb,activationEvents:Lb,prettier:Db,peerDependencies:Bb,devDependencies:Wb,dependencies:Fb};var jb=Hf.version,io=jb.replace(/[.-]/g,"_");var E=class{constructor(e){this.notifyFns=[],this.notifyFns.push(e)}static async run(e){if(!!e)if("then"in e){let r=await e;if(r)return r.run()}else return e.run()}static notifyAll(e){for(let r of e)r&&r.notify()}static async runAll(e){let r=await Promise.all(e);return Fs.workspace.nvim.pauseNotification(),this.notifyAll(r),Fs.workspace.nvim.resumeNotification()}static combine(e){let r=di(e);return r.length<1?E.noop():r.length===1?r[0]:r.reduce((o,i)=>o.concat(i),E.noop())}static noop(){return this.create(()=>{})}static create(e){return new E(e)}async run(){return E.runAll([this])}notify(){for(let e of this.notifyFns)e()}concat(e){return this.notifyFns.push(...e.notifyFns),this}};var Hb="__coc_helper_module_max_id";function no(t){let e=`${Hb}_${t}`;return e in global||(global[e]=0),global[e]+=1,global[e]}var js=no("VimModule"),$b=`coc_helper_module_m${js}_v${io}`,rt=`g:${$b}`,hi=`CocHelperCallFn_m${js}_v${io}`,gi=`CocHelperCallVar_m${js}_v${io}`;function wi(t){return t.replace(/\n\s*\\/g,"")}var fe=class{constructor(e){this.moduleKey=e}static async init(e){this.inited=!0,await xi.workspace.nvim.call("execute",`
        if !exists('${rt}')
          let ${rt} = {}
        endif

        function! ${hi}(module_key, method_name, args)
          try
            return call(${rt}[a:module_key][a:method_name], a:args)
          catch
            let ex = v:exception
            let msg = printf('error when call %s.%s.%s, args: [%s]', '${rt}', a:module_key, a:method_name, join(a:args, ','))
            echom msg
            echom ex
            throw msg . ' ' . ex
          endtry
        endfunction

        function! ${gi}(module_key, var_name, expression)
          try
            let ${rt}[a:module_key][a:var_name] = eval(a:expression)
          catch
            let ex = v:exception
            let msg = printf('error when declare %s.%s.%s, expression: %s', '${rt}', a:module_key, a:var_name, a:expression)
            echom msg
            echom ex
            throw msg . ' ' . ex
          endtry
        endfunction
      `);let r=[...this.initQueue];for(;r.length;){let o=r.shift();try{await o.fn(e)}catch(i){Le.error(i)}this.initAfterQueue.length&&(r.push(...this.initAfterQueue),this.initAfterQueue=[])}}static registerInit(e,r){this.inited?this.initAfterQueue.push({description:e,fn:r}):this.initQueue.push({description:e,fn:r})}static create(e,r){let i=`${no("VimModule.module")}_${e}`,n=new fe(i),a;function s(){return a||(a=r(n)),a}return fe.registerInit(`module ${i}`,async()=>{await xi.workspace.nvim.call("execute",`
          if !exists('${rt}.${i}')
            let ${rt}.${i} = {}
          endif
        `),s()}),new Proxy({},{get(l,c){return Reflect.get(s(),c)},has(l,c){return c in s()},ownKeys(){return Object.keys(s())}})}registerInit(e,r){return typeof e=="string"?fe.registerInit(e,r):this.registerInit("",e)}fn(e,r){let{nvim:o}=xi.workspace,i=`${rt}.${this.moduleKey}.${e}`,n=r({name:i});return this.registerInit(`fn ${i}`,async()=>{Le.debug(`declare fn ${i}`),await o.call("execute",[wi(n)])}),{name:i,inlineCall:(a="")=>`${hi}('${this.moduleKey}', '${e}', [${a}])`,call:(...a)=>(Le.debug(`call ${i}`),o.call(hi,[this.moduleKey,e,a])),callNotify:(...a)=>(Le.debug(`callNotify ${i}`),o.call(hi,[this.moduleKey,e,a],!0)),callNotifier:(...a)=>(Le.debug(`callNotifier ${i}`),E.create(()=>{o.call(hi,[this.moduleKey,e,a],!0)}))}}var(e,r){let{nvim:o}=xi.workspace,i=`${rt}.${this.moduleKey}.${e}`;return this.registerInit(`var ${i}`,async()=>{Le.debug(`declare var ${i}`),await o.call(gi,[this.moduleKey,e,wi(r)])}),{name:i,inline:i,get:()=>o.eval(i),set:async n=>{await o.call(gi,[this.moduleKey,e,wi(n)])},setNotify:n=>{o.call(gi,[this.moduleKey,e,wi(n)],!0)},setNotifier:n=>E.create(()=>{o.call(gi,[this.moduleKey,e,wi(n)],!0)})}}};fe.inited=!1;fe.initQueue=[];fe.initAfterQueue=[];var $f=require("coc.nvim"),Sr=fe.create("util",t=>{let e=$f.workspace.isNvim;return{globalCursorPosition:t.fn("global_cursor_position",({name:r})=>`
        function! ${r}()
          let nr = winnr()
          let [row, col] = win_screenpos(nr)
          return [row + winline() - 2, col + wincol() - 2]
        endfunction
      `),isFloat:t.fn("is_float",({name:r})=>e?`
          function! ${r}(winnr) abort
            if !exists('*nvim_win_get_config')
              return v:false
            endif
            let winid = win_getid(a:winnr)
            return nvim_win_get_config(winid)['relative'] != ''
          endfunction
        `:`
          function! ${r}(winnr) abort
            return v:false
          endfunction
        `),closeWinByBufnr:t.fn("close_win_by_bufnr",({name:r})=>`
        if exists('*nvim_win_close')
          function! ${r}(bufnrs) abort
            for bufnr in a:bufnrs
              try
                let winid = bufwinid(bufnr)
                if winid >= 0
                  call nvim_win_close(winid, v:true)
                endif
              catch
              endtry
            endfor
          endfunction
        else
          function! ${r}(bufnrs) abort
            for bufnr in a:bufnrs
              try
                let winnr = bufwinnr(bufnr)
                if winnr >= 0
                  execute winnr . 'wincmd c'
                endif
              catch
              endtry
            endfor
          endfunction
        endif
      `),runCocCmd:t.fn("run_coc_cmd",({name:r})=>`
      function! ${r}(name, ...) abort
        return call('CocAction', extend(['runCommand', a:name], a:000))
      endfunction
    `),runCocCmdAsync:t.fn("run_coc_cmd_async",({name:r})=>`
      function! ${r}(name, ...) abort
        return call('CocActionAsync', extend(['runCommand', a:name], a:000))
      endfunction
    `)}});var Gb=no("events"),Gf=`m${Gb}_v${io}`,ht=class{constructor(e,r=!1){this.helperLogger=e,this.concurrent=r,this.listenersMap=new Map}listeners(e){if(!this.listenersMap.has(e)){let r=[];return this.listenersMap.set(e,r),r}return this.listenersMap.get(e)}once(e,r,o){this.listeners(e).push(async(...n)=>{let a=await r(...n);return i.dispose(),a});let i=ao.Disposable.create(()=>this.off(e,r));return o&&o.push(i),i}on(e,r,o){this.listeners(e).push(r);let i=ao.Disposable.create(()=>this.off(e,r));return o&&o.push(i),i}off(e,r){typeof r.cancel=="function"&&r.cancel();let o=this.listeners(e),i=o.indexOf(r);i!==-1&&o.splice(i,1)}async fire(e,...r){if(this.concurrent)await Promise.all(this.listeners(e).map(async o=>{try{await o(...r)}catch(i){this.helperLogger.error(i)}}));else for(let o of this.listeners(e))try{await o(...r)}catch(i){this.helperLogger.error(i)}}},bi=class{constructor(e,r,o={}){var i;this.vimEvents=e,this.helperLogger=r,this.options=o,this.id=no("events.id"),this.augroupName=`CocHelperInternal_${Gf}_${o.name?`${o.name}_`:""}${this.id}`,this.commandName=`coc-helper.internal.didVimEvent_${Gf}_${o.name?`${o.name}_`:""}${this.id}`,this.events=new ht(this.helperLogger,(i=o.concurrent)!==null&&i!==void 0?i:!1)}async register(e){await Uf.activate.call(this.augroupName,this.commandName,Object.entries(this.vimEvents).map(([r,o])=>Object.assign({event:r},o))),e.subscriptions.push(ao.Disposable.create(()=>{Uf.deactivate.call(this.augroupName).catch(this.helperLogger.error)})),e.subscriptions.push(ao.commands.registerCommand(this.commandName,Le.asyncCatch((r,...o)=>this.events.fire(r,...o)),void 0,!0))}},Hs=new bi({BufDelete:{eventExpr:"BufDelete *",argExprs:["+expand('<abuf>')"]},BufWipeout:{eventExpr:"BufWipeout *",argExprs:["+expand('<abuf>')"]}},Le,{name:"coc_helper"}),Ub=Hs.events,Uf=fe.create("events",t=>{let e=t.fn("activate",({name:o})=>`
      function! ${o}(augroup_name, autocmd_events) abort
        execute 'augroup ' . a:augroup_name
          autocmd!
          for autocmd_event in a:autocmd_events
            execute autocmd_event
          endfor
        augroup END
      endfunction
    `);function r(o,i){return i.map(n=>{var a;let s=`${[`'${o}'`,`'${n.event}'`,...(a=n.argExprs)!==null&&a!==void 0?a:[]].join(", ")}`;return`autocmd ${n.eventExpr} call ${n.async===!1?Sr.runCocCmd.inlineCall(s):Sr.runCocCmdAsync.inlineCall(s)}`})}return{activate:{call:(o,i,n)=>e.call(o,r(i,n)),callNotify:(o,i,n)=>e.callNotify(o,r(i,n)),callNotifier:(o,i,n)=>e.callNotifier(o,r(i,n))},deactivate:t.fn("deactivate",({name:o})=>`
        function! ${o}(augroup_name) abort
          execute 'augroup ' . a:augroup_name
            autocmd!
          augroup END
        endfunction
      `),doAutocmd:t.fn("do_autocmd",({name:o})=>`
        function! ${o}(name) abort
          if exists('#User#'.a:name)
            exe 'doautocmd <nomodeline> User '.a:name
          endif
        endfunction
      `)}});var De=require("coc.nvim");var Vf=require("coc.nvim");var qf=require("coc.nvim"),$s=fe.create("buf",t=>{let e=qf.workspace.isNvim,r=t.fn("create_by_name",({name:o})=>`
      function! ${o}(name) abort
        return bufadd(a:name)
      endfunction
    `);return{createByName:r,create:t.fn("create",({name:o})=>e?`
          function! ${o}(...) abort
            let name = get(a:000, 0, '')
            if name is ''
              return nvim_create_buf(v:false, v:true)
            else
              return ${r.inlineCall("name")}
            endif
          endfunction
        `:`
          function! ${o}(...) abort
            let name = get(a:000, 0, '')
            return ${r.inlineCall("name")}
          endfunction
        `)}});var ot=fe.create("float",t=>{let e=Vf.workspace.isNvim,r=t.fn("init_execute",({name:i})=>`
      function! ${i}(ctx, inited_execute) abort
        execute a:inited_execute
      endfunction
    `),o=t.fn("open_win",({name:i})=>e?`
        function! ${i}(bufnr, focus, win_config, win_hl, inited_execute) abort
          noau let winid = nvim_open_win(a:bufnr, a:focus, a:win_config)
          if !empty(a:win_hl)
            call nvim_win_set_option(winid, 'winhl', a:win_hl)
          endif
          if !empty(a:inited_execute)
            call ${r.inlineCall("{'bufnr': a:bufnr, 'winid': winid}, a:inited_execute")}
          endif
          return winid
        endfunction
      `:`
        function! ${i}(bufnr, focus, win_config, win_hl, inited_execute) abort
          let winid = popup_create(a:bufnr, a:win_config)
          call ${r.inlineCall("{'bufnr': a:bufnr, 'winid': winid}, a:inited_execute")}

          return winid
        endfunction
      `);return{create:t.fn("create",({name:i})=>e?`
            function! ${i}(name, inited_execute, has_border_buf, border_inited_execute) abort
              let bufnr = ${$s.create.inlineCall("a:name")}
              call ${r.inlineCall("{'bufnr': bufnr}, a:inited_execute")}

              let border_bufnr = v:null
              if a:has_border_buf
                let border_bufnr = nvim_create_buf(v:false, v:true)
                call ${r.inlineCall("{'bufnr': border_bufnr}, a:border_inited_execute")}
              endif
              return [bufnr, border_bufnr]
            endfunction
          `:`
            function! ${i}(name, inited_execute, has_border_buf, border_inited_execute) abort
              let bufnr = ${$s.create.inlineCall("a:name")}
              call ${r.inlineCall("{'bufnr': bufnr}, a:inited_execute")}
              return [bufnr, v:null]
            endfunction
          `),open:t.fn("open",({name:i})=>`
        function! ${i}(bufnr, win_config, inited_execute, border_bufnr, border_win_config, border_inited_execute, focus, win_hl) abort
          let winid = ${o.inlineCall("a:bufnr, a:focus, a:win_config, a:win_hl, a:inited_execute")}
          call setbufvar(a:bufnr, 'coc_helper_winid', winid)

          if a:border_bufnr
            let border_winid = ${o.inlineCall("a:border_bufnr, v:false, a:border_win_config, a:win_hl, a:border_inited_execute")}
            call setbufvar(a:bufnr, 'coc_helper_border_winid', border_winid)
          endif
        endfunction
      `),resume:t.fn("resume",({name:i})=>`
        function! ${i}(bufnr, win_config, border_bufnr, border_win_config, focus, win_hl) abort
          let winid = ${o.inlineCall("a:bufnr, a:focus, a:win_config, a:win_hl, ''")}
          call setbufvar(a:bufnr, 'coc_helper_winid', winid)

          if a:border_bufnr
            let border_winid = ${o.inlineCall("border_bufnr, v:false, a:border_win_config, a:win_hl, ''")}
            call setbufvar(a:bufnr, 'coc_helper_border_winid', border_winid)
          endif
        endfunction
      `),update:t.fn("update",({name:i})=>e?`
          function! ${i}(bufnr, win_config, border_bufnr, border_win_config, win_hl) abort
            let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
            if !winid
              return
            endif
            call nvim_win_set_config(winid, a:win_config)
            if !empty(a:win_hl)
              call nvim_win_set_option(winid, 'winhl', a:win_hl)
            endif
            if has('nvim')
              redraw!
            endif

            if a:border_bufnr
              let border_winid = getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
              if border_winid
                call nvim_win_set_config(border_winid, a:border_win_config)
                if !empty(a:win_hl)
                  call nvim_win_set_option(border_winid, 'winhl', a:win_hl)
                endif
                if has('nvim')
                  redraw!
                endif
              endif
            endif
          endfunction
        `:`
          function! ${i}(bufnr, win_config, border_bufnr, border_win_config, win_hl) abort
            let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
            if !winid
              return
            endif
            call popup_setoptions(winid, a:win_config)
          endfunction
        `),winid:t.fn("winid",({name:i})=>`
        function! ${i}(bufnr) abort
          let id = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
          let nr = win_id2win(id)
          return nr is 0 ? v:null : id
        endfunction
      `),borderWinid:t.fn("border_winid",({name:i})=>`
        function! ${i}(bufnr) abort
          return getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
        endfunction
      `),close:t.fn("close",({name:i})=>e?`
            function! ${i}(bufnr) abort
              let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
              let border_winid = getbufvar(a:bufnr, 'coc_helper_border_winid', v:null)
              try
                if winid
                  call nvim_win_close(winid, v:true)
                endif
                if border_winid
                  call nvim_win_close(border_winid, v:true)
                endif
              catch
              endtry
            endfunction
          `:`
            function! ${i}(bufnr) abort
              let winid = getbufvar(a:bufnr, 'coc_helper_winid', v:null)
              try
                if winid
                  call popup_close(winid)
                endif
              catch
              endtry
            endfunction
          `)}});var _t=require("coc.nvim");var Yf=["\u2500","\u2502","\u2500","\u2502","\u250C","\u2510","\u2518","\u2514"],zf="CocHelperNormalFloat",qb="CocHelperNormalFloatNC",Kf="CocHelperNormalFloatBorder",yi=class{constructor(e){this.srcId=e}async createContext(e){var r,o;return(r=e.context)!==null&&r!==void 0?r:{lines:_t.workspace.env.lines,columns:_t.workspace.env.columns-_t.workspace.env.cmdheight-1,globalCursorPosition:await Sr.globalCursorPosition.call(),title:e.title?{text:e.title,width:await Bf(e.title)}:{text:"",width:0},borderEnabled:!!e.border,border:this.extendEdges((o=e.border)===null||o===void 0?void 0:o.map(i=>typeof i=="boolean"?1:i)),paddingEnabled:!!e.padding,padding:this.extendEdges(e.padding)}}getCenterPos(e,r){let[,,o,i]=r,n=Math.floor((e.lines-i)/2),a=Math.floor((e.columns-o)/2);return[n,a]}getPosForAround(e,r,o,i=!1){let n=e.columns,a=e.lines-1,[s,l]=r,[c,f]=o;return i?c-l<0?c+=1:c-=l:c+l>=a?c-=l:c+=1,f+s>=n&&(f-=s-1),[c,f]}extendEdges(e){var r,o,i,n;if(!e)return[0,0,0,0];let a=(r=e[0])!==null&&r!==void 0?r:1,s=(o=e[1])!==null&&o!==void 0?o:a,l=(i=e[2])!==null&&i!==void 0?i:a,c=(n=e[3])!==null&&n!==void 0?n:s;return[a,s,l,c]}changeBoxByEdgesList(e,r){let o=[...e];for(let i of r)o=this.changeBoxByEdges(o,i);return o}changeBoxByEdges(e,r){if(!r)return e;let[o,i,n,a]=r,[s,l,c,f]=e;return s-=o,l-=a,c+=a+i,f+=o+n,[s,l,c,f]}getBoxSizes(e,r,o){var i,n;let[a,s]=[(i=r.top)!==null&&i!==void 0?i:0,(n=r.left)!==null&&n!==void 0?n:0],l=Math.max(r.width,e.title.width),c=[0,0,l,r.height],f=this.changeBoxByEdges(c,e.padding),u=this.changeBoxByEdges(f,e.border),d;if(r.relative==="center")d=this.getCenterPos(e,u);else{let p=!o&&this.storeCursorPosition?this.storeCursorPosition:e.globalCursorPosition;r.relative==="cursor"?d=p:r.relative==="cursor-around"?d=this.getPosForAround(e,[u[2],u[3]],p):d=[a,s],this.storeCursorPosition=p}return[u[0],u[1]]=[d[0],d[1]],[f[0],f[1]]=[u[0]+e.border[0],u[1]+e.border[3]],[c[0],c[1]]=[f[0]+e.padding[0],f[1]+e.padding[3]],{contentBox:c,paddingBox:f,borderBox:u}}vimWinConfig(e,r,o){var i,n,a,s,l,c,f,u;let[d,p,m,h]=[(i=r.top)!==null&&i!==void 0?i:0,(n=r.left)!==null&&n!==void 0?n:0,r.width,r.height],g={line:0,col:0,zindex:(a=r.borderOnly)!==null&&a!==void 0&&a?1:100,minwidth:m,minheight:h,maxwidth:m,maxheight:h};if(r.relative==="center")g.pos="center";else{let T=!o&&this.storeCursorPosition?this.storeCursorPosition:e.globalCursorPosition;if(r.relative==="cursor")[g.line,g.col]=T;else if(r.relative==="cursor-around"){let I=this.changeBoxByEdgesList([d,p,m,h],[e.padding,e.border]);[g.line,g.col]=this.getPosForAround(e,[I[2],I[3]],T)}else[g.line,g.col]=[d,p];this.storeCursorPosition=T,g.line+=1,g.col+=1}let x=(s=r.topOffset)!==null&&s!==void 0?s:0,b=(l=r.leftOffset)!==null&&l!==void 0?l:0;return g.line+=x,g.col+=b,r.maxWidth&&(g.maxwidth=r.maxWidth),r.maxHeight&&(g.maxheight=r.maxHeight),g.highlight=(c=r.winHl)!==null&&c!==void 0?c:zf,r.padding&&(g.padding=r.padding),e.borderEnabled&&(g.border=e.border,g.border[0]&&(e.title.width&&(g.title=e.title.text),g.close="button"),g.borderchars=(f=r.borderChars)!==null&&f!==void 0?f:Yf,g.borderhighlight=[(u=r.borderWinHl)!==null&&u!==void 0?u:Kf]),g}nvimWinConfig(e,r,o){var i,n,a;let{contentBox:s,borderBox:l}=this.getBoxSizes(e,r,o),c=(i=r.topOffset)!==null&&i!==void 0?i:0,f=(n=r.leftOffset)!==null&&n!==void 0?n:0,u={relative:"editor",row:s[0]+c,col:s[1]+f,width:s[2],height:s[3],focusable:(a=r.focusable)!==null&&a!==void 0?a:!0},d;return l&&(d={relative:"editor",row:l[0]+c,col:l[1]+f,width:l[2],height:l[3],focusable:!1}),[u,d]}winConfig(e,r,o=!0){return _t.workspace.isVim?[this.vimWinConfig(e,r,o),void 0]:this.nvimWinConfig(e,r,o)}getRenderBorderData(e,r,o){var i,n,a,s,l,c;let f=(n=(i=e.title)===null||i===void 0?void 0:i.text)!==null&&n!==void 0?n:"",u=(s=(a=e.title)===null||a===void 0?void 0:a.width)!==null&&s!==void 0?s:0;if(!e.borderEnabled)return;let[d,p,m,h]=e.border,[g,x,b,T,I,H,qe,Re]=(l=r.borderChars)!==null&&l!==void 0?l:Yf;d||(g=""),p||(x=""),m||(b=""),h||(T=""),(!d||!h)&&(I=""),(!d||!p)&&(H=""),(!m||!h)&&(Re=""),(!m||!p)&&(qe="");let Ne=o[0],Se=o[1],mt=Ne-h-p,oo=Se-d-m,Nr=[];d&&Nr.push(I+f+g.repeat(mt-u)+H),Nr.push(...Array.from({length:oo},()=>T+" ".repeat(mt)+x)),m&&Nr.push(Re+b.repeat(mt)+qe);let Ve=[],Tr=(c=r.borderWinHl)!==null&&c!==void 0?c:Kf;if(Tr){Ve.push({hlGroup:Tr,line:0,colStart:0,colEnd:Ne});for(let At=0,pn=oo;At<pn;At++)h&&Ve.push({hlGroup:Tr,line:At+1,colStart:0,colEnd:h}),p&&Ve.push({hlGroup:Tr,line:At+1,colStart:h+mt,colEnd:Ne});m&&Ve.push({hlGroup:Tr,line:Se-1,colStart:0,colEnd:Ne})}return{lines:Nr,highlights:Ve}}renderBorderNotifier(e,r,o,i){let n=this.getRenderBorderData(r,o,"width"in i?[i.width,i.height]:[i.minwidth,i.minheight]);if(!n)return E.noop();let{lines:a,highlights:s}=n;return E.create(()=>{e.setOption("modifiable",!0,!0),e.setOption("readonly",!1,!0),e.setLines(a,{start:0,end:-1},!0),e.setOption("modifiable",!1,!0),e.setOption("readonly",!0,!0),this.addHighlightsNotify(e,s)})}nvimWinHl(e){var r,o;if(_t.workspace.isVim)return"";let i=[];return i.push(`Normal:${(r=e.winHl)!==null&&r!==void 0?r:zf}`),i.push(`NormalNC:${(o=e.winHlNC)!==null&&o!==void 0?o:qb}`),i.join(",")}addHighlightsNotify(e,r){for(let o of r)!o.hlGroup||o.line===void 0||o.colStart===void 0||o.colEnd===void 0||e.highlightRanges(this.srcId,o.hlGroup,[_t.Range.create(o.line,o.colStart,o.line,o.colEnd)])}};var Y=class{constructor(e,r,o,i,n){this.bufnr=e,this.borderBufnr=r,this.createOptions=o,this.mode=i,this.util=n,this.nvim=De.workspace.nvim,this.disposables=[],this.nvim=De.workspace.nvim,this.buffer=this.nvim.createBuffer(e),r&&(this.borderBuffer=De.workspace.nvim.createBuffer(r),this.disposables.push(De.events.on("BufWinLeave",Le.asyncCatch(async a=>{this.borderBufnr&&a===this.bufnr&&await Sr.closeWinByBufnr.call([this.borderBufnr])}))))}static getInitedExecute(e,r){var o,i,n,a;let s=(i=(o=r.initedExecute)===null||o===void 0?void 0:o.call(r,Y.initedContextVars.create))!==null&&i!==void 0?i:"";s=`${Y.modePresets[e].createInitedExecute(Y.initedContextVars.create)}
${s}`;let l=(a=(n=r.borderInitedExecute)===null||n===void 0?void 0:n.call(r,Y.initedContextVars.create))!==null&&a!==void 0?a:Y.modePresets.show.createInitedExecute(Y.initedContextVars.create);return[s,l]}static async create(e={}){var r,o,i;let n=(r=e.mode)!==null&&r!==void 0?r:"default",[a,s]=this.getInitedExecute(n,e),[l,c]=await ot.create.call((o=e.name)!==null&&o!==void 0?o:"",a,(i=e.hasBorderBuf)!==null&&i!==void 0?i:!0,s),f=new yi(this.srcId);return new Y(l,c!=null?c:void 0,e,n,f)}getInitedExecute(e){var r,o,i,n;let a=(o=(r=e.initedExecute)===null||r===void 0?void 0:r.call(e,Y.initedContextVars.open))!==null&&o!==void 0?o:"";a=`${Y.modePresets[this.mode].openInitedExecute(Y.initedContextVars.open)}
${a}`;let s=(n=(i=e.borderInitedExecute)===null||i===void 0?void 0:i.call(e,Y.initedContextVars.open))!==null&&n!==void 0?n:Y.modePresets.show.openInitedExecute(Y.initedContextVars.open);return[a,s]}getFocus(e){var r,o;return(o=(r=e.focus)!==null&&r!==void 0?r:this.mode?Y.modePresets[this.mode].focus:void 0)!==null&&o!==void 0?o:!1}getModifiable(e){var r,o;return(o=(r=e.modifiable)!==null&&r!==void 0?r:this.mode?Y.modePresets[this.mode].modifiable:void 0)!==null&&o!==void 0?o:!1}setLinesNotifier(e){return E.create(()=>{if(!e.lines&&!e.modifiable)return;let r=this.getModifiable(e);if(this.buffer.setOption("modifiable",!0,!0),this.buffer.setOption("readonly",!1,!0),e.lines&&this.buffer.setLines(e.lines,{start:0,end:-1},!0),r||(this.buffer.setOption("modifiable",!1,!0),this.buffer.setOption("readonly",!0,!0)),e.highlights)for(let o of e.highlights)this.util.addHighlightsNotify(this.buffer,[o]);De.workspace.isVim&&this.nvim.command("redraw!",!0)})}async setLines(e){await this.setLinesNotifier(e).run()}async opened(){return!!await this.win()}async openNotifier(e){var r;if(e.width<=0||e.height<=0)return E.noop();let o=[];o.push(this.closeNotifier());let i=await this.util.createContext(e),[n,a]=this.getInitedExecute(e),[s,l]=this.util.winConfig(i,e);return e.borderOnly&&l?(o.push(ot.open.callNotifier(this.bufnr,l,a,null,null,"",!1,this.util.nvimWinHl(e))),o.push(this.util.renderBorderNotifier(this.buffer,i,e,l))):o.push(ot.open.callNotifier(this.bufnr,s,n,(r=this.borderBufnr)!==null&&r!==void 0?r:null,l!=null?l:null,a,this.getFocus(e),this.util.nvimWinHl(e))),De.workspace.isNvim&&this.borderBuffer&&l&&o.push(this.util.renderBorderNotifier(this.borderBuffer,i,e,l)),o.push(this.setLinesNotifier(e),E.create(()=>{e.filetype&&this.buffer.setOption("filetype",e.filetype,!0)})),E.combine(o)}async open(e){await(await this.openNotifier(e)).run()}async resumeNotifier(e){let r=await this.util.createContext(e),[o,i]=this.util.winConfig(r,e);return E.create(()=>{var n;ot.resume.callNotify(this.bufnr,o,(n=this.borderBufnr)!==null&&n!==void 0?n:null,i!=null?i:null,this.getFocus(e),this.util.nvimWinHl(e)),this.borderBuffer&&i&&this.util.renderBorderNotifier(this.borderBuffer,r,e,i).notify(),De.workspace.isVim&&this.nvim.command("redraw!",!0)})}async resume(e){await(await this.resumeNotifier(e)).run()}async resizeNotifier(e){var r;let o=await this.util.createContext(e),[i,n]=this.util.winConfig(o,e,!1),a=[];return e.borderOnly&&n?(a.push(ot.update.callNotifier(this.bufnr,n,null,null,this.util.nvimWinHl(e))),a.push(this.util.renderBorderNotifier(this.buffer,o,e,n))):a.push(ot.update.callNotifier(this.bufnr,i,(r=this.borderBufnr)!==null&&r!==void 0?r:null,n!=null?n:null,this.util.nvimWinHl(e))),De.workspace.isNvim&&this.borderBuffer&&n&&a.push(this.util.renderBorderNotifier(this.borderBuffer,o,e,n)),a.push(E.create(()=>{De.workspace.isVim&&this.nvim.command("redraw!",!0)})),E.combine(a)}async resize(e){await(await this.resizeNotifier(e)).run()}async win(){let e=await ot.winid.call(this.bufnr);return e?this.nvim.createWindow(e):void 0}async borderWin(){let e=await ot.winid.call(this.bufnr);return e?this.nvim.createWindow(e):void 0}closeNotifier(){return ot.close.callNotifier(this.bufnr)}async close(){await this.closeNotifier().run()}dispose(){(0,De.disposeAll)(this.disposables),this.disposables.forEach(e=>e.dispose())}};Y.modePresets={default:{modifiable:!1,focus:!1,createInitedExecute:()=>"",openInitedExecute:()=>""},base:{createInitedExecute:t=>`
        call setbufvar(${t.bufnr}, '&buftype', 'nofile')
        call setbufvar(${t.bufnr}, '&bufhidden', 'hide')
        call setbufvar(${t.bufnr}, '&buflisted', 0)

        call setbufvar(${t.bufnr}, '&wrap', 1)

        call setbufvar(${t.bufnr}, '&swapfile', 0)

        call setbufvar(${t.bufnr}, '&modeline', 0)
      `,openInitedExecute:t=>`
        call setbufvar(${t.bufnr}, '&list', 0)

        call setbufvar(${t.bufnr}, '&listchars', '')
        if has('nvim')
          call setbufvar(${t.bufnr}, '&fillchars', 'eob: ')
        endif

        call setbufvar(${t.bufnr}, '&signcolumn', 'no')
        call setbufvar(${t.bufnr}, '&number', 0)
        call setbufvar(${t.bufnr}, '&relativenumber', 0)
        call setbufvar(${t.bufnr}, '&foldenable', 0)
        call setbufvar(${t.bufnr}, '&foldcolumn', 0)

        call setbufvar(${t.bufnr}, '&spell', 0)

        call setbufvar(${t.bufnr}, '&cursorcolumn', 0)
        call setbufvar(${t.bufnr}, '&cursorline', 0)
        call setbufvar(${t.bufnr}, '&colorcolumn', '')
      `},show:{modifiable:!1,createInitedExecute:t=>`
        ${Y.modePresets.base.createInitedExecute(t)}
        " call setbufvar(${t.bufnr}, '&undofile', 0)
        " call setbufvar(${t.bufnr}, '&undolevels', -1)

        call setbufvar(${t.bufnr}, '&modifiable', 0)
        call setbufvar(${t.bufnr}, '&modified', 0)
        call setbufvar(${t.bufnr}, '&readonly', 1)
      `,openInitedExecute:t=>`
        ${Y.modePresets.base.openInitedExecute(t)}
      `}};Y.initedContextVars={create:{bufnr:"a:ctx.bufnr"},open:{bufnr:"a:ctx.bufnr",winid:"a:ctx.winid"}};Y.srcId="coc-helper-floatwin";var hn=require("coc.nvim");var Xf=require("coc.nvim"),vi=class{constructor(e){this.root=e}static convertVimLayoutNode(e,r){if(e[0]==="leaf")return{type:e[0],winid:e[1],parent:r};{let o={type:e[0],children:[]};return o.children=e[1].map((i,n)=>this.convertVimLayoutNode(i,{group:o,indexInParent:n})),o}}static async create(){let e=await Xf.workspace.nvim.call("winlayout",[]);return new this(this.convertVimLayoutNode(e))}static getFirstLeafWinid(e){return e.type==="leaf"?e.winid:this.getFirstLeafWinid(e.children[0])}findWinid(e,r=this.root){if(r.type==="leaf"){if(r.winid===e)return r}else for(let o of r.children){let i=this.findWinid(e,o);if(i)return i}}findClosest(e,r){let o=new Set([e]),i=[e];for(;i.length;){let n=i.shift();if(n.type==="leaf"){if(r.includes(n.winid))return n}else for(let a of n.children)if(!o.has(a)){i.push(a),o.add(a);continue}n.parent&&!o.has(n.parent.group)&&(i.push(n.parent.group),o.add(n.parent.group))}}};async function Qf(t,e={}){var r,o,i;(!((o=(r=e.vimModule)!==null&&r!==void 0?r:e.events)!==null&&o!==void 0)||o)&&await fe.init(t),(!((i=e.events)!==null&&i!==void 0)||i)&&await Hs.register(t);try{await so.workspace.nvim.command("hi default link CocHelperNormalFloatNC CocHelperNormalFloat")}catch(n){so.window.showMessage(n.toString(),"error")}}var Er=require("coc.nvim");var Mt;(e=>{function t(r){return Object.entries(r).map(([o,i])=>{let n=async()=>o.split(/:/);return typeof i=="string"?{description:i,args:o,actionArgs:n}:Object.assign({args:o,actionArgs:n},i)})}e.getNormalizeMenus=t})(Mt||(Mt={}));var ac=require("coc.nvim");function Jf(t){return Buffer.byteLength(t)}function Zf(t,e,r=2){let o=[],i=t,n=t.indexOf(e);for(;n!==-1&&r>1;)o.push(i.slice(0,n)),i=i.slice(n+1),n=i.indexOf(e),r-=1;return o.push(i),o}function eu(t){return/^[\x00-\xFF]*$/.test(t)}var Vb={0:"\u2080",1:"\u2081",2:"\u2082",3:"\u2083",4:"\u2084",5:"\u2085",6:"\u2086",7:"\u2087",8:"\u2088",9:"\u2089"};function tu(t){return t.toString().split("").map(e=>{var r;return(r=Vb[e])!=null?r:e}).join("")}var Yb=typeof global=="object"&&global&&global.Object===Object&&global,gn=Yb;var zb=typeof self=="object"&&self&&self.Object===Object&&self,Kb=gn||zb||Function("return this")(),ae=Kb;var Xb=ae.Symbol,we=Xb;var ru=Object.prototype,Qb=ru.hasOwnProperty,Jb=ru.toString,Ei=we?we.toStringTag:void 0;function Zb(t){var e=Qb.call(t,Ei),r=t[Ei];try{t[Ei]=void 0;var o=!0}catch{}var i=Jb.call(t);return o&&(e?t[Ei]=r:delete t[Ei]),i}var ou=Zb;var ey=Object.prototype,ty=ey.toString;function ry(t){return ty.call(t)}var iu=ry;var oy="[object Null]",iy="[object Undefined]",nu=we?we.toStringTag:void 0;function ny(t){return t==null?t===void 0?iy:oy:nu&&nu in Object(t)?ou(t):iu(t)}var Ye=ny;function ay(t){return t!=null&&typeof t=="object"}var Ce=ay;var sy="[object Symbol]";function ly(t){return typeof t=="symbol"||Ce(t)&&Ye(t)==sy}var it=ly;function cy(t,e){for(var r=-1,o=t==null?0:t.length,i=Array(o);++r<o;)i[r]=e(t[r],r,t);return i}var au=cy;var fy=Array.isArray,te=fy;var uy=1/0,su=we?we.prototype:void 0,lu=su?su.toString:void 0;function cu(t){if(typeof t=="string")return t;if(te(t))return au(t,cu)+"";if(it(t))return lu?lu.call(t):"";var e=t+"";return e=="0"&&1/t==-uy?"-0":e}var fu=cu;var dy=/\s/;function py(t){for(var e=t.length;e--&&dy.test(t.charAt(e)););return e}var uu=py;var my=/^\s+/;function hy(t){return t&&t.slice(0,uu(t)+1).replace(my,"")}var du=hy;function gy(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ie=gy;var pu=0/0,wy=/^[-+]0x[0-9a-f]+$/i,xy=/^0b[01]+$/i,by=/^0o[0-7]+$/i,yy=parseInt;function vy(t){if(typeof t=="number")return t;if(it(t))return pu;if(Ie(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ie(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=du(t);var r=xy.test(t);return r||by.test(t)?yy(t.slice(2),r?2:8):wy.test(t)?pu:+t}var mu=vy;var hu=1/0,Ey=17976931348623157e292;function Ny(t){if(!t)return t===0?t:0;if(t=mu(t),t===hu||t===-hu){var e=t<0?-1:1;return e*Ey}return t===t?t:0}var gu=Ny;function Ty(t){var e=gu(t),r=e%1;return e===e?r?e-r:e:0}var wn=Ty;function Sy(t){return t}var kt=Sy;var Cy="[object AsyncFunction]",Iy="[object Function]",Oy="[object GeneratorFunction]",Py="[object Proxy]";function Ay(t){if(!Ie(t))return!1;var e=Ye(t);return e==Iy||e==Oy||e==Cy||e==Py}var xn=Ay;var _y=ae["__core-js_shared__"],bn=_y;var wu=function(){var t=/[^.]+$/.exec(bn&&bn.keys&&bn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function My(t){return!!wu&&wu in t}var xu=My;var ky=Function.prototype,Ry=ky.toString;function Ly(t){if(t!=null){try{return Ry.call(t)}catch{}try{return t+""}catch{}}return""}var gt=Ly;var Dy=/[\\^$.*+?()[\]{}|]/g,By=/^\[object .+?Constructor\]$/,Wy=Function.prototype,Fy=Object.prototype,jy=Wy.toString,Hy=Fy.hasOwnProperty,$y=RegExp("^"+jy.call(Hy).replace(Dy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Gy(t){if(!Ie(t)||xu(t))return!1;var e=xn(t)?$y:By;return e.test(gt(t))}var bu=Gy;function Uy(t,e){return t==null?void 0:t[e]}var yu=Uy;function qy(t,e){var r=yu(t,e);return bu(r)?r:void 0}var _e=qy;var Vy=_e(ae,"WeakMap"),yn=Vy;var vu=Object.create,Yy=function(){function t(){}return function(e){if(!Ie(e))return{};if(vu)return vu(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Eu=Yy;function zy(){}var Nu=zy;function Ky(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}var Tu=Ky;var Xy=function(){try{var t=_e(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Gs=Xy;function Qy(t,e){for(var r=-1,o=t==null?0:t.length;++r<o&&e(t[r],r,t)!==!1;);return t}var Su=Qy;function Jy(t,e,r,o){for(var i=t.length,n=r+(o?1:-1);o?n--:++n<i;)if(e(t[n],n,t))return n;return-1}var lo=Jy;function Zy(t){return t!==t}var Cu=Zy;function ev(t,e,r){for(var o=r-1,i=t.length;++o<i;)if(t[o]===e)return o;return-1}var Iu=ev;function tv(t,e,r){return e===e?Iu(t,e,r):lo(t,Cu,r)}var Ou=tv;function rv(t,e){var r=t==null?0:t.length;return!!r&&Ou(t,e,0)>-1}var Pu=rv;var ov=9007199254740991,iv=/^(?:0|[1-9]\d*)$/;function nv(t,e){var r=typeof t;return e=e==null?ov:e,!!e&&(r=="number"||r!="symbol"&&iv.test(t))&&t>-1&&t%1==0&&t<e}var vn=nv;function av(t,e,r){e=="__proto__"&&Gs?Gs(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Rt=av;function sv(t,e){return t===e||t!==t&&e!==e}var co=sv;var lv=Object.prototype,cv=lv.hasOwnProperty;function fv(t,e,r){var o=t[e];(!(cv.call(t,e)&&co(o,r))||r===void 0&&!(e in t))&&Rt(t,e,r)}var En=fv;function uv(t,e,r,o){var i=!r;r||(r={});for(var n=-1,a=e.length;++n<a;){var s=e[n],l=o?o(r[s],t[s],s,r,t):void 0;l===void 0&&(l=t[s]),i?Rt(r,s,l):En(r,s,l)}return r}var Lt=uv;var dv=9007199254740991;function pv(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=dv}var fo=pv;function mv(t){return t!=null&&fo(t.length)&&!xn(t)}var uo=mv;var hv=Object.prototype;function gv(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||hv;return t===r}var po=gv;function wv(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var Au=wv;var xv="[object Arguments]";function bv(t){return Ce(t)&&Ye(t)==xv}var Us=bv;var _u=Object.prototype,yv=_u.hasOwnProperty,vv=_u.propertyIsEnumerable,Ev=Us(function(){return arguments}())?Us:function(t){return Ce(t)&&yv.call(t,"callee")&&!vv.call(t,"callee")},mo=Ev;function Nv(){return!1}var Mu=Nv;var Lu=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ku=Lu&&typeof module=="object"&&module&&!module.nodeType&&module,Tv=ku&&ku.exports===Lu,Ru=Tv?ae.Buffer:void 0,Sv=Ru?Ru.isBuffer:void 0,Cv=Sv||Mu,Cr=Cv;var Iv="[object Arguments]",Ov="[object Array]",Pv="[object Boolean]",Av="[object Date]",_v="[object Error]",Mv="[object Function]",kv="[object Map]",Rv="[object Number]",Lv="[object Object]",Dv="[object RegExp]",Bv="[object Set]",Wv="[object String]",Fv="[object WeakMap]",jv="[object ArrayBuffer]",Hv="[object DataView]",$v="[object Float32Array]",Gv="[object Float64Array]",Uv="[object Int8Array]",qv="[object Int16Array]",Vv="[object Int32Array]",Yv="[object Uint8Array]",zv="[object Uint8ClampedArray]",Kv="[object Uint16Array]",Xv="[object Uint32Array]",Z={};Z[$v]=Z[Gv]=Z[Uv]=Z[qv]=Z[Vv]=Z[Yv]=Z[zv]=Z[Kv]=Z[Xv]=!0;Z[Iv]=Z[Ov]=Z[jv]=Z[Pv]=Z[Hv]=Z[Av]=Z[_v]=Z[Mv]=Z[kv]=Z[Rv]=Z[Lv]=Z[Dv]=Z[Bv]=Z[Wv]=Z[Fv]=!1;function Qv(t){return Ce(t)&&fo(t.length)&&!!Z[Ye(t)]}var Du=Qv;function Jv(t){return function(e){return t(e)}}var ho=Jv;var Bu=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ni=Bu&&typeof module=="object"&&module&&!module.nodeType&&module,Zv=Ni&&Ni.exports===Bu,qs=Zv&&gn.process,e0=function(){try{var t=Ni&&Ni.require&&Ni.require("util").types;return t||qs&&qs.binding&&qs.binding("util")}catch{}}(),wt=e0;var Wu=wt&&wt.isTypedArray,t0=Wu?ho(Wu):Du,Nn=t0;var r0=Object.prototype,o0=r0.hasOwnProperty;function i0(t,e){var r=te(t),o=!r&&mo(t),i=!r&&!o&&Cr(t),n=!r&&!o&&!i&&Nn(t),a=r||o||i||n,s=a?Au(t.length,String):[],l=s.length;for(var c in t)(e||o0.call(t,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||vn(c,l)))&&s.push(c);return s}var Tn=i0;function n0(t,e){return function(r){return t(e(r))}}var Sn=n0;var a0=Sn(Object.keys,Object),Fu=a0;var s0=Object.prototype,l0=s0.hasOwnProperty;function c0(t){if(!po(t))return Fu(t);var e=[];for(var r in Object(t))l0.call(t,r)&&r!="constructor"&&e.push(r);return e}var ju=c0;function f0(t){return uo(t)?Tn(t):ju(t)}var nt=f0;function u0(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Hu=u0;var d0=Object.prototype,p0=d0.hasOwnProperty;function m0(t){if(!Ie(t))return Hu(t);var e=po(t),r=[];for(var o in t)o=="constructor"&&(e||!p0.call(t,o))||r.push(o);return r}var $u=m0;function h0(t){return uo(t)?Tn(t,!0):$u(t)}var go=h0;var g0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w0=/^\w*$/;function x0(t,e){if(te(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||it(t)?!0:w0.test(t)||!g0.test(t)||e!=null&&t in Object(e)}var wo=x0;var b0=_e(Object,"create"),xt=b0;function y0(){this.__data__=xt?xt(null):{},this.size=0}var Gu=y0;function v0(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Uu=v0;var E0="__lodash_hash_undefined__",N0=Object.prototype,T0=N0.hasOwnProperty;function S0(t){var e=this.__data__;if(xt){var r=e[t];return r===E0?void 0:r}return T0.call(e,t)?e[t]:void 0}var qu=S0;var C0=Object.prototype,I0=C0.hasOwnProperty;function O0(t){var e=this.__data__;return xt?e[t]!==void 0:I0.call(e,t)}var Vu=O0;var P0="__lodash_hash_undefined__";function A0(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=xt&&e===void 0?P0:e,this}var Yu=A0;function xo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}xo.prototype.clear=Gu;xo.prototype.delete=Uu;xo.prototype.get=qu;xo.prototype.has=Vu;xo.prototype.set=Yu;var Vs=xo;function _0(){this.__data__=[],this.size=0}var zu=_0;function M0(t,e){for(var r=t.length;r--;)if(co(t[r][0],e))return r;return-1}var Dt=M0;var k0=Array.prototype,R0=k0.splice;function L0(t){var e=this.__data__,r=Dt(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():R0.call(e,r,1),--this.size,!0}var Ku=L0;function D0(t){var e=this.__data__,r=Dt(e,t);return r<0?void 0:e[r][1]}var Xu=D0;function B0(t){return Dt(this.__data__,t)>-1}var Qu=B0;function W0(t,e){var r=this.__data__,o=Dt(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}var Ju=W0;function bo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}bo.prototype.clear=zu;bo.prototype.delete=Ku;bo.prototype.get=Xu;bo.prototype.has=Qu;bo.prototype.set=Ju;var Bt=bo;var F0=_e(ae,"Map"),Wt=F0;function j0(){this.size=0,this.__data__={hash:new Vs,map:new(Wt||Bt),string:new Vs}}var Zu=j0;function H0(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var ed=H0;function $0(t,e){var r=t.__data__;return ed(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Ft=$0;function G0(t){var e=Ft(this,t).delete(t);return this.size-=e?1:0,e}var td=G0;function U0(t){return Ft(this,t).get(t)}var rd=U0;function q0(t){return Ft(this,t).has(t)}var od=q0;function V0(t,e){var r=Ft(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}var id=V0;function yo(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}yo.prototype.clear=Zu;yo.prototype.delete=td;yo.prototype.get=rd;yo.prototype.has=od;yo.prototype.set=id;var Ir=yo;var Y0="Expected a function";function Ys(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Y0);var r=function(){var o=arguments,i=e?e.apply(this,o):o[0],n=r.cache;if(n.has(i))return n.get(i);var a=t.apply(this,o);return r.cache=n.set(i,a)||n,a};return r.cache=new(Ys.Cache||Ir),r}Ys.Cache=Ir;var nd=Ys;var z0=500;function K0(t){var e=nd(t,function(o){return r.size===z0&&r.clear(),o}),r=e.cache;return e}var ad=K0;var X0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q0=/\\(\\)?/g,J0=ad(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(X0,function(r,o,i,n){e.push(i?n.replace(Q0,"$1"):o||r)}),e}),sd=J0;function Z0(t){return t==null?"":fu(t)}var ld=Z0;function eE(t,e){return te(t)?t:wo(t,e)?[t]:sd(ld(t))}var Cn=eE;var tE=1/0;function rE(t){if(typeof t=="string"||it(t))return t;var e=t+"";return e=="0"&&1/t==-tE?"-0":e}var jt=rE;function oE(t,e){e=Cn(e,t);for(var r=0,o=e.length;t!=null&&r<o;)t=t[jt(e[r++])];return r&&r==o?t:void 0}var In=oE;function iE(t,e,r){var o=t==null?void 0:In(t,e);return o===void 0?r:o}var cd=iE;function nE(t,e){for(var r=-1,o=e.length,i=t.length;++r<o;)t[i+r]=e[r];return t}var vo=nE;var fd=we?we.isConcatSpreadable:void 0;function aE(t){return te(t)||mo(t)||!!(fd&&t&&t[fd])}var ud=aE;function dd(t,e,r,o,i){var n=-1,a=t.length;for(r||(r=ud),i||(i=[]);++n<a;){var s=t[n];e>0&&r(s)?e>1?dd(s,e-1,r,o,i):vo(i,s):o||(i[i.length]=s)}return i}var pd=dd;function sE(t){var e=t==null?0:t.length;return e?pd(t,1):[]}var ye=sE;var lE=Sn(Object.getPrototypeOf,Object),On=lE;function cE(){this.__data__=new Bt,this.size=0}var md=cE;function fE(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var hd=fE;function uE(t){return this.__data__.get(t)}var gd=uE;function dE(t){return this.__data__.has(t)}var wd=dE;var pE=200;function mE(t,e){var r=this.__data__;if(r instanceof Bt){var o=r.__data__;if(!Wt||o.length<pE-1)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ir(o)}return r.set(t,e),this.size=r.size,this}var xd=mE;function Eo(t){var e=this.__data__=new Bt(t);this.size=e.size}Eo.prototype.clear=md;Eo.prototype.delete=hd;Eo.prototype.get=gd;Eo.prototype.has=wd;Eo.prototype.set=xd;var Ht=Eo;function hE(t,e){return t&&Lt(e,nt(e),t)}var bd=hE;function gE(t,e){return t&&Lt(e,go(e),t)}var yd=gE;var Td=typeof exports=="object"&&exports&&!exports.nodeType&&exports,vd=Td&&typeof module=="object"&&module&&!module.nodeType&&module,wE=vd&&vd.exports===Td,Ed=wE?ae.Buffer:void 0,Nd=Ed?Ed.allocUnsafe:void 0;function xE(t,e){if(e)return t.slice();var r=t.length,o=Nd?Nd(r):new t.constructor(r);return t.copy(o),o}var Sd=xE;function bE(t,e){for(var r=-1,o=t==null?0:t.length,i=0,n=[];++r<o;){var a=t[r];e(a,r,t)&&(n[i++]=a)}return n}var Cd=bE;function yE(){return[]}var Pn=yE;var vE=Object.prototype,EE=vE.propertyIsEnumerable,Id=Object.getOwnPropertySymbols,NE=Id?function(t){return t==null?[]:(t=Object(t),Cd(Id(t),function(e){return EE.call(t,e)}))}:Pn,No=NE;function TE(t,e){return Lt(t,No(t),e)}var Od=TE;var SE=Object.getOwnPropertySymbols,CE=SE?function(t){for(var e=[];t;)vo(e,No(t)),t=On(t);return e}:Pn,An=CE;function IE(t,e){return Lt(t,An(t),e)}var Pd=IE;function OE(t,e,r){var o=e(t);return te(t)?o:vo(o,r(t))}var _n=OE;function PE(t){return _n(t,nt,No)}var Ti=PE;function AE(t){return _n(t,go,An)}var Ad=AE;var _E=_e(ae,"DataView"),Mn=_E;var ME=_e(ae,"Promise"),kn=ME;var kE=_e(ae,"Set"),$t=kE;var _d="[object Map]",RE="[object Object]",Md="[object Promise]",kd="[object Set]",Rd="[object WeakMap]",Ld="[object DataView]",LE=gt(Mn),DE=gt(Wt),BE=gt(kn),WE=gt($t),FE=gt(yn),Or=Ye;(Mn&&Or(new Mn(new ArrayBuffer(1)))!=Ld||Wt&&Or(new Wt)!=_d||kn&&Or(kn.resolve())!=Md||$t&&Or(new $t)!=kd||yn&&Or(new yn)!=Rd)&&(Or=function(t){var e=Ye(t),r=e==RE?t.constructor:void 0,o=r?gt(r):"";if(o)switch(o){case LE:return Ld;case DE:return _d;case BE:return Md;case WE:return kd;case FE:return Rd}return e});var bt=Or;var jE=Object.prototype,HE=jE.hasOwnProperty;function $E(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&HE.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Dd=$E;var GE=ae.Uint8Array,To=GE;function UE(t){var e=new t.constructor(t.byteLength);return new To(e).set(new To(t)),e}var So=UE;function qE(t,e){var r=e?So(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Bd=qE;var VE=/\w*$/;function YE(t){var e=new t.constructor(t.source,VE.exec(t));return e.lastIndex=t.lastIndex,e}var Wd=YE;var Fd=we?we.prototype:void 0,jd=Fd?Fd.valueOf:void 0;function zE(t){return jd?Object(jd.call(t)):{}}var Hd=zE;function KE(t,e){var r=e?So(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var $d=KE;var XE="[object Boolean]",QE="[object Date]",JE="[object Map]",ZE="[object Number]",eN="[object RegExp]",tN="[object Set]",rN="[object String]",oN="[object Symbol]",iN="[object ArrayBuffer]",nN="[object DataView]",aN="[object Float32Array]",sN="[object Float64Array]",lN="[object Int8Array]",cN="[object Int16Array]",fN="[object Int32Array]",uN="[object Uint8Array]",dN="[object Uint8ClampedArray]",pN="[object Uint16Array]",mN="[object Uint32Array]";function hN(t,e,r){var o=t.constructor;switch(e){case iN:return So(t);case XE:case QE:return new o(+t);case nN:return Bd(t,r);case aN:case sN:case lN:case cN:case fN:case uN:case dN:case pN:case mN:return $d(t,r);case JE:return new o;case ZE:case rN:return new o(t);case eN:return Wd(t);case tN:return new o;case oN:return Hd(t)}}var Gd=hN;function gN(t){return typeof t.constructor=="function"&&!po(t)?Eu(On(t)):{}}var Ud=gN;var wN="[object Map]";function xN(t){return Ce(t)&&bt(t)==wN}var qd=xN;var Vd=wt&&wt.isMap,bN=Vd?ho(Vd):qd,Yd=bN;var yN="[object Set]";function vN(t){return Ce(t)&&bt(t)==yN}var zd=vN;var Kd=wt&&wt.isSet,EN=Kd?ho(Kd):zd,Xd=EN;var NN=1,TN=2,SN=4,Qd="[object Arguments]",CN="[object Array]",IN="[object Boolean]",ON="[object Date]",PN="[object Error]",Jd="[object Function]",AN="[object GeneratorFunction]",_N="[object Map]",MN="[object Number]",Zd="[object Object]",kN="[object RegExp]",RN="[object Set]",LN="[object String]",DN="[object Symbol]",BN="[object WeakMap]",WN="[object ArrayBuffer]",FN="[object DataView]",jN="[object Float32Array]",HN="[object Float64Array]",$N="[object Int8Array]",GN="[object Int16Array]",UN="[object Int32Array]",qN="[object Uint8Array]",VN="[object Uint8ClampedArray]",YN="[object Uint16Array]",zN="[object Uint32Array]",Q={};Q[Qd]=Q[CN]=Q[WN]=Q[FN]=Q[IN]=Q[ON]=Q[jN]=Q[HN]=Q[$N]=Q[GN]=Q[UN]=Q[_N]=Q[MN]=Q[Zd]=Q[kN]=Q[RN]=Q[LN]=Q[DN]=Q[qN]=Q[VN]=Q[YN]=Q[zN]=!0;Q[PN]=Q[Jd]=Q[BN]=!1;function Rn(t,e,r,o,i,n){var a,s=e&NN,l=e&TN,c=e&SN;if(r&&(a=i?r(t,o,i,n):r(t)),a!==void 0)return a;if(!Ie(t))return t;var f=te(t);if(f){if(a=Dd(t),!s)return Tu(t,a)}else{var u=bt(t),d=u==Jd||u==AN;if(Cr(t))return Sd(t,s);if(u==Zd||u==Qd||d&&!i){if(a=l||d?{}:Ud(t),!s)return l?Pd(t,yd(a,t)):Od(t,bd(a,t))}else{if(!Q[u])return i?t:{};a=Gd(t,u,s)}}n||(n=new Ht);var p=n.get(t);if(p)return p;n.set(t,a),Xd(t)?t.forEach(function(g){a.add(Rn(g,e,r,g,t,n))}):Yd(t)&&t.forEach(function(g,x){a.set(x,Rn(g,e,r,x,t,n))});var m=c?l?Ad:Ti:l?go:nt,h=f?void 0:m(t);return Su(h||t,function(g,x){h&&(x=g,g=t[x]),En(a,x,Rn(g,e,r,x,t,n))}),a}var ep=Rn;var KN=4;function XN(t){return ep(t,KN)}var zs=XN;var QN="__lodash_hash_undefined__";function JN(t){return this.__data__.set(t,QN),this}var tp=JN;function ZN(t){return this.__data__.has(t)}var rp=ZN;function Ln(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Ir;++e<r;)this.add(t[e])}Ln.prototype.add=Ln.prototype.push=tp;Ln.prototype.has=rp;var Dn=Ln;function eT(t,e){for(var r=-1,o=t==null?0:t.length;++r<o;)if(e(t[r],r,t))return!0;return!1}var op=eT;function tT(t,e){return t.has(e)}var Bn=tT;var rT=1,oT=2;function iT(t,e,r,o,i,n){var a=r&rT,s=t.length,l=e.length;if(s!=l&&!(a&&l>s))return!1;var c=n.get(t),f=n.get(e);if(c&&f)return c==e&&f==t;var u=-1,d=!0,p=r&oT?new Dn:void 0;for(n.set(t,e),n.set(e,t);++u<s;){var m=t[u],h=e[u];if(o)var g=a?o(h,m,u,e,t,n):o(m,h,u,t,e,n);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!op(e,function(x,b){if(!Bn(p,b)&&(m===x||i(m,x,r,o,n)))return p.push(b)})){d=!1;break}}else if(!(m===h||i(m,h,r,o,n))){d=!1;break}}return n.delete(t),n.delete(e),d}var Wn=iT;function nT(t){var e=-1,r=Array(t.size);return t.forEach(function(o,i){r[++e]=[i,o]}),r}var ip=nT;function aT(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var Co=aT;var sT=1,lT=2,cT="[object Boolean]",fT="[object Date]",uT="[object Error]",dT="[object Map]",pT="[object Number]",mT="[object RegExp]",hT="[object Set]",gT="[object String]",wT="[object Symbol]",xT="[object ArrayBuffer]",bT="[object DataView]",np=we?we.prototype:void 0,Ks=np?np.valueOf:void 0;function yT(t,e,r,o,i,n,a){switch(r){case bT:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case xT:return!(t.byteLength!=e.byteLength||!n(new To(t),new To(e)));case cT:case fT:case pT:return co(+t,+e);case uT:return t.name==e.name&&t.message==e.message;case mT:case gT:return t==e+"";case dT:var s=ip;case hT:var l=o&sT;if(s||(s=Co),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;o|=lT,a.set(t,e);var f=Wn(s(t),s(e),o,i,n,a);return a.delete(t),f;case wT:if(Ks)return Ks.call(t)==Ks.call(e)}return!1}var ap=yT;var vT=1,ET=Object.prototype,NT=ET.hasOwnProperty;function TT(t,e,r,o,i,n){var a=r&vT,s=Ti(t),l=s.length,c=Ti(e),f=c.length;if(l!=f&&!a)return!1;for(var u=l;u--;){var d=s[u];if(!(a?d in e:NT.call(e,d)))return!1}var p=n.get(t),m=n.get(e);if(p&&m)return p==e&&m==t;var h=!0;n.set(t,e),n.set(e,t);for(var g=a;++u<l;){d=s[u];var x=t[d],b=e[d];if(o)var T=a?o(b,x,d,e,t,n):o(x,b,d,t,e,n);if(!(T===void 0?x===b||i(x,b,r,o,n):T)){h=!1;break}g||(g=d=="constructor")}if(h&&!g){var I=t.constructor,H=e.constructor;I!=H&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof H=="function"&&H instanceof H)&&(h=!1)}return n.delete(t),n.delete(e),h}var sp=TT;var ST=1,lp="[object Arguments]",cp="[object Array]",Fn="[object Object]",CT=Object.prototype,fp=CT.hasOwnProperty;function IT(t,e,r,o,i,n){var a=te(t),s=te(e),l=a?cp:bt(t),c=s?cp:bt(e);l=l==lp?Fn:l,c=c==lp?Fn:c;var f=l==Fn,u=c==Fn,d=l==c;if(d&&Cr(t)){if(!Cr(e))return!1;a=!0,f=!1}if(d&&!f)return n||(n=new Ht),a||Nn(t)?Wn(t,e,r,o,i,n):ap(t,e,l,r,o,i,n);if(!(r&ST)){var p=f&&fp.call(t,"__wrapped__"),m=u&&fp.call(e,"__wrapped__");if(p||m){var h=p?t.value():t,g=m?e.value():e;return n||(n=new Ht),i(h,g,r,o,n)}}return d?(n||(n=new Ht),sp(t,e,r,o,i,n)):!1}var up=IT;function dp(t,e,r,o,i){return t===e?!0:t==null||e==null||!Ce(t)&&!Ce(e)?t!==t&&e!==e:up(t,e,r,o,dp,i)}var jn=dp;var OT=1,PT=2;function AT(t,e,r,o){var i=r.length,n=i,a=!o;if(t==null)return!n;for(t=Object(t);i--;){var s=r[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<n;){s=r[i];var l=s[0],c=t[l],f=s[1];if(a&&s[2]){if(c===void 0&&!(l in t))return!1}else{var u=new Ht;if(o)var d=o(c,f,l,t,e,u);if(!(d===void 0?jn(f,c,OT|PT,o,u):d))return!1}}return!0}var pp=AT;function _T(t){return t===t&&!Ie(t)}var Hn=_T;function MT(t){for(var e=nt(t),r=e.length;r--;){var o=e[r],i=t[o];e[r]=[o,i,Hn(i)]}return e}var mp=MT;function kT(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var $n=kT;function RT(t){var e=mp(t);return e.length==1&&e[0][2]?$n(e[0][0],e[0][1]):function(r){return r===t||pp(r,t,e)}}var hp=RT;function LT(t,e){return t!=null&&e in Object(t)}var gp=LT;function DT(t,e,r){e=Cn(e,t);for(var o=-1,i=e.length,n=!1;++o<i;){var a=jt(e[o]);if(!(n=t!=null&&r(t,a)))break;t=t[a]}return n||++o!=i?n:(i=t==null?0:t.length,!!i&&fo(i)&&vn(a,i)&&(te(t)||mo(t)))}var wp=DT;function BT(t,e){return t!=null&&wp(t,e,gp)}var xp=BT;var WT=1,FT=2;function jT(t,e){return wo(t)&&Hn(e)?$n(jt(t),e):function(r){var o=cd(r,t);return o===void 0&&o===e?xp(r,t):jn(e,o,WT|FT)}}var bp=jT;function HT(t){return function(e){return e==null?void 0:e[t]}}var yp=HT;function $T(t){return function(e){return In(e,t)}}var vp=$T;function GT(t){return wo(t)?yp(jt(t)):vp(t)}var Ep=GT;function UT(t){return typeof t=="function"?t:t==null?kt:typeof t=="object"?te(t)?bp(t[0],t[1]):hp(t):Ep(t)}var Gt=UT;function qT(t,e,r,o){for(var i=-1,n=t==null?0:t.length;++i<n;){var a=t[i];e(o,a,r(a),t)}return o}var Np=qT;function VT(t){return function(e,r,o){for(var i=-1,n=Object(e),a=o(e),s=a.length;s--;){var l=a[t?s:++i];if(r(n[l],l,n)===!1)break}return e}}var Tp=VT;var YT=Tp(),Sp=YT;function zT(t,e){return t&&Sp(t,e,nt)}var Cp=zT;function KT(t,e){return function(r,o){if(r==null)return r;if(!uo(r))return t(r,o);for(var i=r.length,n=e?i:-1,a=Object(r);(e?n--:++n<i)&&o(a[n],n,a)!==!1;);return r}}var Ip=KT;var XT=Ip(Cp),Op=XT;function QT(t,e,r,o){return Op(t,function(i,n,a){e(o,i,r(i),a)}),o}var Pp=QT;function JT(t,e){return function(r,o){var i=te(r)?Np:Pp,n=e?e():{};return i(r,t,Gt(o,2),n)}}var Io=JT;function ZT(t,e,r){for(var o=-1,i=t==null?0:t.length;++o<i;)if(r(e,t[o]))return!0;return!1}var Ap=ZT;var eS=Math.max;function tS(t,e,r){var o=t==null?0:t.length;if(!o)return-1;var i=r==null?0:wn(r);return i<0&&(i=eS(o+i,0)),lo(t,Gt(e,3),i)}var Si=tS;var rS=Math.max,oS=Math.min;function iS(t,e,r){var o=t==null?0:t.length;if(!o)return-1;var i=o-1;return r!==void 0&&(i=wn(r),i=r<0?rS(o+i,0):oS(i,o-1)),lo(t,Gt(e,3),i,!0)}var Ci=iS;var nS=Object.prototype,aS=nS.hasOwnProperty,sS=Io(function(t,e,r){aS.call(t,r)?t[r].push(e):Rt(t,r,[e])}),Gn=sS;function lS(t,e){return t>e}var _p=lS;var cS=Io(function(t,e,r){Rt(t,r,e)}),Un=cS;function fS(t,e){return t<e}var qn=fS;function uS(t,e,r){for(var o=-1,i=t.length;++o<i;){var n=t[o],a=e(n);if(a!=null&&(s===void 0?a===a&&!it(a):r(a,s)))var s=a,l=n}return l}var Oo=uS;function dS(t){return t&&t.length?Oo(t,kt,_p):void 0}var Po=dS;function pS(t,e){for(var r,o=-1,i=t.length;++o<i;){var n=e(t[o]);n!==void 0&&(r=r===void 0?n:r+n)}return r}var Mp=pS;function mS(t){return t&&t.length?Oo(t,kt,qn):void 0}var Ii=mS;function hS(t,e){return t&&t.length?Oo(t,Gt(e,2),qn):void 0}var Xs=hS;var gS=Io(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]}),Ao=gS;function wS(t){return t&&t.length?Mp(t,kt):0}var se=wS;var xS=1/0,bS=$t&&1/Co(new $t([,-0]))[1]==xS?function(t){return new $t(t)}:Nu,kp=bS;var yS=200;function vS(t,e,r){var o=-1,i=Pu,n=t.length,a=!0,s=[],l=s;if(r)a=!1,i=Ap;else if(n>=yS){var c=e?null:kp(t);if(c)return Co(c);a=!1,i=Bn,l=new Dn}else l=e?[]:s;e:for(;++o<n;){var f=t[o],u=e?e(f):f;if(f=r||f!==0?f:0,a&&u===u){for(var d=l.length;d--;)if(l[d]===u)continue e;e&&l.push(u),s.push(f)}else i(l,u,r)||(l!==s&&l.push(u),s.push(f))}return s}var Rp=vS;function ES(t){return t&&t.length?Rp(t):[]}var Oi=ES;var ue=t=>t.filter(e=>e!=null);function Vn(t,e,r){let o=t.get(e);return o===void 0&&(o=r(),t.set(e,o)),o}function Yn(t,e,r,o){if(e>0){let i=Ci(t,o,e-1);if(i!==-1)return i}if(r&&e<t.length-1){let i=Ci(t.slice(e+1),o);return i===-1?void 0:i+e+1}}function zn(t,e,r,o){if(e<t.length-1){let i=Si(t,o,e+1);if(i!==-1)return i}if(r&&e>0){let i=Si(t.slice(0,e),o);return i===-1?void 0:i}}var Lp=t=>new Promise(e=>{setTimeout(e,t)});var Me=_(require("fs")),hh=_(require("os")),gh=_(Yp()),Xt=_(require("path")),wh=_(require("readline")),xh=_(Vm()),$e=require("util");var ca=require("child_process"),dh=_(uh()),fa=(t,e,r)=>{let o=(0,ca.spawn)(t,e,r),i="";return o.stdout.on("data",n=>{i+=n.toString()}),new Promise((n,a)=>{o.stdout.on("error",s=>{a(s)}),o.stdout.on("end",()=>{n(i)})})},Rl=(t,e)=>new Promise((r,o)=>{(0,ca.exec)(t,e,(i,n)=>{if(i)return o(i);r(n.toString("utf8"))})});function Ll(t){return process.platform==="win32"?`"${t.replace(/"/g,'\\"')}"`:(/[^A-Za-z0-9_/:=-]/.test(t)&&(t=`'${t.replace(/'/g,"'\\''")}'`,t=t.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t)}var Di=async t=>{try{await(0,dh.default)(t)}catch{return!1}return!0};var We=process.platform==="win32",DF=process.platform==="darwin",BF=process.platform==="linux";var ua=require("coc.nvim");var C=ua.workspace.getConfiguration("explorer"),da=(t=ha(ua.workspace.cwd))=>ua.workspace.getConfiguration("explorer",t);var pa=()=>C.get("buffer.tabOnly"),Dl=t=>{let e=t.get("file.autoReveal");return e!==void 0?v.error("`explorer.file.autoReveal` has been deprecated, please use explorer.file.reveal.auto instead of it"):e=t.get("file.reveal.auto"),e},ma=(t,e)=>{if(e!==void 0)return e;let r=t.get("file.revealWhenOpen");return r!==void 0?v.error("`explorer.file.autoReveal` has been deprecated, please use explorer.file.reveal.whenOpen instead of it"):r=t.get("file.reveal.whenOpen"),r};function ph(t){return{get config(){return t},get(e,r){return this.config.get(e,r)}}}var xI=async t=>{let{default:e}=await Promise.resolve().then(()=>_(require("trash")));await e(t,{glob:!1})},Bl=class{constructor(){this.inited=!1;this.placeholders={list:"%l",sourceFile:"%s"};this.exec_=async()=>{}}async init(){if(this.inited)return;let e=C.get("trash.command");if(e==="nodejs:module"){this.exec_=async n=>{await xI(n)};return}let r=e.match(/^([^\s]+)/),o=r==null?void 0:r[1];if(!o){this.exec_=async()=>{throw new Error("'explorer.trash.command' must not be empty")};return}let i=async n=>{if(!await Di(n))throw new Error(`command(${n}) does not exist`)};e.includes(this.placeholders.list)?this.exec_=async n=>{await i(o);let a=n.map(s=>Ll(s)).join(" ");await Rl(e.replace(new RegExp(this.placeholders.list,"g"),a))}:e.includes(this.placeholders.sourceFile)&&(this.exec_=async n=>{await i(o);for(let a of n.map(s=>Ll(s)))await Rl(e.replace(new RegExp(this.placeholders.sourceFile,"g"),a))}),this.inited=!0}async exec(e){await this.init(),await this.exec_(e)}},mh=new Bl;var bh=_(Ro()),bI=(0,$e.promisify)(Me.default.open),yI=(0,$e.promisify)(Me.default.close),yh=async t=>await yI(await bI(t,"w")),Wo=gh.default,Fo=(0,$e.promisify)(Me.default.readdir),vh=(0,$e.promisify)(Me.default.readlink),Bi=(t,e)=>new Promise(r=>{Me.default.access(t,e,o=>{r(!o)})}),ga=(0,$e.promisify)(Me.default.writeFile),Eh=(0,$e.promisify)(Me.default.readFile),wa=Bi,Dr=(0,$e.promisify)(Me.default.stat),Lr=(0,$e.promisify)(Me.default.lstat),vI=(0,$e.promisify)(Me.default.copyFile),Wl=(0,$e.promisify)(Me.default.rename),Nh=(0,$e.promisify)(xh.default),xa=async t=>{await mh.exec(typeof t=="string"?[t]:t)};async function Fl(t,e){if((await Lr(t)).isDirectory()){await Wo(e);let o=await Fo(t);for(let i of o)await Fl(Xt.default.join(t,i),Xt.default.join(e,i))}else await vI(t,e)}async function Th(t,e,r){let o=await Fo(t);for(let i of o){let n=Xt.default.join(t,i),a=Xt.default.join(e,i);if(await wa(a)){let s=await Lr(n),l=await Lr(a);s.isDirectory()&&l.isDirectory()?await Th(n,a,r):(await xa(a),await r(n,a))}else await r(n,a)}}async function Br(t,e,r){let o=async(i,n)=>{await Wo(Xt.default.dirname(n)),await r(i,n)};for(let i=0,n=e.length;i<n;i++){let a=e[i].source,s=e[i].target;if(!await wa(s)){await o(a,s);continue}let l=typeof a=="string"?await Lr(a):void 0,c=await Lr(s),f=async function(){let m=await Ke(`Rename: ${s} ->`,s,"file");if(!m){i-=1;return}return o(a,m)},u=async function(){return await xa(s),o(a,s)},d=function(){i=n},p=async function(m={}){var g;m=U(S({skip:void 0,rename:f,"force replace":u},m),{quit:d});let h=await ze(`${t[0].toUpperCase()}${t.slice(1)}: ${s} already exists.`,Object.keys(m));if(h&&h in m)return(g=m[h])==null?void 0:g.call(m)};a&&(l==null?void 0:l.isDirectory())?c.isDirectory()?await p({merge:()=>Th(a,s,o),"one by one":async()=>{let h=(await Fo(a)).map(g=>({source:g,target:Xt.default.join(s,Xt.default.basename(g))}));await Br(t,h,r)}}):await p():c.isDirectory()?await p():await p()}}function Sh(t,e,r){if(!Me.default.existsSync(t))return Promise.reject(new Error(`file does not exist: ${t}`));let o=[],i=Me.default.createReadStream(t,{encoding:"utf8"}),n=wh.default.createInterface({input:i,crlfDelay:1/0,terminal:!1}),a=0;return new Promise((s,l)=>{i.on("error",l),n.on("line",c=>{a===0&&c.startsWith("\uFEFF")&&(c=c.slice(1)),a>=e&&a<=r&&o.push(c),a===r&&n.close(),a=a+1}),n.on("close",()=>{s(o)}),n.on("error",l)})}async function jl(t,e){try{let r=await Fo(t);for(let o of e)if(o.includes("*")?bh.default.match(r,o,{nobrace:!0,noext:!0,nocomment:!0,nonegate:!0,dot:!0}).length!==0:r.includes(o))return!0}catch{}return!1}function Qt(t){let e=hh.default.homedir();return t.startsWith(e)?`~${t.slice(e.length)}`:t}async function ba(){if(We)return(await fa("wmic",["logicaldisk","get","name"])).split(`
`).map(r=>r.trim()).filter(r=>r.endsWith(":")).map(r=>`${r}\\`);throw new Error(`not support listDrive in ${process.platform}`)}var Ch=_(require("os")),Jt=_(require("path"));function ya(t){let e=Jt.default.basename(t).split("."),[r,...o]=e;if(r)return{basename:r,extensions:o};{let[i,...n]=o;return{basename:[r,i].join("."),extensions:n}}}function le(t){let e=Jt.default.normalize(t);return e[0]==="~"&&(e=Jt.default.join(Ch.default.homedir(),e.slice(1))),We&&/[a-z]:/.test(e)&&(e=e[0].toUpperCase()+e.slice(1)),e}function va(t,e){let r=le(Jt.default.resolve(t)),o=le(Jt.default.resolve(e));return r==="//"&&(r="/"),r.endsWith(Jt.default.sep)?o.startsWith(r):o.startsWith(r)&&o[r.length]===Jt.default.sep}var ee=require("coc.nvim"),Rh=_(Fi());function Gl(){return ee.workspace.floatSupported}function Lh(){return ee.workspace.isNvim&&Gl()}async function Nt(){return!!await ee.workspace.nvim.getOption("wrapscan")}async function Dh(t){let{nvim:e}=ee.workspace;(await e.getOption("runtimepath")).split(",").includes(t)||await e.command(`execute 'noa set rtp+='.fnameescape('${t.replace(/'/g,"''")}')`)}function Bh(t,e){var o;if(!e)return;let r=e.guifg;if(r){let i=(o=e.ctermfg)!=null?o:Rh.default.rgb.ansi256([r.red,r.green,r.blue]);return`highlight default ${t} ctermfg=${i} guifg=#${Hi(r)}`}else if(e.ctermfg)return`highlight default ${t} ctermfg=${e.ctermfg}`}async function Wh(t){return await ee.workspace.nvim.call("strdisplaywidth",[t])}async function Wr(t,e,r){return await ee.workspace.nvim.call("coc_explorer#util#strdisplayslice",[t,e,r!=null?r:void 0])}function Ul(t){return E.create(()=>{ee.workspace.nvim.call("coc_explorer#util#close_win_by_bufnr",t,!0)})}async function ji(t){if(!!t)return ee.workspace.nvim.call("bufwinnr",t).then(e=>{if(e>0)return e})}async function ql(t){if(!t)return;let e=await ee.workspace.nvim.call("win_getid",t);if(e>=0)return e}async function Vl(t){if(t)return ee.workspace.nvim.createWindow(t)}async function Na(t){if(!t)return;let e=await ee.workspace.nvim.call("winbufnr",t);if(e>=0)return e}async function Yl(t){return await ee.workspace.nvim.call("win_findbuf",[t])}async function Fh(t){let o=(await(await ee.workspace.nvim.tabpage).windows).map(n=>n.id);return(await ee.workspace.nvim.call("win_findbuf",[t])).filter(n=>o.includes(n))}async function Ta(t){let e=await ee.workspace.nvim.call("win_getid",[]);if(!!t.length){ee.workspace.nvim.pauseNotification();for(let r of t)ee.workspace.nvim.call("win_gotoid",[r],!0),ee.workspace.nvim.command("enew",!0),ee.workspace.isVim&&ee.workspace.nvim.command("redraw",!0);ee.workspace.nvim.call("win_gotoid",[e],!0),await ee.workspace.nvim.resumeNotification()}}async function Xe(){return ee.workspace.nvim.call("bufnr")}var Ho=require("coc.nvim");var $i;async function _I(){return $i||($i=Ho.extensions.all.find(t=>t.id==="coc-floatinput")),$i==null?void 0:$i.exports}async function jh(){var t;if(!!C.get("enableFloatinput"))return(t=await _I())==null?void 0:t.FloatingUI}async function MI(t,e,r){e||(e=["yes","no"],r="no");let o=r?e.indexOf(r):-1,i=await Ho.workspace.nvim.call("confirm",[t,e.map(n=>{let a=[...n].findIndex(s=>/[A-Z]/.test(s));return a===-1&&(a=0),`${n.slice(0,a)}&${n[a].toUpperCase()}${n.slice(a+1)}`}).join(`
`),o+1]);if(i!==0)return e[i-1]}async function ze(t,e,r){let o=await jh();return o?o.confirm({prompt:t,values:e,defaultValue:r}):MI(t,e,r)}async function kI(t,e="",r=void 0){return Ho.workspace.nvim.callAsync("coc#util#with_callback",["input",[`${t} `,e,r]])}async function Ke(t,e="",r=void 0){var i;let o=await jh();return o?(i=await o.stringInput({prompt:t,defaultValue:e}))!=null?i:"":kI(t,e,r)}async function Sa(t,e,{onSelect:r,noChoice:o,onCancel:i}){var s,l,c;let n=t.get("openAction.select.filter");if(n.sources){let f=n.sources[e];f&&(n=S(S({},n),f))}let a=await Ho.workspace.nvim.call("coc_explorer#select_wins#start",[(s=n.buftypes)!=null?s:[],(l=n.filetypes)!=null?l:[],(c=n.floatingWindows)!=null?c:!0]);a>0?await Promise.resolve(r(a)):a===0?await Promise.resolve(o==null?void 0:o()):await Promise.resolve(i==null?void 0:i())}function ha(t,e="file"){return e==="file"&&We&&/^[A-Za-z]:/.test(t)&&(t=`/${t}`),`${e}://${t}`}var Hh=_(Fi());function Ca(t,e,r,o){return{red:t,green:e,blue:r,alpha:o}}function RI(t,e){let r=(t.red+e.red)/2,o=t.red-e.red,i=t.green-e.green,n=t.blue-e.blue;return Math.sqrt(((512+r)*o*o>>8)+4*i*i+((767-r)*n*n>>8))}function zl(t,e,r=o=>o){return Xs(e,o=>RI(r(o),t))}function Gi(t){t=t.trim(),t[0]==="#"&&(t=t.slice(1));let e=t.match(/.{1,2}/g);if(!e)return;let[r,o,i]=e;return Ca(parseInt(r,16),parseInt(o,16),parseInt(i,16),1)}function Hi(t){return Hh.default.rgb.hex(t.red,t.green,t.blue)}var Fg=require("coc.nvim");function q(t){return typeof t=="function"}function $o(t){let r=t(o=>{Error.call(o),o.stack=new Error().stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Ia=$o(t=>function(r){t(this),this.message=r?`${r.length} errors occurred during unsubscription:
${r.map((o,i)=>`${i+1}) ${o.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=r});function Fr(t,e){if(t){let r=t.indexOf(e);0<=r&&t.splice(r,1)}}var Pe=class{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(let n of r)n.remove(this);else r.remove(this);let{initialTeardown:o}=this;if(q(o))try{o()}catch(n){e=n instanceof Ia?n.errors:[n]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let n of i)try{$h(n)}catch(a){e=e!=null?e:[],a instanceof Ia?e=[...e,...a.errors]:e.push(a)}}if(e)throw new Ia(e)}}add(e){var r;if(e&&e!==this)if(this.closed)$h(e);else{if(e instanceof Pe){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}}_hasParent(e){let{_parentage:r}=this;return r===e||Array.isArray(r)&&r.includes(e)}_addParent(e){let{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e}_removeParent(e){let{_parentage:r}=this;r===e?this._parentage=null:Array.isArray(r)&&Fr(r,e)}remove(e){let{_finalizers:r}=this;r&&Fr(r,e),e instanceof Pe&&e._removeParent(this)}};Pe.EMPTY=(()=>{let t=new Pe;return t.closed=!0,t})();var Kl=Pe.EMPTY;function Oa(t){return t instanceof Pe||t&&"closed"in t&&q(t.remove)&&q(t.add)&&q(t.unsubscribe)}function $h(t){q(t)?t():t.unsubscribe()}var Qe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Go={setTimeout(t,e,...r){let{delegate:o}=Go;return o!=null&&o.setTimeout?o.setTimeout(t,e,...r):setTimeout(t,e,...r)},clearTimeout(t){let{delegate:e}=Go;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Pa(t){Go.setTimeout(()=>{let{onUnhandledError:e}=Qe;if(e)e(t);else throw t})}function Ui(){}var Gh=(()=>Xl("C",void 0,void 0))();function Uh(t){return Xl("E",void 0,t)}function qh(t){return Xl("N",t,void 0)}function Xl(t,e,r){return{kind:t,value:e,error:r}}var jr=null;function Uo(t){if(Qe.useDeprecatedSynchronousErrorHandling){let e=!jr;if(e&&(jr={errorThrown:!1,error:null}),t(),e){let{errorThrown:r,error:o}=jr;if(jr=null,r)throw o}}else t()}function Vh(t){Qe.useDeprecatedSynchronousErrorHandling&&jr&&(jr.errorThrown=!0,jr.error=t)}var Hr=class extends Pe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Oa(e)&&e.add(this)):this.destination=BI}static create(e,r,o){return new Zt(e,r,o)}next(e){this.isStopped?Jl(qh(e),this):this._next(e)}error(e){this.isStopped?Jl(Uh(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Jl(Gh,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},LI=Function.prototype.bind;function Ql(t,e){return LI.call(t,e)}var Zl=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:r}=this;if(r.next)try{r.next(e)}catch(o){Aa(o)}}error(e){let{partialObserver:r}=this;if(r.error)try{r.error(e)}catch(o){Aa(o)}else Aa(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(r){Aa(r)}}},Zt=class extends Hr{constructor(e,r,o){super();let i;if(q(e)||!e)i={next:e!=null?e:void 0,error:r!=null?r:void 0,complete:o!=null?o:void 0};else{let n;this&&Qe.useDeprecatedNextContext?(n=Object.create(e),n.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ql(e.next,n),error:e.error&&Ql(e.error,n),complete:e.complete&&Ql(e.complete,n)}):i=e}this.destination=new Zl(i)}};function Aa(t){Qe.useDeprecatedSynchronousErrorHandling?Vh(t):Pa(t)}function DI(t){throw t}function Jl(t,e){let{onStoppedNotification:r}=Qe;r&&Go.setTimeout(()=>r(t,e))}var BI={closed:!0,next:Ui,error:DI,complete:Ui};var qo=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Yh(t){return t}function zh(t){return t.length===0?Yh:t.length===1?t[0]:function(r){return t.reduce((o,i)=>i(o),r)}}var xe=class{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new xe;return r.source=this,r.operator=e,r}subscribe(e,r,o){let i=FI(e)?e:new Zt(e,r,o);return Uo(()=>{let{operator:n,source:a}=this;i.add(n?n.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=Kh(r),new r((o,i)=>{let n=new Zt({next:a=>{try{e(a)}catch(s){i(s),n.unsubscribe()}},error:i,complete:o});this.subscribe(n)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[qo](){return this}pipe(...e){return zh(e)(this)}toPromise(e){return e=Kh(e),new e((r,o)=>{let i;this.subscribe(n=>i=n,n=>o(n),()=>r(i))})}};xe.create=t=>new xe(t);function Kh(t){var e;return(e=t!=null?t:Qe.Promise)!==null&&e!==void 0?e:Promise}function WI(t){return t&&q(t.next)&&q(t.error)&&q(t.complete)}function FI(t){return t&&t instanceof Hr||WI(t)&&Oa(t)}function jI(t){return q(t==null?void 0:t.lift)}function er(t){return e=>{if(jI(e))return e.lift(function(r){try{return t(r,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function Je(t,e,r,o,i){return new ec(t,e,r,o,i)}var ec=class extends Hr{constructor(e,r,o,i,n,a){super(e),this.onFinalize=n,this.shouldUnsubscribe=a,this._next=r?function(s){try{r(s)}catch(l){e.error(l)}}:super._next,this._error=i?function(s){try{i(s)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=o?function(){try{o()}catch(s){e.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:r}=this;super.unsubscribe(),!r&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Xh=$o(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ke=class extends xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new _a(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new Xh}next(e){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:o,observers:i}=this;return r||o?Kl:(this.currentObservers=null,i.push(e),new Pe(()=>{this.currentObservers=null,Fr(i,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:o,isStopped:i}=this;r?e.error(o):i&&e.complete()}asObservable(){let e=new xe;return e.source=this,e}};ke.create=(t,e)=>new _a(t,e);var _a=class extends ke{constructor(e,r){super(),this.destination=e,this.source=r}next(e){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,e)}error(e){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,e)}complete(){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||r===void 0||r.call(e)}_subscribe(e){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(e))!==null&&o!==void 0?o:Kl}};var tc={now(){return(tc.delegate||Date).now()},delegate:void 0};var Ma=class extends Pe{constructor(e,r){super()}schedule(e,r=0){return this}};var qi={setInterval(t,e,...r){let{delegate:o}=qi;return o!=null&&o.setInterval?o.setInterval(t,e,...r):setInterval(t,e,...r)},clearInterval(t){let{delegate:e}=qi;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0};var ka=class extends Ma{constructor(e,r){super(e,r),this.scheduler=e,this.work=r,this.pending=!1}schedule(e,r=0){if(this.closed)return this;this.state=e;let o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(i,this.id,r),this}requestAsyncId(e,r,o=0){return qi.setInterval(e.flush.bind(e,this),o)}recycleAsyncId(e,r,o=0){if(o!=null&&this.delay===o&&this.pending===!1)return r;qi.clearInterval(r)}execute(e,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let o=this._execute(e,r);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,r){let o=!1,i;try{this.work(e)}catch(n){o=!0,i=n||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:r}=this,{actions:o}=r;this.work=this.state=this.scheduler=null,this.pending=!1,Fr(o,this),e!=null&&(this.id=this.recycleAsyncId(r,e,null)),this.delay=null,super.unsubscribe()}}};var tr=class{constructor(e,r=tr.now){this.schedulerActionCtor=e,this.now=r}schedule(e,r=0,o){return new this.schedulerActionCtor(this,e).schedule(o,r)}};tr.now=tc.now;var Ra=class extends tr{constructor(e,r=tr.now){super(e,r),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){let{actions:r}=this;if(this._active){r.push(e);return}let o;this._active=!0;do if(o=e.execute(e.state,e.delay))break;while(e=r.shift());if(this._active=!1,o){for(;e=r.shift();)e.unsubscribe();throw o}}};var Vi=new Ra(ka),Qh=Vi;function Jh(t){return t&&q(t.schedule)}var vg=_(yg(),1),{__extends:_5,__assign:M5,__rest:k5,__decorate:R5,__param:L5,__metadata:D5,__awaiter:Eg,__generator:B5,__exportStar:W5,__createBinding:F5,__values:j5,__read:H5,__spread:$5,__spreadArrays:G5,__spreadArray:U5,__await:Wa,__asyncGenerator:Ng,__asyncDelegator:q5,__asyncValues:Tg,__makeTemplateObject:V5,__importStar:Y5,__importDefault:z5,__classPrivateFieldGet:K5,__classPrivateFieldSet:X5,__classPrivateFieldIn:Q5}=vg.default;var Sg=t=>t&&typeof t.length=="number"&&typeof t!="function";function Cg(t){return q(t==null?void 0:t.then)}function Ig(t){return q(t[qo])}function Og(t){return Symbol.asyncIterator&&q(t==null?void 0:t[Symbol.asyncIterator])}function Pg(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function HI(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ag=HI();function _g(t){return q(t==null?void 0:t[Ag])}function Mg(t){return Ng(this,arguments,function*(){let r=t.getReader();try{for(;;){let{value:o,done:i}=yield Wa(r.read());if(i)return yield Wa(void 0);yield yield Wa(o)}}finally{r.releaseLock()}})}function kg(t){return q(t==null?void 0:t.getReader)}function Fa(t){if(t instanceof xe)return t;if(t!=null){if(Ig(t))return $I(t);if(Sg(t))return GI(t);if(Cg(t))return UI(t);if(Og(t))return Rg(t);if(_g(t))return qI(t);if(kg(t))return VI(t)}throw Pg(t)}function $I(t){return new xe(e=>{let r=t[qo]();if(q(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function GI(t){return new xe(e=>{for(let r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function UI(t){return new xe(e=>{t.then(r=>{e.closed||(e.next(r),e.complete())},r=>e.error(r)).then(null,Pa)})}function qI(t){return new xe(e=>{for(let r of t)if(e.next(r),e.closed)return;e.complete()})}function Rg(t){return new xe(e=>{YI(t,e).catch(r=>e.error(r))})}function VI(t){return Rg(Mg(t))}function YI(t,e){var r,o,i,n;return Eg(this,void 0,void 0,function*(){try{for(r=Tg(t);o=yield r.next(),!o.done;){let a=o.value;if(e.next(a),e.closed)return}}catch(a){i={error:a}}finally{try{o&&!o.done&&(n=r.return)&&(yield n.call(r))}finally{if(i)throw i.error}}e.complete()})}var Lg=$o(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Yi(t,e){let r=typeof e=="object";return new Promise((o,i)=>{let n=new Zt({next:a=>{o(a),n.unsubscribe()},error:i,complete:()=>{r?o(e.defaultValue):i(new Lg)}});t.subscribe(n)})}function Dg(t){return t instanceof Date&&!isNaN(t)}function Bg(t=0,e,r=Qh){let o=-1;return e!=null&&(Jh(e)?r=e:o=e),new xe(i=>{let n=Dg(t)?+t-r.now():t;n<0&&(n=0);let a=0;return r.schedule(function(){i.closed||(i.next(a++),0<=o?this.schedule(void 0,o):i.complete())},n)})}function $r(t){return er((e,r)=>{let o=[];return e.subscribe(Je(r,i=>o.push(i),()=>{r.next(o),r.complete()})),t.subscribe(Je(r,()=>{let i=o;o=[],r.next(i)},Ui)),()=>{o=null}})}function at(t,e=Vi){return er((r,o)=>{let i=null,n=null,a=null,s=()=>{if(i){i.unsubscribe(),i=null;let c=n;n=null,o.next(c)}};function l(){let c=a+t,f=e.now();if(f<c){i=this.schedule(void 0,c-f),o.add(i);return}s()}r.subscribe(Je(o,c=>{n=c,a=e.now(),i||(i=e.schedule(l,t),o.add(i))},()=>{s(),o.complete()},void 0,()=>{n=i=null}))})}function rr(t,e){return er((r,o)=>{let i=null,n=0,a=!1,s=()=>a&&!i&&o.complete();r.subscribe(Je(o,l=>{i==null||i.unsubscribe();let c=0,f=n++;Fa(t(l,f)).subscribe(i=Je(o,u=>o.next(e?e(l,u,f,c++):u),()=>{i=null,s()}))},()=>{a=!0,s()}))})}var oc={leading:!0,trailing:!1};function Wg(t,e=oc){return er((r,o)=>{let{leading:i,trailing:n}=e,a=!1,s=null,l=null,c=!1,f=()=>{l==null||l.unsubscribe(),l=null,n&&(p(),c&&o.complete())},u=()=>{l=null,c&&o.complete()},d=m=>l=Fa(t(m)).subscribe(Je(o,f,u)),p=()=>{if(a){a=!1;let m=s;s=null,o.next(m),!c&&d(m)}};r.subscribe(Je(o,m=>{a=!0,s=m,!(l&&!l.closed)&&(i?p():d(m))},()=>{c=!0,!(n&&a&&l&&!l.closed)&&o.complete()}))})}function ic(t,e=Vi,r=oc){let o=Bg(t,e);return Wg(()=>o,r)}function ja(t){return e=>{let r=t.subscribe(v.asyncCatch(e));return Fg.Disposable.create(()=>r.unsubscribe())}}function Ha(t){let e=new ke;return t(e).subscribe({error:v.error}),e}function jg(t,e){let r=new ke;return t.once(e,o=>{r.next(o)}),r.asObservable()}function Hg(t){let e=new ke;return t.event(r=>{e.next(r)}),e.asObservable()}function $a(t,e){let r=new ke;r.pipe(at(t),rr(async i=>e(...i))).subscribe({error:v.error});let o=(...i)=>r.next(i);return o.dispose=()=>r.unsubscribe(),o}function Ga(t,e,r){let o=new ke;o.pipe(ic(t,void 0,r),rr(async n=>e(...n))).subscribe({error:v.error});let i=(...n)=>o.next(n);return i.dispose=()=>o.unsubscribe(),i}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var v=new mi("explorer");var st=require("coc.nvim");var Ua=Symbol("arg"),zi,nc=class extends st.BasicList{constructor(r){super(st.workspace.nvim);Rf(this,zi,void 0);this.name=r.name,Lf(this,zi,(i,n)=>r.loadItems(this[Ua],i,n)),r.doHighlight&&(this.doHighlight=r.doHighlight),r.defaultAction&&(this.defaultAction=r.defaultAction);let o={addAction:(i,n,a)=>this.addAction(i,(s,l)=>n({arg:this[Ua],item:s,context:l}),a),addLocationActions:()=>this.addLocationActions(),convertLocation:i=>this.convertLocation(i)};r.init.call(o,o)}loadItems(r,o){return kf(this,zi).call(this,r,o)}};Ua,zi=new WeakMap;function or(t){return new nc(t)}async function Gr(t,e,r,o=[]){e[Ua]=r;let i=t.config,n=t.nvim,a=t.explorerManager.bufManager,s=i.get("floating.hideOnCocList",!0),l=!0;t.isFloating&&s&&(await t.hide(),l=!1);let c=new st.Emitter,f=st.listManager.registerList(e);return await n.command(`CocList ${o.join(" ")} ${e.name}`),f.dispose(),{async waitExplorerShow(){await a.waitReload();let u=st.events.on("BufEnter",async()=>{let d=a.getBufferNode(`list:///${e.name}`);d&&await ji(d.bufnr)||(u.dispose(),t.isFloating&&!l&&(await Lp(200),await t.show(),c.fire()))});if(!l)return new Promise(d=>{c.event(()=>{l=!0,d(void 0)})})}}}function zI(t,e){let r=t.indexOf(e);return r===-1?-1:t.length-r}var Yo=ac.workspace.createMru("explorer-actions"),$g=or({name:"explorerActionList",defaultAction:"do",async loadItems(t){let e=await Yo.load(),r=t.map(o=>({label:`${o.name} [${o.key||""}] ${o.description}`,data:U(S({},o),{score:zI(e,o.name)})}));return r.sort((o,i)=>i.data.score-o.data.score),r},doHighlight(){let{nvim:t}=ac.workspace;t.pauseNotification(),t.command("syntax match CocExplorerActionName /\\v^[a-zA-Z0-9:|<>]+/",!0),t.command("syntax match CocExplorerActionKey /\\v\\[.*\\]/",!0),t.command("syntax match CocExplorerActionDescription /\\v\\] \\zs.*/",!0),t.command("highlight default link CocExplorerActionName PreProc",!0),t.command("highlight default link CocExplorerActionKey Identifier",!0),t.command("highlight default link CocExplorerActionDescription Comment",!0),t.resumeNotification().catch(v.error)},init(){this.addAction("do",({item:t})=>{v.asyncCatch(async()=>{let e=t.data;await e.callback(),await Yo.add(e.name)})()})}});var Ki=require("coc.nvim");var zo={"expandable?":{filter:(t,e)=>e.expandable,getHelpDescription:()=>"expandable?"},"expanded?":{filter:(t,e)=>t.view.isExpanded(e),getHelpDescription:()=>"expanded?"},"type?":{filter:(t,e,r)=>e.type===r[0],getHelpDescription:t=>`type is ${t[0]}`}},Ur={name:"wait",helpDescription:"<wait>"},ir={name:"noop",helpDescription:"<noop>"};function KI(t){if(typeof t!="string")return t;let[e,...r]=t.split(/:/);return{name:e,args:r}}function Gg(t){let{name:e,args:r}=t;return[e,...r].join(":")}function Ug(t){return t.includes("<dot>")?t.replace(/<dot>/g,"."):t}function qr(t){return Array.isArray(t)?t.map(qr):KI(t)}function qg(t){let e={};for(let[r,o]of Object.entries(t))e[Ug(r)]=qr(o);return e}function qa(t,e){let r=qg(t);for(let[o,i]of Object.entries(e)){if(i===!1){delete r[o];continue}r[Ug(o)]=qr(i)}return r}function sc(t){return Array.isArray(t)?t.map(r=>sc(r)).filter(r=>r&&!(r.name in zo)&&r.name!==Ur.name&&r.name!==ir.name)[0]:t}var lc=class{constructor(){this.mode=C.get("keyMappingMode","default");this.mouseMappings={none:{},singleclick:{"<LeftRelease>":["expandable?",["expanded?","collapse","expand"],"open"]},doubleclick:{"<2-LeftMouse>":["expandable?",["expanded?","collapse","expand"],"open"]}}[C.get("mouseMode")];this.configByModes={none:{global:{},vmap:{},sources:{}},default:{global:U(S({"*":"toggleSelection","<tab>":"actionMenu",h:["wait","collapse"],l:["wait","expandable?","expand","open"],J:["wait","toggleSelection","normal:j"],K:["wait","toggleSelection","normal:k"],gl:["wait","expand:recursive"],gh:["wait","collapse:recursive"]},this.mouseMappings),{o:["wait","expanded?","collapse","expand"],"<cr>":["wait","expandable?","cd","open"],e:"open",s:"open:split",E:"open:vsplit",t:"open:tab","<bs>":["wait","gotoParent"],gs:["wait","reveal:select"],il:"preview:labeling",ic:"preview:content",Il:"previewOnHover:toggle:labeling",Ic:"previewOnHover:toggle:content",II:"previewOnHover:disable",yp:"copyFilepath",yn:"copyFilename",yy:"copyFile",yY:"copyFile:replace",dd:"cutFile",dD:"cutFile:replace",p:"pasteFile",df:"delete",dF:"deleteForever",a:"addFile",A:"addDirectory",r:"rename",zh:"toggleHidden","g<dot>":"toggleHidden",R:"refresh","?":"help",q:"quit","<esc>":"esc",X:"systemExecute",gd:"listDrive",f:"search",F:"search:recursive",gf:"gotoSource:file",gb:"gotoSource:buffer","[[":["wait","sourcePrev"],"]]":["wait","sourceNext"],"[i":["wait","indentPrev"],"]i":["wait","indentNext"],"[m":["wait","markPrev:modified"],"]m":["wait","markNext:modified"],"[d":["wait","markPrev:diagnosticError:diagnosticWarning"],"]d":["wait","markNext:diagnosticError:diagnosticWarning"],"[D":["wait","markPrev:diagnosticError"],"]D":["wait","markNext:diagnosticError"],"[c":["wait","markPrev:gitUnstaged:gitStaged"],"]c":["wait","markNext:gitUnstaged:gitStaged"],"[C":["wait","markPrev:gitUnstaged"],"]C":["wait","markNext:gitUnstaged"],"<<":"gitStage",">>":"gitUnstage"}),vmap:{il:"textobj:line:i",al:"textobj:line:a",ii:"textobj:indent:i",ai:"textobj:indent:a"},sources:{}}}}get config(){return this.configByModes[this.mode]}globalMappings(){return this.globalMappings_||(this.globalMappings_=qa(this.config.global,S({},C.get("keyMappings.global",{})))),this.globalMappings_}vmapMappings(){return this.vmapMappings_||(this.vmapMappings_=qa(this.config.vmap,S({},C.get("keyMappings.vmap",{})))),this.vmapMappings_}allSourceMappings(){var e;if(!this.allSourceMappings_){let r=(e=this.config.sources)!=null?e:{},o=C.get("keyMappings.sources",{});this.allSourceMappings_=new Map;for(let[i,n]of Object.entries(r))this.allSourceMappings_.set(i,S({},qg(n)));for(let[i,n]of Object.entries(o)){let a=this.allSourceMappings_.get(i);a?this.allSourceMappings_.set(i,qa(a,n)):this.allSourceMappings_.set(i,qa({},n))}}return this.allSourceMappings_}sourceMappings(e){return this.allSourceMappings().get(e)}async filterEscForVim(e){Ki.workspace.isVim&&!await Ki.workspace.nvim.call("has",["gui_running"])&&e.delete("<esc>")}async getCommonKeys(){let e=new Set;for(let r of Object.keys(this.globalMappings()))e.add(r);for(let r of this.allSourceMappings().values())for(let o of Object.keys(r))e.add(o);return await this.filterEscForVim(e),e}async getVisualKeys(){let e=new Set;for(let r of Object.keys(this.vmapMappings()))e.add(r);return e}getActionExp(e,r,o){var s,l,c;let i=this.vmapMappings(),n=this.globalMappings(),a=this.sourceMappings(e);return o==="v"?(l=(s=i==null?void 0:i[r])!=null?s:a==null?void 0:a[r])!=null?l:n[r]:(c=a==null?void 0:a[r])!=null?c:n[r]}async getMappings(e){let r=this.globalMappings(),o=this.vmapMappings(),i=this.sourceMappings(e),n=S(S({},r),i);return Ki.workspace.isVim&&!await Ki.workspace.nvim.call("has",["gui_running"])&&delete n["<esc>"],{all:n,vmap:o}}async getReversedMappings(e){let r=await this.getMappings(e),o={};return Object.entries(r.all).find(([i,n])=>{let a=sc(n);if(a){let s=Gg(a);o[s]||(o[s]={}),o[s].all=i}}),Object.entries(r.vmap).find(([i,n])=>{let a=sc(n);if(a){let s=Gg(a);o[s]||(o[s]={}),o[s].vmap=i}}),o}},et=new lc;function Vg(t,e){let r=t.indexOf(e);return r===-1?-1:t.length-r}var Va=class{constructor(e){this.explorerManager=e}async provideCodeActions(e,r,o,i){let n=await this.explorerManager.currentExplorer();if(!n)return[];let a=await n.view.currentSource();if(!a)return[];let s=await et.getReversedMappings(a.sourceType),l=a.action.registeredActions(),c=await Yo.load();return ye([...l.entries()].filter(([f])=>f!=="actionMenu").sort(([f],[u])=>f.localeCompare(u)).sort(([f],[u])=>f.localeCompare(u)).map(([f,{options:u}])=>{var h;let d=s[f],p=d?(h=d.vmap)!=null?h:d.all:"",m=[{title:`${f} [${p}]`,name:f,command:"explorer.doCodeAction",arguments:[f,f,async()=>[]],score:Vg(c,f)}];return u.menus&&m.push(...Mt.getNormalizeMenus(u.menus).map(g=>{var I;let x=`${f}:${g.args}`,b=s[x],T=b?(I=b.vmap)!=null?I:b.all:"";return{title:`${x} [${T}]`,name:x,command:"explorer.doCodeAction",arguments:[x,f,()=>g.actionArgs()],score:Vg(c,x)}})),m})).sort((f,u)=>u.score-f.score)}};var Qi=require("coc.nvim"),za=_(require("path"));var Ko=require("coc.nvim");var cc=class{constructor(){this.bufnrs=new Set}getExplorer(e){return this[e.name]}setExplorer(e,r){this[e.name]=r}all(){let e=[];return this.left&&e.push(this.left),this.right&&e.push(this.right),this.tab&&e.push(this.tab),this.floating&&e.push(this.floating),e}},fc=class{constructor(){this.initedEmitter=new Ko.Emitter;this.tabContainerMap=new Map;this.waitInited=Yi(Hg(this.initedEmitter))}get(e){let r=this.tabContainerMap.get(e);if(r)return r;{let o=new cc;return this.tabContainerMap.set(e,o),o}}async register(){let e=await Ko.workspace.nvim.call("tabpagebuflist");await oe.curTabAddBufnr(...e)}values(){return Array.from(this.tabContainerMap.values())}async currentTabId(){return await this.waitInited,await Ko.workspace.nvim.call("coc_explorer#tab#current_id")}async currentTabMaxId(){return await this.waitInited,await Ko.workspace.nvim.call("coc_explorer#tab#max_id")}async currentTabContainer(){return this.get(await this.currentTabId())}existBufnr(e){return this.values().some(r=>r.bufnrs.has(e))}async curTabAddBufnr(...e){let r=await this.currentTabId(),o=this.get(r);e.forEach(i=>o.bufnrs.add(i))}async curTabDelBufnr(...e){let r=await this.currentTabId(),o=this.get(r);e.forEach(i=>o.bufnrs.delete(i))}},oe=new fc;var nr=require("coc.nvim");var Fe=(t,e,r,o)=>{let i=nr.events.on(t,v.asyncCatch(e),r),n=nr.Disposable.create(()=>{typeof e.cancel=="function"&&e.cancel(),typeof e.dispose=="function"&&e.dispose(),i.dispose()});return o&&o.push(n),n};function Vr(t,e,r){let o=0,i=e!==0?$a(e,n=>{if(n!==o)return o=n,t(n)}):t;return Fe("BufEnter",i,void 0,r)}function uc(t,e,r){let o=Ga(e,t,{leading:!1,trailing:!0});return Fe("CursorMoved",o,void 0,r)}var Xi=new bi({BufDelete:{eventExpr:"BufDelete *",argExprs:['+expand("<abuf>")']},BufWipeout:{eventExpr:"BufWipeout *",argExprs:['+expand("<abuf>")']},TabEnter:{eventExpr:"TabEnter *",argExprs:['+expand("<abuf>")']},ColorScheme:{eventExpr:"ColorScheme *",argExprs:["g:colors_name"]},CocDiagnosticChange:{eventExpr:"User CocDiagnosticChange"},CocGitStatusChange:{eventExpr:"User CocGitStatusChange"},FugitiveChanged:{eventExpr:"User FugitiveChanged"},CocBookmarkChange:{eventExpr:"User CocBookmarkChange"}},v,{name:"explorer"}),lt=Xi.events,dG=new nr.Emitter;function dc(t){return E.create(()=>{nr.workspace.nvim.call("coc_explorer#util#do_autocmd",[t],!0)})}async function Ya(t){await dc(t).run()}var XI=/^\s*(\d+)(.+?)"(.+?)".*/,Ka=class{constructor(e){this.bufferNodeMapByFullpath=new Map;this.bufferNodeMapById=new Map;this.nvim=Qi.workspace.nvim;this.reloadSubject=new ke;this.modifiedSubject=new ke;this.bufferNodes=[];this.onReload=ja(this.reloadSubject);this.onReloadDebounce=ja(this.reloadSubject.pipe(at(500)));this.onModifiedDebounce=ja(this.modifiedSubject.pipe($r(this.modifiedSubject.pipe(at(500)))));this.registerEvents(e).catch(v.error)}async registerEvents(e){e.subscriptions.push(Fe(["BufCreate","BufHidden","BufUnload","BufWinEnter","BufWinLeave"],Ga(100,()=>this.reload(),{leading:!1,trailing:!0})),lt.on("BufDelete",()=>this.reload()),lt.on("BufWipeout",()=>this.reload())),e.subscriptions.push(Fe("BufWinEnter",o=>oe.curTabAddBufnr(o)),lt.on("TabEnter",o=>oe.curTabAddBufnr(o)));let r=async o=>{let i=this.bufferNodeMapById.get(o);if(!i)return;let n=await Qi.workspace.nvim.eval(`bufloaded(${o}) ? getbufvar(${o}, '&modified') : v:null`);n===null||i.modified===n||(i.modified=n,this.modifiedSubject.next(i.fullpath))};e.subscriptions.push(Fe("BufWritePost",async o=>{await r(o)}),...["TextChanged","TextChangedI","TextChangedP"].map(o=>Fe(o,async i=>{await r(i)})))}async removeBufNode(e,r){if(!r.skipModified&&e.modified)throw new Error("The content of buffer has not been saved!");let o=await Yl(e.bufnr);await Ta(o),r.bwipeout?await this.nvim.command(`bwipeout! ${e.bufnr}`):await this.nvim.command(`bdelete! ${e.bufnr}`)}async removePrefix(e,r){for(let[o,i]of this.bufferNodeMapByFullpath)o.startsWith(e)&&await this.removeBufNode(i,r)}async remove(e,r){if(r.directory)return this.removePrefix(e+za.default.sep,r);{let o=this.bufferNodeMapByFullpath.get(e);if(!o)return;await this.removeBufNode(o,r)}}async replaceBufNode(e,r,o){if(!o.skipModified&&e.modified)throw new Error("The content of buffer has not been saved!");let{nvim:i}=this,n=await i.call("win_getid",[]),a=await Yl(e.bufnr);if(a.length){let s=await i.call("fnameescape",[r]);i.pauseNotification();for(let l of a)i.call("win_gotoid",[l],!0),i.command(`edit ${s}`,!0),Qi.workspace.isVim&&i.command("redraw",!0);i.call("win_gotoid",[n],!0),await i.resumeNotification()}o.bwipeout?await i.command(`bwipeout! ${e.bufnr}`):await i.command(`bdelete! ${e.bufnr}`)}async replacePrefix(e,r,o){for(let[i,n]of this.bufferNodeMapByFullpath)if(i.startsWith(e)){let a=n.fullpath.replace(e,r);await this.replaceBufNode(n,a,o)}}async replace(e,r,o){return this.replacePrefix(e,r,o)}modified(e,r){var o,i;return r.directory?this.modifiedPrefix(e+za.default.sep):(i=(o=this.bufferNodeMapByFullpath.get(e))==null?void 0:o.modified)!=null?i:!1}modifiedPrefix(e){for(let[r,o]of this.bufferNodeMapByFullpath)if(r.startsWith(e)&&o.modified)return!0;return!1}getBufferNode(e){return typeof e=="number"?this.bufferNodeMapById.get(e):this.bufferNodeMapByFullpath.get(e)}async waitReload(){return new Promise(e=>{let r=this.onReload(()=>{r.dispose(),e()});setTimeout(e,100)})}async reload(){let e="ls!",r=await this.nvim.call("execute",e);this.bufferNodes=ue(await Promise.all(r.split(/\n/).map(async o=>{let i=o.match(XI);if(!i)return;let n=i[1],a=i[2],s=i[3],l=await Qi.workspace.nvim.call("expand",[`#${n}:p`,1]);return{type:"child",uid:n,level:1,bufnr:parseInt(n),bufnrStr:n,bufname:s,fullpath:l,name:za.default.basename(s),unlisted:a.includes("u"),current:a.includes("%"),previous:a.includes("#"),visible:a.includes("a"),hidden:a.includes("h"),modifiable:!a.includes("-"),readonly:a.includes("="),terminal:a.includes("R")||a.includes("F")||a.includes("?"),modified:a.includes("+"),readErrors:a.includes("x")}}))),this.bufferNodeMapByFullpath=this.bufferNodes.reduce((o,i)=>(o.set(i.fullpath,i),o),new Map),this.bufferNodeMapById=this.bufferNodes.reduce((o,i)=>(o.set(i.bufnr,i),o),new Map),this.reloadSubject.next()}};var ro=require("coc.nvim");var zg=require("coc.nvim");var Yg=require("coc.nvim");async function Xa(t){let e=await Yg.workspace.nvim.eval('get(g:, "coc_explorer_global_presets", {})');return new Map(Object.entries(S(S({},e),t.get("presets"))).map(([r,o])=>[r,new Map(Object.entries(o))]))}var Xo=class{constructor(e){this.args=e;this.optionValues=new Map}static registerOption(e,r={}){let o=S({type:r.position===void 0?"string":"positional",name:e},r);return this.registeredOptions.set(e,o),o}static registerBoolOption(e,r){let o={type:"boolean",name:e,getDefault:typeof r=="boolean"?()=>r:r};return this.registeredOptions.set(e,o),this.registeredOptions.set(`no-${e}`,o),o}static async parse(e,r){var c,f;let o=new Xo(e),i=[...e],n=1;for(;i.length>0;){let u=i.shift();if(u.startsWith("--")){let p,m;/^--[\w-]+=/.test(u)?[p,m]=Zf(u.slice(2),"=",2):p=u.slice(2);let h=this.registeredOptions.get(p);if(!h)throw Error(`coc-explorer command no support option(${p})`);if(m===void 0){if(h.type==="boolean"){o.optionValues.set(h.name,!p.startsWith("no-"));continue}else if(m=i.shift(),m===void 0)continue}o.optionValues.set(h.name,h.parseArg?await h.parseArg(m):m);continue}let d=Array.from(this.registeredOptions.values()).find(p=>p.position===n);d&&o.optionValues.set(d.name,d.parseArg?await d.parseArg(u):u),n+=1}let a=o.optionValues.get("preset");if(!a)return o;let l=(await Xa(r)).get(a);if(!l)return zg.window.showMessage(`coc-explorer preset(${a}) not found`,"warning"),o;for(let[u,d]of l){if(o.optionValues.has(u)||d===void 0)continue;let p=this.registeredOptions.get(u);p&&o.optionValues.set(u,(f=(c=p.parsePreset)==null?void 0:c.call(p,d))!=null?f:d)}return o}has(e){return this.optionValues.has(e.name)}async value(e){var o,i,n,a,s;let r;if(this.optionValues.has(e.name))r=this.optionValues.get(e.name);else if(Xo.registeredOptions.has(e.name))r=await((i=(o=Xo.registeredOptions.get(e.name))==null?void 0:o.getDefault)==null?void 0:i.call(o));else throw new Error(`Argument(${e.name}) not found`);return(s=(a=(n=Xo.registeredOptions.get(e.name))==null?void 0:n.handler)==null?void 0:a.call(n,r))!=null?s:r}async values(e){return(await Promise.all(Object.entries(e).map(async([o,i])=>[o,await this.value(i)]))).reduce((o,[i,n])=>(o[i]=n,o),{})}},R=Xo;R.registeredOptions=new Map;var Ae={rootUri:R.registerOption("root-uri",{position:1}),rootStrategies:R.registerOption("root-strategies",{parseArg:t=>t.split(","),getDefault:()=>C.get("root.strategies")}),toggle:R.registerBoolOption("toggle",()=>C.get("toggle")),openActionStrategy:R.registerOption("open-action-strategy",{getDefault:()=>C.get("openAction.strategy")}),focus:R.registerBoolOption("focus",()=>C.get("focus")),quit:R.registerBoolOption("quit",!1),quitOnOpen:R.registerBoolOption("quit-on-open",()=>C.get("quitOnOpen")),reveal:R.registerOption("reveal",{handler:t=>t&&le(t)}),revealWhenOpen:R.registerBoolOption("reveal-when-open"),preset:R.registerOption("preset"),sources:R.registerOption("sources",{parseArg:t=>t.split(",").map(e=>{let r=!1,o;return e.endsWith("+")?(r=!0,o=e.slice(0,e.length-1)):e.endsWith("-")?(r=!1,o=e.slice(0,e.length-1)):o=e,{name:o,expand:r}}),getDefault:()=>C.get("sources")}),position:R.registerOption("position",{parseArg:t=>{let[e,r]=t.split(":");return{name:e,arg:r}},parsePreset:t=>Array.isArray(t)?{name:t[0],arg:t[0]}:typeof t=="string"?{name:t}:t,getDefault:()=>{let t=C.get("position");return Array.isArray(t)?{name:t[0],arg:t[1]}:{name:t}}}),width:R.registerOption("width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("width")}),contentWidth:R.registerOption("content-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("contentWidth")}),contentWidthType:R.registerOption("content-width-type",{getDefault:()=>C.get("contentWidthType")}),floatingPosition:R.registerOption("floating-position",{parseArg:t=>["left-center","right-center","center","center-top"].includes(t)?t:t.split(",").map(e=>parseInt(e,10)),getDefault:()=>C.get("floating.position")}),floatingWidth:R.registerOption("floating-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.width")}),floatingHeight:R.registerOption("floating-height",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.height")}),floatingContentWidth:R.registerOption("floating-content-width",{parseArg:t=>parseInt(t,10),getDefault:()=>C.get("floating.contentWidth")})};var Kg=require("coc.nvim"),Qa="coc_explorer_context",Ja=class{constructor(e){this.name=e}async set(e){let r=await this.read();e===void 0?Reflect.deleteProperty(r,this.name):Reflect.set(r,this.name,e),await this.write(r)}async get(){let e=await this.read();return Reflect.get(e,this.name)}},Qo=class extends Ja{constructor(r,o){super(r);this.name=r;this.buffer=o}async read(){return await this.buffer.getVar(Qa)||{}}async write(r){await this.buffer.setVar(Qa,r)}};var Ji=class extends Ja{constructor(){super(...arguments);this.nvim=Kg.workspace.nvim}async read(){var r;return(r=await this.nvim.getVar(Qa))!=null?r:{}}async write(r){await this.nvim.setVar(Qa,r)}};var Ue=require("coc.nvim"),rb=_(hc());var es=require("coc.nvim");var Jo=class{constructor(e){this.owner=e;this.actions=new Map}addNodesAction(e,r,o,i={}){this.actions.set(e,{callback:r,description:o,options:S({select:!0},i)})}addNodeAction(e,r,o,i={}){this.actions.set(e,{callback:async({source:n,nodes:a,args:s,mode:l})=>{for(let c of a)await r.call(n,{source:n,node:c,args:s,mode:l})},description:o,options:i})}};var Za=class extends Jo{constructor(r){super(r);this.waitActionMutex=new es.Mutex;this.explorer=this.owner}get locator(){return this.explorer.locator}async doActionByKey(r,o,i=1){for(let n=0;n<i;n++){let a=await this.explorer.getSelectedOrCursorLineIndexes(o),s=this.explorer.lineIndexesGroupBySource(a);for(let{source:l,lineIndexes:c}of s){let f=et.getActionExp(l.sourceType,r,o);f&&await this.doActionExp(f,{mode:o,lineIndexes:c})}}await this.explorer.view.emitRequestRenderNodes()}async doActionExp(r,o={}){var s,l;let i=(s=o.count)!=null?s:1,n=(l=o.mode)!=null?l:"n",a=o.lineIndexes?new Set(o.lineIndexes):await this.explorer.getSelectedOrCursorLineIndexes(n);try{for(let c=0;c<i;c++){let f=c===0?a:await this.explorer.getSelectedOrCursorLineIndexes(n),u=new Map;for(let d of f){let{source:p}=this.explorer.findSourceByLineIndex(d);u.has(p)||u.set(p,[]);let m=d-p.view.startLineIndex;u.get(p).push(p.view.flattenedNodes[m])}for(let[d,p]of u)await d.action.doActionExp(r,p,{mode:n})}}catch(c){es.window.showMessage(`Error when do action(${JSON.stringify(r)})`,"error"),v.error(c)}}async nodePrev(r="default",o){let i=async(n,a,s)=>{let l=Yn(n,a,await Nt(),o);l!==void 0&&await this.locator.gotoLineIndex(s+l)};if(r==="insideSource"){let n=await this.explorer.view.currentSource();if(!n)return;await i(n.view.flattenedNodes,n.view.currentLineIndex,n.view.startLineIndex)}else await i(this.explorer.view.flattenedNodes,this.explorer.view.currentLineIndex,0)}async nodeNext(r="default",o){let i=async(n,a,s)=>{let l=zn(n,a,await Nt(),o);l!==void 0&&await this.locator.gotoLineIndex(s+l)};if(r==="insideSource"){let n=await this.explorer.view.currentSource();if(!n)return;await i(n.view.flattenedNodes,n.view.currentLineIndex,n.view.startLineIndex)}else await i(this.explorer.view.flattenedNodes,this.explorer.view.currentLineIndex,0)}};var Ew=require("coc.nvim");var cw=require("coc.nvim"),ft=_(require("path"));var Yr=require("coc.nvim"),gc=_(require("path"));var Tt=(f=>(f.mixed="*",f.unmodified=" ",f.modified="M",f.added="A",f.deleted="D",f.renamed="R",f.copied="C",f.unmerged="U",f.untracked="?",f.ignored="!",f))(Tt||{});var ZI=(t,e)=>t.x===e.x&&t.y===e.y,eO=(t,e)=>t.allStaged!==e.allStaged?!1:t.formats.join(",")===e.formats.join(","),ts=class{constructor(){this.sourcesBinding=new Map;this.prevStatusesMapInRoot=new Map;this.prevIgnoresMapInRoot=new Map;this.prevRootStatuses=new Map;this.registerForSourceDisposables=[];this.registerDisposables=[];this.inited=!1;this.reloadDebounceSubject=Ha(e=>e.pipe($r(e.pipe(at(200))),rr(async r=>{let o=new Set(r.map(n=>n.sources).flat()),i=new Set(r.map(n=>n.directory));await this.reload([...o],[...i])})))}get explorerManager(){if(!this.explorerManager_)throw new Error("ExplorerSource(explorerManager) is not bound yet");return this.explorerManager_}get sources(){return Array.from(this.sourcesBinding.keys())}get refTotalCount(){return se(Array.from(this.sourcesBinding.values()).map(e=>e.refCount))}init_(e){this.inited||(this.inited=!0,this.explorerManager_=e.explorer.explorerManager)}bind(e){this.init_(e);let r=Vn(this.sourcesBinding,e,()=>({refCount:0}));return r.refCount+=1,r.refCount===1&&(this.registerForSourceDisposables=this.registerForSource(e)),this.refTotalCount===1&&(this.registerDisposables=this.register()),Yr.Disposable.create(()=>{r.refCount-=1,r.refCount===0&&((0,Yr.disposeAll)(this.registerForSourceDisposables),this.registerForSourceDisposables=[]),this.refTotalCount===0&&((0,Yr.disposeAll)(this.registerDisposables),this.registerDisposables=[])})}register(){return[...["CocGitStatusChange","FugitiveChanged"].map(e=>lt.on(e,async()=>{this.reloadDebounceSubject.next({sources:this.sources,directory:Yr.workspace.cwd})})),Fe("BufWritePost",async e=>{var o;let r=(o=this.explorerManager.bufManager.getBufferNode(e))==null?void 0:o.fullpath;if(r){let i=gc.default.dirname(r);this.reloadDebounceSubject.next({sources:this.sources,directory:i})}})]}registerForSource(e){return[e.events.on("loaded",async r=>{let o="isRoot"in r?e.root:r.expandable?r.fullpath:r.fullpath&&gc.default.dirname(r.fullpath);o&&this.reloadDebounceSubject.next({sources:[e],directory:o})})]}async reload(e,r){let o=await B.getGitRoots(r);if(!o.length)return;let i=new Set,n=new Set;for(let a of o){await B.reload(a);let s=B.getMixedStatusesByRoot(a),l=B.getIgnoreByRoot(a),c=B.getRootStatus(a)||{allStaged:!1,formats:[]},f=this.prevStatusesMapInRoot.get(a);f||(f=new Map,this.prevStatusesMapInRoot.set(a,f));let u=this.prevIgnoresMapInRoot.get(a);u||(u=new Map,this.prevIgnoresMapInRoot.set(a,u));let d=this.prevRootStatuses.get(a);d||(d={allStaged:!1,formats:[]},this.prevRootStatuses.set(a,d));let p=(m,h)=>{h===0?n.add(m.replace(/[\\/]$/,"")):i.add(m)};for(let[m,h]of s){let g=f.get(m);if(g&&ZI(g,h)){f.delete(m);continue}i.add(m)}for(let m of f.keys())i.add(m);for(let[m,h]of l){if(u.get(m)===h){u.delete(m);continue}p(m,h)}for(let[m,h]of u)p(m,h);c&&!eO(d,c)&&i.add(a),this.prevStatusesMapInRoot.set(a,s),this.prevIgnoresMapInRoot.set(a,l),this.prevRootStatuses.set(a,c)}for(let a of e)await a.view.renderPaths([...i,{paths:n,withChildren:!0}])}};var sw=require("coc.nvim"),lw=_(aw()),yc=_(require("path"));var ei=class{static get binPath(){return C.get("git.command")}static async waitLoaded(){if(!this.loaded)return new Promise(e=>{this.onLoaded(e)})}static async preload(){try{await(0,lw.default)(this.binPath),this.available=!0}catch{this.available=!1}finally{this.loaded=!0,this.loadedEmitter.fire()}}get binPath(){return ei.binPath}async available(){return await ei.waitLoaded(),ei.available}spawn(e,{cwd:r}={}){return fa(this.binPath,e,{cwd:r})}async getRoot(e){let r=await Dr(e).catch(()=>{}),o=r!=null&&r.isDirectory()?e:yc.default.dirname(e),i=await this.spawn(["rev-parse","--show-toplevel"],{cwd:o});return le(i.trim())}parseStatusFormat(e){var r;return(r=Object.values(Tt).find(o=>o===e))!=null?r:" "}parsePath(e,r){let o=0,i="",n=!1,a=!1,s=!1,l=[];for(;o<e.length;){let c=e[o];if(!n&&!a){c==='"'&&(a=!0,o+=1),i="",n=!0;continue}else a?s?(i+=c==="t"?"	":c,s=!1):c==='"'?(l.push(i),a=!1,n=!1):c==="\\"?s=!0:i+=c:c===" "&&r&&e.slice(o,o+4)===" -> "?(i.length&&l.push(i),o+=3,n=!1):i+=c;o+=1}return n&&(l.push(i),n=!1),l}parseStatusLine(e,r){let o=this.parseStatusFormat(r[0]),i=this.parseStatusFormat(r[1]),n=r.slice(3),a=["R","C"].includes(o)||["R","C"].includes(i),s=this.parsePath(n,a);return[o,i,...s.map(l=>yc.default.join(e,l))]}async status(e,{showUntrackedFiles:r="system",showIgnored:o=!0}={}){let i=new Map,n=["status","--porcelain"];return r===!0?n.push("-u"):r===!1&&n.push("-uno"),o&&n.push("--ignored=matching"),(await this.spawn(n,{cwd:e})).split(`
`).forEach(l=>{if(!l)return;let[c,f,u,d]=this.parseStatusLine(e,l),p=c==="?"?" ":c,m=f==="!"?" ":f,h=["M","A","D","R","C"],g=p==="A"||m==="A",x=p==="M"||m==="M",b=p==="D"||m==="D",T=p==="R"||m==="R",I=p==="C"||m==="C",H=h.includes(p)&&m===" ",qe=p==="D"&&m==="D"||p==="A"&&m==="A"||p==="U"||m==="U",Re=p==="!",Ne=m==="?",Se=d||u;i.set(Se,{fullpath:Se,x:p,y:m,added:g,modified:x,deleted:b,renamed:T,copied:I,staged:H,unmerged:qe,untracked:Ne,ignored:Re})}),i}async stage(e){if(e.length){let r=await this.getRoot(e[0]);await this.spawn(["add",...e],{cwd:r})}}async unstage(e){if(e.length){let r=await this.getRoot(e[0]);await this.spawn(["reset",...e],{cwd:r})}}async fetch(e){await this.spawn(["fetch"],{cwd:e})}async hasPull(e){let r=await this.spawn(["rev-list","--count","@..@{upstream}"],{cwd:e});return parseInt(r)}async hasPush(e){let r=await this.spawn(["rev-list","--count","@{upstream}..@"],{cwd:e});return parseInt(r)}async hasStashed(e){return(await this.spawn(["stash","list"],{cwd:e})).split(/\n/g).length-1}async checkIgnore(e){if(!e.length)return[];let r=await this.getRoot(e[0]);return(await this.spawn(["check-ignore",...e],{cwd:r})).split(/\n/g)}},ct=ei;ct.available=!1,ct.loadedEmitter=new sw.Emitter,ct.loaded=!1,ct.onLoaded=ei.loadedEmitter.event;var vc=class{constructor(){this.cmd=new ct;this.rootCache=new Map;this.mixedStatusMapCacheInRoot=new Map;this.ignoreMapCacheInRoot=new Map;this.rootStatusCache=new Map;this.binder=new ts;this.showIgnored=C.get("git.showIgnored"),this.showUntrackedFiles=C.get("file.git.showUntrackedFiles")}async getGitRoots(e){let r=[...new Set(e)],o=await Promise.all(r.map(i=>this.getGitRoot(i)));return ue(o)}async getGitRoot(e){let r=this.rootCache.get(e);if(r)return r;let o=e.split(ft.default.sep),i=o.indexOf(".git");if(i!==-1){let n=o.slice(0,i).join(ft.default.sep);this.rootCache.set(e,n)}else try{let n=await this.cmd.getRoot(e);ft.default.isAbsolute(n)?this.rootCache.set(e,n):ft.default.join(e,n)}catch(n){v.error(n);return}return this.rootCache.get(e)}async reload(e,r={}){var i,n;let o=await this.getGitRoot(e);if(o){let a={showIgnored:(i=r.showIgnored)!=null?i:this.showIgnored,showUntrackedFiles:(n=r.showUntrackedFiles)!=null?n:this.showUntrackedFiles},s=await this.cmd.status(o,a),l=[...s.values()],c={allStaged:!0,formats:[]};this.rootStatusCache.set(o,c),await this.cmd.hasStashed(o)&&c.formats.push(5),await this.cmd.hasPull(o)&&c.formats.push(2),await this.cmd.hasPush(o)&&c.formats.push(1),l.some(d=>d.y==="U")&&c.formats.push(3),l.some(d=>d.y==="?")&&c.formats.push(4),l.some(d=>d.x==="M"||d.y==="M")&&c.formats.push(6),l.some(d=>d.x==="A")&&c.formats.push(7),l.some(d=>d.x==="R")&&c.formats.push(8),l.some(d=>d.x==="D"||d.y==="D")&&c.formats.push(9),l.some(d=>d.y!==" ")&&(c.allStaged=!1);let f=new Map,u=new Map;this.mixedStatusMapCacheInRoot.set(o,f),this.ignoreMapCacheInRoot.set(o,u),s.forEach((d,p)=>{if(d.x==="!"){["/","\\"].includes(p[p.length-1])?u.set(p,0):u.set(p,1);return}let h=ft.default.relative(o,p).split(ft.default.sep);for(let g=1;g<=h.length;g++){let x=ft.default.join(o,ft.default.join(...h.slice(0,g))),b=f.get(x);b?(b.x!=="*"&&b.x!==d.x&&(b.x===" "?b.x=d.x:d.x!==" "&&(b.x="*")),b.y!=="*"&&b.y!==d.y&&(b.y===" "?b.y=d.y:d.y!==" "&&(b.y="*"))):f.set(x,{x:d.x,y:d.y})}})}return o}bindColumn(e){return C.get("git.enable")?this.binder.bind(e):cw.Disposable.create(()=>{})}getMixedStatusesByRoot(e){return this.mixedStatusMapCacheInRoot.get(e)||new Map}getIgnoreByRoot(e){return this.ignoreMapCacheInRoot.get(e)||new Map}getMixedStatus(e,r){let o=[...this.mixedStatusMapCacheInRoot.entries()].sort((n,a)=>a[0].localeCompare(n[0])).find(([n])=>e.startsWith(n));if(o){let n=o[1].get(e);if(n)return n}let i=[...this.ignoreMapCacheInRoot.entries()].sort((n,a)=>a[0].localeCompare(n[0])).find(([n])=>e.startsWith(n));if(i&&[...i[1].entries()].some(([s,l])=>l===1?s===e:(r?e+ft.default.sep:e).startsWith(s)))return{x:"!",y:" "}}getRootStatus(e){return this.rootStatusCache.get(e)}},B=new vc;var fw=["line","indent"],uw=["i","a"],dw=["default","insideSource"],pw=["select","previousBuffer","previousWindow","sourceWindow","path"],mw=["select","split","split.plain","split.intelligent","vsplit","vsplit.plain","vsplit.intelligent","tab","previousBuffer","previousWindow","sourceWindow"],hw=["toggle","append","replace"],gw=["keepCopy","clear"],ww=["toggle","enable","disable"],Ec=["labeling","content"],os=["keep","workspace","cwd","sourceBuffer","reveal"],xw=["recursive","noIgnore","strict"],bw=["recursive","compact","uncompact","recursiveSingle"],yw=["recursive","all"];var Nc=require("coc.nvim");async function vw(t,e,r,o,{openByWinnr:i,openStrategy:n,position:a}){if(r.expandable)return;let{nvim:s}=Nc.workspace,l=async()=>{let g=await o();return t.config.get("openAction.relativePath")&&(g=await s.call("fnamemodify",[g,":."])),await s.call("fnameescape",[g])},c,f=()=>t.tryQuitOnOpenNotifier();a==="keep"&&(c=await t.winid,f=()=>E.noop());let u=t.argValues.position,d=()=>{var g;if(a==="keep"){if(!c)return;s.call("win_gotoid",[c],!0)}else a&&s.call("cursor",[a.lineIndex+1,((g=a.columnIndex)!=null?g:0)+1],!0)},p=i!=null?i:async g=>{let x=await f(),b=await l();s.pauseNotification(),s.command(`${g}wincmd w`,!0),s.command(`edit ${b}`,!0),d(),Nc.workspace.isVim&&s.command("redraw",!0),x.notify(),await s.resumeNotification()},m=async(g,x)=>{let b=await t.winid;if(!b)return;let I=(await vi.create()).findWinid(b);if(I)if(I.parent&&I.parent.group.type==="row"){let H=I.parent.group.children[I.parent.indexInParent+(u.name==="left"?1:-1)];if(H){let qe=vi.getFirstLeafWinid(H),Re=await f(),Ne=await l();s.pauseNotification(),s.call("win_gotoid",[qe],!0),s.command(`${g} ${Ne}`,!0),d(),Re.notify(),await s.resumeNotification()}}else await h["vsplit.plain"]();else await h[x]()},h={select:async()=>{u.name==="floating"&&await t.hide(),await Sa(t.config,e.sourceType,{onSelect:async g=>{await p(g)},noChoice:async()=>{await h.vsplit()},onCancel:async()=>{u.name==="floating"&&await t.show()}})},split:()=>h["split.intelligent"](),"split.plain":async()=>{let g=await f(),x=await l();s.pauseNotification(),s.command(`split ${x}`,!0),d(),g.notify(),await s.resumeNotification()},"split.intelligent":async()=>{if(u.name==="floating"){await h["split.plain"]();return}else if(u.name==="tab"){await h.vsplit();return}await m("split","split.plain")},vsplit:()=>h["vsplit.intelligent"](),"vsplit.plain":async()=>{let g=await f(),x=await l();s.pauseNotification(),s.command(`vsplit ${x}`,!0),d(),g.notify(),await s.resumeNotification()},"vsplit.intelligent":async()=>{if(u.name==="floating"){await h["vsplit.plain"]();return}else if(u.name==="tab"){await h["vsplit.plain"]();return}await m("vsplit","vsplit.plain")},tab:async()=>{await t.tryQuitOnOpen(),s.pauseNotification(),s.command(`tabedit ${await l()}`,!0),d(),await s.resumeNotification()},previousBuffer:async()=>{let g=await t.explorerManager.prevWinnrByPrevBufnr();g?await p(g):await h.vsplit()},previousWindow:async()=>{let g=await t.explorerManager.prevWinnrByPrevWindowID();g?await p(g):await h.vsplit()},sourceWindow:async()=>{let g=await t.sourceWinnr();g?await p(g):await h.vsplit()}};n||(n=await t.args.value(Ae.openActionStrategy)),Ze(h,n)||new Error(`openStrategy(${n}) is not supported`),await h[n]()}function Nw(t){let e=t.owner,r=e.locator,{nvim:o}=Ew.workspace,i=[{name:"open strategy",description:mw.join(" | ")},{name:"open with position",description:"line-number,column-number | keep"}],n={select:"use select window UI","select:keep":"use select window UI, but keep cursor in explorer","split.plain":"use vim split","split.intelligent":"use split like vscode","vsplit.plain":"use vim vsplit","vsplit.intelligent":"use vim vsplit, but keep the explorer in the original position",tab:"vim tab",previousBuffer:"use last used buffer",previousWindow:"use last used window",sourceWindow:"use the window where explorer opened"};t.addNodeAction("open",async({source:c,node:f,args:u,mode:d})=>{if(f.expandable){let g=e.config.get("openAction.for.directory");g&&await e.action.doActionExp(qr(g),{mode:d,lineIndexes:[e.view.flattenedNodes.indexOf(f)]});return}let[p,m]=u,h;if(m==="keep")h=m;else if(m){let[g,x]=m.split(",").map(b=>parseInt(b,10));h={lineIndex:g},x&&(h.columnIndex=x)}else if(f.location){let{range:g}=f.location;h={lineIndex:g.start.line-1}}await vw(e,c,f,()=>f.fullpath,{openStrategy:p,position:h})},"open file or directory",{select:!0,args:i,menus:n}),t.addNodeAction("expand",async({source:c,node:f,args:u})=>{var d;if(f.expandable){let p=((d=u[0])!=null?d:"").split("|"),m=p.includes("recursive")||void 0,h=p.includes("compact")||void 0,g=p.includes("uncompact")||void 0,x=p.includes("recursiveSingle")||void 0;await c.view.expand(f,{recursive:m,compact:h,uncompact:g,recursiveSingle:x})}},"expand node",{select:!0,args:[{name:"expand options",description:bw.join(" | ")}],menus:{recursive:"recursively",compact:"single child folders will be compressed in a combined node",uncompact:"reset the combined node","compact|uncompact":"compact or uncompact",recursiveSingle:"expand single child folder recursively"}}),t.addNodeAction("collapse",async({source:c,node:f,args:u})=>{var h;let d=((h=u[0])!=null?h:"").split("|"),p=d.includes("all"),m=d.includes("recursive");if(p&&c.view.rootNode.children)for(let g of c.view.rootNode.children)g.expandable&&c.view.isExpanded(g)&&await c.action.doAction("collapse",g,d.filter(x=>x!=="all"));else f.expandable&&c.view.isExpanded(f)?await c.view.collapse(f,{recursive:m}):f.parent&&await c.view.collapse(f.parent,{recursive:m})},"collapse node",{select:!0,args:[{name:"collapse options",description:yw.join(" | ")}],menus:{recursive:"recursively",all:"for all nodes"}}),t.addNodesAction("gitStage",async({nodes:c,source:f})=>{let u=di(c.map(p=>p.fullpath));if(!u.length)return;await B.cmd.stage(u);let d=await B.getGitRoots(u);for(let p of d)await B.reload(p);f.view.requestRenderNodes([{nodes:c,withParents:!0,withChildren:!0}])},"add file to git index"),t.addNodesAction("gitUnstage",async({nodes:c,source:f})=>{let u=di(c.map(p=>p.fullpath));if(!u.length)return;await B.cmd.unstage(u);let d=await B.getGitRoots(u);for(let p of d)await B.reload(p);f.view.requestRenderNodes([{nodes:c,withParents:!0,withChildren:!0}])},"reset file from git index");let a=[{name:"move action options",description:dw.join(" | ")}],s={insideSource:"move inside current source"};t.addNodeAction("nodePrev",async({args:c})=>{if(c[0]==="insideSource"){let u=await e.view.currentSource();if(!u)return;await u.locator.gotoLineIndex(u.view.currentLineIndex-1)}else{let u=e.view.currentLineIndex;await r.gotoLineIndex(u-1)}},"previous node",{args:a,menus:s}),t.addNodeAction("nodeNext",async({args:c})=>{if(c[0]==="insideSource"){let u=await e.view.currentSource();if(!u)return;await u.locator.gotoLineIndex(u.view.currentLineIndex+1)}else{let u=e.view.currentLineIndex;await r.gotoLineIndex(u+1)}},"next node",{args:a,menus:s}),t.addNodeAction("expandablePrev",async({args:c})=>{await e.action.nodePrev(c[0],f=>!!f.expandable)},"previous expandable node",{args:a,menus:s}),t.addNodeAction("expandableNext",async({args:c})=>{await t.nodeNext(c[0],f=>!!f.expandable)},"next expandable node",{args:a,menus:s}),t.addNodeAction("indentPrev",async({node:c,args:f})=>{var d;let u=(d=c.level)!=null?d:0;await t.nodePrev(f[0],p=>p.level!==u)},"previous indent node",{args:a,menus:s}),t.addNodeAction("indentNext",async({node:c,args:f})=>{var d;let u=(d=c.level)!=null?d:0;await t.nodeNext(f[0],p=>p.level!==u)},"next indent node",{args:a,menus:s}),t.addNodeAction("gotoSource",async({args:c})=>{let f=e.sources.find(u=>u.sourceType===c[0]);f&&await f.locator.gotoLineIndex(0)},"go to source"),t.addNodeAction("sourceNext",async()=>{let c=e.sources[await e.view.currentSourceIndex()+1];c?await c.locator.gotoLineIndex(0):await Nt()&&await e.sources[0].locator.gotoLineIndex(0)},"go to next source"),t.addNodeAction("sourcePrev",async()=>{let c=e.sources[await e.view.currentSourceIndex()-1];c?await c.locator.gotoLineIndex(0):await Nt()&&await e.sources[e.sources.length-1].locator.gotoLineIndex(0)},"go to previous source"),t.addNodeAction("modifiedPrev",async()=>{await r.gotoPrevMark("modified")},"go to previous modified"),t.addNodeAction("modifiedNext",async()=>{await r.gotoNextMark("modified")},"go to next modified"),t.addNodeAction("diagnosticPrev",async()=>{await r.gotoPrevMark("diagnosticError","diagnosticWarning")},"go to previous diagnostic"),t.addNodeAction("diagnosticNext",async()=>{await r.gotoNextMark("diagnosticError","diagnosticWarning")},"go to next diagnostic"),t.addNodeAction("gitPrev",async()=>{await r.gotoPrevMark("git")},"go to previous git changed"),t.addNodeAction("gitNext",async()=>{await r.gotoNextMark("git")},"go to next git changed");let l={args:[{name:"mark name",description:"string"}],menus:{modified:"modified",diagnosticWarning:"diagnosticWarning",diagnosticError:"diagnosticError",git:"git"}};t.addNodeAction("markPrev",async({args:c})=>{await r.gotoPrevMark(...c)},"go to previous mark",l),t.addNodeAction("markNext",async({args:c})=>{await r.gotoNextMark(...c)},"go to next mark",l),t.addNodeAction("preview",async({source:c,node:f,args:u})=>{let d=u[0];if(!d)return;let p=c.view.getLineByNode(f);p!==void 0&&await e.floatingPreview.previewNode(d,c,f,p)},"preview",{args:[{name:"preview strategy",description:Ec.join(" | ")}],menus:{labeling:"preview for node labeling",content:"preview for node content"}}),t.addNodeAction("previewOnHover",async({args:c})=>{let f=c[0];if(!f)return;let u=c[1];if(!u){f==="disable"&&e.floatingPreview.unregisterOnHover();return}let d=c[2]?parseInt(c[2]):0;f==="toggle"?e.floatingPreview.toggleOnHover(u,d):f==="enable"?e.floatingPreview.registerOnHover(u,d):e.floatingPreview.unregisterOnHover()},"preview on hover",{args:[{name:"sub action",description:ww.join(" | ")},{name:"preview strategy",description:Ec.join(" | ")},{name:"delay",description:"delay millisecond"}],menus:{"toggle:labeling":"toggle labeling","toggle:labeling:200":"toggle labeling with debounce","toggle:content":"toggle content","enable:content":"enable with content","enable:labeling":"enable with labeling"}}),t.addNodeAction("textobj",async({node:c,args:f})=>{var p;let u=e.view.currentLineIndex,d=(p=f[0])!=null?p:"line";if(d==="line")await o.command("normal! V");else if(d==="indent"){let m=e.view.flattenedNodes,h=Yn(m,u,!1,x=>{var b,T;return((b=c.level)!=null?b:0)>((T=x.level)!=null?T:0)});if(h===void 0)return;let g=zn(m,u,!1,x=>{var b,T;return((b=c.level)!=null?b:0)>((T=x.level)!=null?T:0)});if(g===void 0)return;await o.command(`normal! ${h+2}GV${g}G`)}},"use visual mode selects",{args:[{name:"target",description:fw.join(" | ")},{name:"type",description:uw.join(" | ")}],menus:{"line:i":"line:i","line:a":"line:a","indent:i":"indent:i","indent:a":"indent:a"}}),t.addNodeAction("select",async({source:c,node:f})=>{c.selectedNodes.add(f),c.view.requestRenderNodes([f])},"select node",{select:"visual"}),t.addNodeAction("unselect",async({source:c,node:f})=>{c.selectedNodes.delete(f),c.view.requestRenderNodes([f])},"unselect node",{select:"visual"}),t.addNodeAction("toggleSelection",async({source:c,node:f})=>{c.selectedNodes.has(f)?await c.action.doAction("unselect",f):await c.action.doAction("select",f)},"toggle node selection",{select:"visual"}),t.addNodeAction("toggleHidden",async({source:c})=>{c.showHidden=!c.showHidden},"toggle visibility of hidden node",{reload:!0}),t.addNodeAction("refresh",async({source:c})=>{c.selectedNodes.clear(),await e.view.sync(async f=>{let u=await e.loadAllNotifier(f);o.pauseNotification(),c.highlight.clearHighlightsNotify(),u==null||u.notify(),await o.resumeNotification()})},"refresh"),t.addNodeAction("render",async({source:c,node:f})=>{await c.view.render({node:f})},"render"),t.addNodeAction("resize",async({args:c})=>{await(async()=>{if(e.isFloating){let[f]=c;if(!f)return;let[u,d]=f.split(/,|x/).map(h=>h.trim()),[p,m]=[u?parseInt(u):void 0,d?parseInt(d):void 0];await e.resize([p,m])}else{let[f]=c;if(!f)return;let u=parseInt(f);await e.resize([u])}})(),await e.render()},"resize",{args:[{name:"size",description:"widthxheight | width,height"}],menus:{path:{description:"resize the explorer window",args:"[size]",async actionArgs(){return[await Ke("input a the size:","20,10","file")]}}}}),t.addNodeAction("help",async({source:c})=>{await c.explorer.showHelp(c)},"show help"),t.addNodesAction("actionMenu",async({source:c,nodes:f})=>{await c.action.listActionMenu(f)},"show actions in coc-list",{select:"visual"}),t.addNodeAction("normal",async({args:c})=>{c[0]&&await o.command(`execute "normal ${c[0]}"`)},"execute vim normal mode commands",{args:[{name:"normal commands"}],menus:{zz:"execute normal zz"}}),t.addNodeAction("esc",async({source:c,mode:f})=>{c.explorer.isFloating&&f==="n"?await c.explorer.quit():(c.view.requestRenderNodes(Array.from(c.selectedNodes)),c.selectedNodes.clear())},"esc action"),t.addNodeAction("quit",async()=>{await e.quit()},"quit explorer")}var pe=require("coc.nvim"),Ow=_(Cw());var Iw=require("coc.nvim");var ti=class{constructor(e){this.win=e;this.bufnr=this.win.bufnr}static async create(e={}){let r=await Y.create({mode:"show",name:e.name});return new ti(r)}dispose(){this.win.dispose()}async open(e,r,o){this.closeTimer&&clearTimeout(this.closeTimer),await this.win.open({top:o.top,left:o.left,width:o.width,height:o.height,winHl:"CocExplorerNormalFloat",winHlNC:"CocExplorerNormalFloat",borderWinHl:"CocExplorerNormalFloatBorder",lines:e,highlights:r,focus:!1,initedExecute:({winid:i})=>{let n=[];return Iw.workspace.isNvim?(n.push(`
            let store_winid = win_getid(winnr())
            if store_winid != ${i}
              noau let successful = win_gotoid(${i})
              if !successful
                return
              endif
            endif
          `),n.push("set filetype="),o.focusLineIndex&&n.push(`call nvim_win_set_cursor(${o.focusLineIndex})`),!o.filetype&&o.filepath&&n.push(`execute 'doautocmd filetypedetect BufRead ' . fnameescape('${o.filepath}')`),o.filetype&&n.push(`set filetype=${o.filetype}`),n.push(`
            if store_winid != ${i}
              noau call win_gotoid(store_winid)
            endif
          `)):(n.push(`call win_execute(${i}, 'set filetype=')`),o.focusLineIndex&&n.push(`call win_execute(${i}, 'call cursor(${o.focusLineIndex}, 1)')`),!o.filetype&&o.filepath&&n.push(`call win_execute(${i}, 'doautocmd filetypedetect BufRead ' . fnameescape('${o.filepath}'))`),o.filetype&&n.push(`call win_execute(${i}, 'set filetype=${o.filetype}')`)),n.join(`
`)}})}async closeDelay(e){this.closeTimer&&clearTimeout(this.closeTimer),this.closeTimer=setTimeout(()=>{this.win.close().catch(v.error)},e)}async close(){await this.win.close()}};var ns=class{constructor(e){this.explorer=e;this.shown=!1;this.disposables=[];this.preferTop=!1;this.onHoverStrategy=!1;this.nvim=pe.workspace.nvim;this.onHoverDisposables=[];this.registeredPreviewActions={};this.maxHeight=e.config.get("previewAction.content.maxHeight"),this.registerActions(),this.disposables.push(e.events.on("first-open-post",()=>{this.disposables.push(Fe("BufWinLeave",async o=>{o===this.explorer.bufnr&&await this.close()}),Vr(async o=>{var i;o!==this.explorer.bufnr&&o!==((i=this.previewWindow)==null?void 0:i.bufnr)&&await this.closeDelay(200)},0),uc(async o=>{this.onHoverStrategy||o!==this.explorer.bufnr||await this.closeDelay(200)},0),pe.Disposable.create(()=>{(0,pe.disposeAll)(this.onHoverDisposables)}));let r=e.config.get("previewAction.onHover");!r||(Array.isArray(r)?this.registerOnHover(r[0],r[1]):this.registerOnHover(r))}))}dispose(){var e;(e=this.previewWindow)==null||e.dispose()}async getPreviewWindow(){return this.previewWindow||(this.previewWindow=await ti.create()),this.previewWindow}async closeDelay(e){var r;await((r=this.previewWindow)==null?void 0:r.closeDelay(e))}async close(){var e;await((e=this.previewWindow)==null?void 0:e.close())}toggleOnHover(e,r){this.onHoverStrategy===e?this.unregisterOnHover():this.registerOnHover(e,r)}registerOnHover(e,r=300){if(this.onHoverStrategy===e)return;this.onHoverStrategy=e,(0,pe.disposeAll)(this.onHoverDisposables),this.onHoverDisposables=[];let o=async i=>{if(this.explorer.view.isHelpUI){await this.close();return}if(i!==this.explorer.bufnr)return;await this.explorer.view.refreshLineIndex();let n=await this.explorer.view.currentSource();if(!n)return;let a=n.view.currentNode();if(!a)return;let s=n.view.getLineByNode(a);s!==void 0&&await this.previewNode(e,n,a,s)};this.onHoverDisposables.push(uc(o,r),Vr(o,r)),Xe().then(o).catch(v.error),pe.window.showMessage(`Preivew ${e} enabled`)}unregisterOnHover(){!this.onHoverStrategy||(this.onHoverStrategy=!1,(0,pe.disposeAll)(this.onHoverDisposables),this.onHoverDisposables=[],this.close().catch(v.error),pe.window.showMessage("Preview disabled "))}registerAction(e,r){this.registeredPreviewActions[e]=r}registerActions(){this.registerAction("labeling",async({source:e,node:r,nodeIndex:o})=>{var n;let i=await((n=e.view.sourcePainters)==null?void 0:n.drawNodeLabeling(r,o));if(!(!i||!await this.explorer.explorerManager.inExplorer()))return{lines:i.map(a=>a.content),highlights:ye(i.map((a,s)=>a.highlightPositions.map(l=>({hlGroup:l.group,line:s,colStart:l.start,colEnd:l.start+l.size})))),options:{filetype:"coc-explorer-labeling"}}}),this.registerAction("content",async({node:e})=>{if(e.expandable)return;let r;if(e.location)r=e.location;else if(e.fullpath)r=pe.Location.create(e.fullpath,pe.Range.create(0,0,0,0));else return;let{uri:o,range:i}=r;if(await(0,Ow.isBinaryFile)(o)){pe.window.showMessage("Preview content skip binary");return}let n=pe.workspace.getDocument(o);return{lines:n?n.getLines(0,i.end.line+this.maxHeight):await Sh(o,0,i.end.line+this.maxHeight),highlights:[],options:{filepath:o,focusLineIndex:i.start.line}}})}borderOptions(){return{border_enable:!1,border_chars:[],title:""}}getDimension(e,r,o){if(r===0||o===0)return{width:0,height:0};let i=[];for(let s of e)i.push(Jf(s.replace(/\t/g,"  ")));let n=Ii([Po(i),r]);if(n===void 0||n===0)return{width:0,height:0};let a=0;for(let s of i)a=a+Math.max(Math.ceil(s/n),1);return{width:n,height:Math.min(a,o)}}async getFloatOptions(e){let r=pe.workspace.env,o=r.columns,i=r.lines-r.cmdheight-1,n=this.explorer.argValues.position,a=n.name==="floating",s=await this.explorer.args.value(Ae.floatingPosition);if(!await this.explorer.win)return;let c=!1,u=await Xe()===this.explorer.bufnr?await this.nvim.call("winline"):1;u-=1;let d=a&&this.explorer.config.get("floating.border.enable")?await this.explorer.borderWin:await this.explorer.win;if(!d)return;let[p,m]=await this.nvim.call("win_screenpos",[d.id]);p-=1,m-=1;let h=await d.width,g=o-h-(a?0:1)-2,x=Ii([this.maxHeight,i]),{width:b,height:T}=this.getDimension(e,g,x);this.preferTop?(u>=x||u>=i-u)&&(c=!0):i-u<T&&u>T&&(c=!0);let I=p+(c?u-T+1:u),H;if(n.name==="left")H=m+h+2;else if(n.name==="right")H=m-b-2;else if(a&&s==="left-center")H=m+h+1;else if(a&&s==="right-center")H=m-b-1;else return;return S({top:I,left:H,width:b,height:T},this.borderOptions())}async previewNode(e,r,o,i){var l;if(!Gl())return;if(!this.registeredPreviewActions[e]){pe.window.showMessage(`coc-explorer no support preview strategy(${e})`);return}let n=await this.registeredPreviewActions[e]({source:r,node:o,nodeIndex:i});if(!n){await this.close();return}let a=await this.getPreviewWindow(),s=await this.getFloatOptions(n.lines);if(!s){await this.close();return}await a.open(n.lines,(l=n.highlights)!=null?l:[],S(S({},s),n.options))}};var ni=require("coc.nvim");var zr=require("coc.nvim");var Ic=class{constructor(){this.nvim=zr.workspace.nvim;this.highlights=[]}linkGroup(e,r){let o=`CocExplorer${e}`,i=[`highlight default link ${o} ${r}`],n={group:o,commands:i};return this.highlights.push(n),n}createGroup(e,r){let o=`CocExplorer${e}`,i=[`highlight default ${o} ${r}`],n={group:o,commands:i};return this.highlights.push(n),n}async watchColorScheme(e,r,o=!0){e.push(Xi.events.on("ColorScheme",r)),o&&await r()}clearHighlightsNotify(e,r,o,i){e.buffer.clearNamespace(-1,o,i)}addHighlightsNotify(e,r,o){for(let i of o)i.size!==0&&e.buffer.highlightRanges(-1,i.group,[zr.Range.create(zr.Position.create(i.lineIndex,i.start),zr.Position.create(i.lineIndex,i.start+i.size))])}bootHighlightSyntaxNotify(){let e=[];for(let r of this.highlights)this.nvim.command(`silent! syntax clear ${r.group}`,!0),e.push(...r.commands);this.nvim.call("coc_explorer#util#execute_commands",[e],!0)}},D=new Ic;function Pw(t){if(!t.length)return[];let e=t.sort((i,n)=>i.nodeIndex-n.nodeIndex),r=[],o;for(let i=0,n=e.length;i<n;i++){let a=e[i];o?o.nodeIndexEnd+1===a.nodeIndex?(o.drawnList.push(a),o.nodeIndexEnd=a.nodeIndex):(r.push(o),i--,o=void 0):o={nodeIndexStart:a.nodeIndex,nodeIndexEnd:a.nodeIndex,drawnList:[a]}}return o&&r.push(o),r}var Oc=t=>se(t.map(e=>e.type==="content"?e.content.length:e.type==="group"?se(e.contents.map(r=>r.type==="content"?r.content.length:0)):0))===0;async function Aw(t){async function e(r){return U(S({},r),{width:r.unicode&&!eu(r.content)?await Wh(r.content):r.content.length})}return ue(ye(await Promise.all(t.map(async r=>r.type==="content"?await e(r):r.type==="group"?U(S({},r),{contents:await Promise.all(ue(r.contents.map(o=>o.type==="content"?e(o):void 0)))}):r))))}function _w(t,e,r){let o=t/se(e),i=new Array(e.length);if(r){for(let n=0;n<e.length;n++)Math.ceil(e[n]*o)>r[n]&&(i[n]=r[n],t-=r[n],e[n]=0);o=t/se(e)}for(let n=0;n<e.length;n++)if(i[n]===void 0){let a=Math.ceil(e[n]*o);a<=t?(t-=a,i[n]=a):i[n]=t}return i}async function Mw(t){return t.map(e=>{var r;if(e.type==="group"&&((r=e.flexible)==null?void 0:r.padding)&&e.flexible.paddingVolume){let o=se(e.contents.map(i=>i.type==="content"?i.width:0));if(e.flexible.paddingVolume>o){let i=e.flexible.paddingVolume;if(e.flexible.padding==="left")return U(S({},e),{contents:[{type:"content",content:" ".repeat(i),width:i},...e.contents]});if(e.flexible.padding==="right")return U(S({},e),{contents:[...e.contents,{type:"content",content:" ".repeat(i),width:i}]});if(e.flexible.padding==="center"){let n=Math.ceil(i/2),a=i-n;return U(S({},e),{contents:[{type:"content",content:" ".repeat(n),width:n},...e.contents,{type:"content",content:" ".repeat(a),width:a}]})}else return e}else return e}else return e})}async function kw(t,e,r){let o=t-e,i=_w(o,r.map(n=>{var a,s;return n.type==="group"&&((a=n.flexible)==null?void 0:a.grow)?(s=n.flexible.growVolume)!=null?s:1:0}));return ue(ye(await Promise.all(r.map(async(n,a)=>{var s;if(n.type==="content")return n;if(n.type==="group"){if(!((s=n.flexible)!=null&&s.grow))return n.contents;let l=i[a];if(n.flexible.grow==="left")return[{type:"content",content:" ".repeat(l),width:l},...n.contents];if(n.flexible.grow==="right")return[...n.contents,{type:"content",content:" ".repeat(l),width:l}];if(n.flexible.grow==="center"){let c=Math.floor(l/2),f=l-c;return[{type:"content",content:" ".repeat(c),width:c},...n.contents,{type:"content",content:" ".repeat(f),width:f}]}else return n.contents}}))))}var as=D.linkGroup("OmitSymbol","SpecialComment");async function Rw(t,e,r){let o=e-t,i=_w(o,r.map(n=>{var a,s;return n.type==="group"&&((a=n.flexible)==null?void 0:a.omit)?(s=n.flexible.omitVolume)!=null?s:1:0}),r.map(n=>n.type==="content"?n.width:n.type==="group"?se(n.contents.map(a=>a.type==="content"?a.width:0)):0));return ue(ye(await Promise.all(r.map(async(n,a)=>{var s;if(n.type==="content")return n;if(n.type==="group"){if(!((s=n.flexible)!=null&&s.omit))return n.contents;let l=i[a],c=[];if(n.flexible.omit==="left"){let u=l+1;for(let d of n.contents){if(d.type!=="content"){c.push(d);continue}u<0?c.push(d):u<d.width&&(c.push({type:"content",content:"\u2025",width:1,group:as.group}),u>0&&c.push(U(S({},d),{content:await Wr(d.content,u),width:d.width-u}))),u-=d.width}return c}else if(n.flexible.omit==="right"){let f=l+1,d=se(n.contents.map(p=>p.type==="content"?p.width:0))-f;for(let p of n.contents){if(p.type!=="content"){c.push(p);continue}if(d>=p.width)c.push(p);else if(d<p.width){d>0&&c.push(U(S({},p),{content:await Wr(p.content,0,d),width:d})),c.push({type:"content",content:"\u2025",width:1,group:as.group});break}d-=p.width}return c}else if(n.flexible.omit==="center"){let f=se(n.contents.map(b=>b.type==="content"?b.width:0)),u=l+1,d=f-u,p=Math.floor(d/2),m=f-(d-p),h=0,g=0,x=[];for(let b of n.contents){if(b.type!=="content"){x.push(b);continue}if(g+=b.width,h<p)if(g<=p)x.push(b);else if(g<=m){let T=p-h;x.push(U(S({},b),{content:await Wr(b.content,0,T),width:T})),x.push({type:"content",content:"\u2025",width:1,group:as.group})}else{let T=p-h;x.push(U(S({},b),{content:await Wr(b.content,0,T),width:T})),x.push({type:"content",content:"\u2025",width:1,group:as.group});let I=g-m;x.push(U(S({},b),{content:await Wr(b.content,b.width-I),width:I}))}else if(g>m)if(h>=m)x.push(b);else{let T=g-m;x.push(U(S({},b),{content:await Wr(b.content,b.width-T),width:T}))}h=g}return x}}}))))}var ri=class{constructor(e){this.explorer=e}get width(){return this.explorer.contentWidth}async drawRow(e){let r=new Pc(this);return await e(r),r}},Pc=class{constructor(e){this.view=e;this.drawableList=[]}async draw({flexible:e=!0}={}){let r=await Mw(await Aw(this.drawableList)),o=[],i=this.view.width,n=se(r.map(c=>c.type==="content"?c.width:c.type==="group"?se(c.contents.map(f=>f.type==="content"?f.width:0)):0));!e||n===i?o=ye(r.map(c=>c.type==="group"?c.contents:c)):n<i?o=await kw(i,n,r):n>i&&(o=await Rw(i,n,r));let a=[],s="",l=0;for(let c of o){let f=c.content.length;c.group&&a.push({group:c.group,start:l,size:f}),s+=c.content,l+=f}return{content:s,highlightPositions:a}}add(e,{hl:r,width:o,drawGroup:i,unicode:n=!1}={}){let a=r?typeof r=="string"?r:r.group:void 0,s={type:"content",content:e,unicode:n,group:a,width:o};i?i.contents.push(s):this.drawableList.push(s)}async drawBlockToList(e){let r=this.drawableList;this.drawableList=[],await e(this);let o=this.drawableList;return this.drawableList=r,o}async flexible(e,r){let o=await this.drawBlockToList(r);this.drawableList.push(this.flexibleForList(e,o))}flexibleForList(e,r){return{type:"group",contents:ye(r.map(o=>o.type==="content"?o:o.type==="group"?o.contents:o)),flexible:e}}async addColumn(e,r,o,i=!1){this.drawableList.push(...await this.columnToList(e,r,o,i))}async columnToList(e,r,o,i=!1){return await this.drawBlockToList(async()=>{var n;if(typeof o=="number"){this.add(" ".repeat(o));return}await((n=o.drawHandle)==null?void 0:n.drawNode(this,{node:e,nodeIndex:r,isLabeling:i}))})}async addTemplatePart(e,r,o,i=!1){if(typeof o=="string"){this.add(o);return}let n=[],a=o.column;n.push(...await this.columnToList(e,r,a,i));let s={},l=c=>typeof c=="number"?c:1;if(o.modifiers)for(let c of o.modifiers)c.name==="|"?Oc(n)&&n.push(...await this.columnToList(e,r,c.column,i)):c.name==="&"?Oc(n)||n.push(...await this.columnToList(e,r,c.column,i)):c.name==="growLeft"?(s.grow="left",s.growVolume=l(c.column)):c.name==="growCenter"?(s.grow="center",s.growVolume=l(c.column)):c.name==="growRight"?(s.grow="right",s.growVolume=l(c.column)):c.name==="omitLeft"?(s.omit="left",s.omitVolume=l(c.column)):c.name==="omitCenter"?(s.omit="center",s.omitVolume=l(c.column)):c.name==="omitRight"&&(s.omit="right",s.omitVolume=l(c.column));s.omit||s.grow?this.drawableList.push(this.flexibleForList(s,n)):this.drawableList.push(...n)}};var ii=require("coc.nvim");var oi={};async function Lw(t,e){let r=[...await et.getCommonKeys()],o=[["n",r],["v",[...r,...await et.getVisualKeys()]]];for(let[i,n]of o){oi[i]={};for(let a of n){if(oi[i][a]||i==="v"&&["o","j","k"].includes(a))continue;let s=`explorer-key-${i}-${a.replace(/<(.*)>/,"[$1]")}`;t.subscriptions.push(ii.workspace.registerKeymap([i],s,async()=>{let l=await ii.workspace.nvim.eval("v:count"),c=await e.currentExplorer();c==null||c.action.doActionByKey(a,i,l||1).catch(v.error)})),oi[i][a]=`<Plug>(coc-${s})`}}await ii.workspace.nvim.call("coc_explorer#mappings#register",[oi])}async function Dw(){await ii.workspace.nvim.call("coc_explorer#mappings#execute",[oi])}async function Bw(){await ii.workspace.nvim.call("coc_explorer#mappings#clear",[oi])}var tt=D.linkGroup.bind(D),J={line:tt("HelpLine","Operator"),hint:tt("HelpHint","Comment"),title:tt("HelpTitle","Boolean"),subtitle:tt("HelpSubTitle","Label"),mappingKey:tt("HelpMappingKey","PreProc"),action:tt("HelpAction","Identifier"),column:tt("HelpColumn","Identifier"),arg:tt("HelpArg","Identifier"),description:tt("HelpDescription","Comment"),type:tt("HelperType","Type"),conditional:tt("HelpConditional","Conditional")},xO="coc-explorer-help",Ac=class{constructor(e,r,o){this.explorer=e;this.source=r;this.width=o;this.drawnResults=[];this.painter=new ri(e),this.registeredActions=this.source.action.registeredActions()}async drawRow(e){let r=await this.painter.drawRow(e);this.drawnResults.push(await r.draw())}async drawHr(){await this.drawRow(e=>{e.add("\u2014".repeat(this.width),{hl:J.line})})}async drawHead(){await this.drawRow(e=>{e.add("Help "),e.add("(use q, ? or <esc> return to explorer)",{hl:J.hint})}),await this.drawHr()}drawActionForMapping(e,r){e.add(r.name,{hl:J.action}),r.args&&e.add(`(${r.args.join(",")})`,{hl:J.arg}),e.add(" ");let o=this.registeredActions.get(r.name);o&&e.add(o.description,{hl:J.description})}anyAction(e,r){return Array.isArray(e)?e.some(o=>this.anyAction(o,r)):r(e)}drawMappingsPrefix(e,r,o){if(!o.isFirstLine){r.add(e);return}o.isFirstLine=!1,o.key&&(r.add(" "),r.add(o.key,{hl:J.mappingKey}),r.add(" - ")),o.isWait&&r.add(`${Ur.helpDescription} `,{hl:J.type})}async drawMappingsAction(e,r,o){await this.drawRow(i=>{if(this.drawMappingsPrefix(e,i,o),r.name===ir.name){i.add(ir.helpDescription,{hl:J.type});return}i.add(r.name,{hl:J.action}),r.args&&i.add(`(${r.args.join(",")})`,{hl:J.arg}),i.add(" ");let n=this.registeredActions.get(r.name);n&&i.add(n.description,{hl:J.description})})}async drawMappingsActionExp(e,r,o){if(Array.isArray(r))for(let i=0;i<r.length;i++){let n=r[i];if(Array.isArray(n)){await this.drawMappingsActionExp(e,n,o);continue}if(n.name===Ur.name){o.isFirstLine&&(o.isWait=!0);continue}let a=zo[n.name];if(a){await this.drawRow(c=>{this.drawMappingsPrefix(e,c,o),c.add(`if ${a.getHelpDescription(n.args)}`,{hl:J.conditional})});let[s,l]=[r[i+1],r[i+2]];await this.drawMappingsActionExp(`${e}  `,s,o),await this.drawRow(c=>{c.add(e),c.add("else",{hl:J.conditional})}),await this.drawMappingsActionExp(`${e}  `,l,o),i+=2;continue}await this.drawMappingsAction(e,n,o)}else await this.drawMappingsAction(e,r,o)}async drawMappings(){await this.drawRow(o=>{o.add(`Mappings for source(${this.source.sourceType})`,{hl:J.title})});let e=async o=>{for(let[i,n]of Object.entries(o))!this.anyAction(n,a=>this.registeredActions.has(a.name)||a.name===ir.name)||await this.drawMappingsActionExp(" ".repeat(i.length+4),n,{key:i,isFirstLine:!0,isWait:!1})},r=await et.getMappings(this.source.sourceType);await e(r.all),await e(r.vmap)}async drawActions(){await this.drawRow(e=>{e.add(`Actions for source(${this.source.sourceType})`,{hl:J.title})});for(let[e,r]of this.registeredActions){if(await this.drawRow(o=>{o.add(" "),o.add(e,{hl:J.action}),o.add(" "),o.add(r.description,{hl:J.description})}),r.options.args){await this.drawRow(o=>{o.add("   "),o.add("args:",{hl:J.subtitle})});for(let o of r.options.args)await this.drawRow(i=>{i.add("     - "),i.add(o.name,{hl:J.arg}),o.description&&(i.add(" "),i.add(o.description,{hl:J.description}))})}if(r.options.menus){await this.drawRow(o=>{o.add("   "),o.add("menus:",{hl:J.subtitle})});for(let o of Mt.getNormalizeMenus(r.options.menus))await this.drawRow(i=>{i.add("     - "),i.add(`${e}:${o.args}`,{hl:J.action}),i.add(" "),i.add(o.description,{hl:J.description})})}}}async drawColumns(){await this.drawRow(r=>{r.add(`Columns for source(${this.source.sourceType})`,{hl:J.title})});let e=this.source.view.sourcePainters.columnRegistrar.registeredColumns;for(let[r,o]of e){await this.drawRow(i=>{i.add(`  Type: ${r}`,{hl:J.subtitle})});for(let[i]of o)await this.drawRow(n=>{n.add("   - "),n.add(i,{hl:J.column})})}}async render(){ni.workspace.nvim.pauseNotification(),this.explorer.setLinesNotifier(this.drawnResults.map(r=>r.content),0,-1).notify();let e=[];for(let[r,o]of this.drawnResults.entries())o.highlightPositions&&e.push(...o.highlightPositions.map(i=>S({lineIndex:r},i)));this.explorer.highlight.addHighlightsNotify(xO,e),await ni.workspace.nvim.resumeNotification()}};async function Ww(t,e){var a,s;t.view.isHelpUI=!0;let r=await t.view.currentNode(),o=(s=await((a=await t.win)==null?void 0:a.width))!=null?s:80,i=new Ac(t,e,o);await i.drawHead(),await i.drawMappings(),await i.drawHr(),await i.drawActions(),await i.drawHr(),await i.drawColumns(),await i.render(),await Bw();let n=[];["<esc>","q","?"].forEach(l=>{n.push(ni.workspace.registerLocalKeymap("n",l,async()=>{(0,ni.disposeAll)(n),await _c(t),await t.view.sync(async c=>{await E.runAll([await c.renderAllNotifier(),await e.locator.gotoNodeNotifier(r)])})},!0))})}async function _c(t){await Dw(),t.view.isHelpUI=!1}var ai=require("coc.nvim");var ss=class{constructor(e){this.explorer=e}clearHighlightsNotify(e,r,o){D.clearHighlightsNotify(this.explorer,e,r,o)}addHighlightsNotify(e,r){D.addHighlightsNotify(this.explorer,e,r)}async bootSyntax(){let e=await this.explorer.winnr,r=await ai.workspace.nvim.call("winnr");e&&(ai.workspace.nvim.pauseNotification(),e!==r&&ai.workspace.nvim.command(`${e}wincmd w`,!0),D.bootHighlightSyntaxNotify(),e!==r&&ai.workspace.nvim.command(`${r}wincmd w`,!0),await ai.workspace.nvim.resumeNotification())}};var cs=require("coc.nvim");var ls=class{constructor(e){this.explorer=e;this.marksGroupByType=new Map}add(e,r){this.marksGroupByType.has(e)||this.marksGroupByType.set(e,new Set),this.marksGroupByType.get(e).add(r)}remove(e,r){this.marksGroupByType.has(e)||this.marksGroupByType.set(e,new Set),this.marksGroupByType.get(e).delete(r)}removeAll(){this.marksGroupByType.clear()}removeLines(e,r=1/0){if(Array.isArray(e))this.marksGroupByType.forEach(o=>{e.forEach(i=>{o.delete(i)})});else{let o=e;this.marksGroupByType.forEach(i=>{i.forEach(n=>{o<=n&&n<=r&&i.delete(n)})})}}offsetLines(e,r,o=1/0){e!==0&&this.marksGroupByType.forEach((i,n)=>{let a=new Set;i.forEach(s=>{a.add(r<=s&&s<=o?s+e:s)}),this.marksGroupByType.set(n,a)})}async prevLineIndex(...e){let r=[];for(let o of e){let i=this.marksGroupByType.get(o);r=r.concat(i?Array.from(i):[])}if(r.length){let o=this.explorer.view.currentLineIndex,i=r.sort((a,s)=>s-a),n=i.find(a=>a<o);if(n)return n;if(await Nt())return i[0]}}async nextLineIndex(...e){let r=[];for(let o of e){let i=this.marksGroupByType.get(o);r=r.concat(i?Array.from(i):[])}if(r.length){let o=this.explorer.view.currentLineIndex,i=r.sort((a,s)=>a-s),n=i.find(a=>a>o);if(n)return n;if(await Nt())return i[0]}}};var fs=class{constructor(e){this.explorer=e;this.mark=new ls(this.explorer),this.view=this.explorer.view}async gotoPrevMark(...e){let r=await this.mark.prevLineIndex(...e);return r?(await this.gotoLineIndex(r),!0):!1}async gotoNextMark(...e){let r=await this.mark.nextLineIndex(...e);return r?(await this.gotoLineIndex(r),!0):!1}async gotoLineIndex(e){return(await this.gotoLineIndexNotifier(e)).run()}async gotoLineIndexNotifier(e,r){let o=await this.explorer.win;return E.create(()=>{if(o){let i=this.explorer.height;e<0?e=0:e>=i&&(e=i-1),this.view.currentLineIndex=e,o.setCursor([e+1,r!=null?r:0],!0),cs.workspace.isVim?cs.workspace.nvim.command("redraw",!0):cs.workspace.nvim.command("redraw!",!0)}})}};var jw=require("coc.nvim");var Fw=require("coc.nvim");async function us(t){let e=await Fw.workspace.nvim.call("coc_explorer#highlight#extract_colors",[t]);return Object.entries(e).map(([r,o])=>{let i={};return o.ctermfg&&(i.ctermfg=parseInt(o.ctermfg,10)),o.ctermbg&&(i.ctermbg=parseInt(o.ctermbg,10)),o.guifg&&(i.guifg=Gi(o.guifg)),o.guibg&&(i.guibg=Gi(o.guibg)),[r,i]}).reduce((r,[o,i])=>(r[o]=i,r),{})}var Mc={Error:"ErrorColor",Comment:"CommentColor",Normal:"NormalColor",CocErrorSign:"CocErrorSignColor",CocWarningSign:"CocWarningSignColor"},Hw=t=>{D.watchColorScheme(t,async()=>{let e=Object.keys(Mc),r=await us(e),{nvim:o}=jw.workspace;o.pauseNotification();for(let i of e){let n=r[i],a=Bh(`CocExplorer${Mc[i]}_Internal`,n);!a||o.command(a,!0)}await o.resumeNotification()}).catch(v.error)},Ee={};Object.values(Mc).forEach(t=>{Ee[t]=`CocExplorer${t}_Internal`});var St=require("coc.nvim");var $w=_(hc());var ds=class{constructor(e,r){this.s=e;this.i=r}ch(){return this.s[this.i]}skip(e){this.i+=e}next(){this.i+=1}forwardString(e){return this.s.slice(this.i,this.i+e)}match(e,r={}){var o;return this.forwardString(e.length)===e?((o=r.skip)!=null&&o&&this.skip(e.length),!0):!1}end(){return this.i>=this.s.length}},en=class extends Error{constructor(r,o){super(o);this.source=r}};function kc(t,e,r){let o="";for(;!e.end();){let i=e.ch();if(!r.includes(i))o+=i,e.next();else return o}throw new en(e,`Unexpected end when parse ${t}`)}function bO(t){return kc("modifier name",t,[" "])}function yO(t){return kc("modifier value",t,[" ","]"])}function vO(t){let e=bO(t);t.next();let r=yO(t);return{name:e,column:r}}function EO(t){let e=[];do{let r=t.ch();if(r===" ")t.next(),e.push(vO(t));else if(r==="]")return e}while(!0)}function NO(t){return kc("column name",t,[" ","]"])}function TO(t){t.next();let e={column:NO(t)};do{let r=t.ch();if(r==="]")return t.next(),e;r===" "&&(e.modifiers=EO(t))}while(!t.end());throw new en(t,"Unexpected end when parse column block")}function SO(t){let e="";for(;!t.end();){let r=t.ch();if(r==="\\")t.next(),e+=t.ch();else{if(r==="[")return e;e+=r}t.next()}return e}function Rc(t){let e=new ds(t,0),r=[];for(;!e.end();)e.ch()==="["?r.push(TO(e)):r.push(SO(e));return r}var CO=D.linkGroup("Label","Label"),Lc=class{constructor(e,r,o,i){this.type=e;this.painters=r;this.source=o;this.columnRegistrar=i;this.columns=new Set;this.parts=[];this.labelingParts=[]}dispose(){this.clearParts(this.parts)}clearColumn(e){typeof e!="number"&&e.subscriptions.map(r=>r.dispose())}clearParts(e){e.forEach(r=>{var o;typeof r!="string"&&(this.clearColumn(r.column),(o=r.modifiers)==null||o.forEach(i=>this.clearColumn(i.column)))})}async parseTemplate(e,r){let o=!1;if(this.templateStr!==e){this.templateStr=e;let i=[];for(let n of Rc(e)){let a=await this.initPart(n);a&&i.push(a)}this.clearParts(this.parts),this.parts=i,o=!0}if(r&&this.labelingTemplateStr!==r){this.labelingTemplateStr=r;let i=[];for(let n of Rc(r)){let a=await this.initPart(n);a&&i.push(a)}this.clearParts(this.labelingParts),this.labelingParts=i,o=!0}if(o){let i=new Set,n=[...this.parts,...this.labelingParts];for(let a of n)if(typeof a!="string"&&(typeof a.column!="number"&&i.add(a.column),a.modifiers))for(let s of a.modifiers)typeof s.column!="number"&&i.add(s.column);this.columns=i}}async initPart(e){if(typeof e=="string")return e;let r=await this.columnRegistrar.initColumn(this.type,this.source,e.column);if(!r)return;let o={column:r};if(e.modifiers){let i=await Promise.all(e.modifiers.map(async n=>{let a=await this.columnRegistrar.initColumn(this.type,this.source,n.column);if(!!a)return{name:n.name,column:a}}));o.modifiers=ue(i)}return o}},ps=class{constructor(e,r){this.source=e;this.columnRegistrar=r;this.painters=new Map;this.viewPainter=new ri(this.source.explorer)}dispose(){this.painters.forEach(e=>e.dispose())}getPainter(e){return this.painters.has(e)||this.painters.set(e,new Lc(e,this,this.source,this.columnRegistrar)),this.painters.get(e)}async parseTemplate(e,r,o){return await this.getPainter(e).parseTemplate(r,o)}async load(e){for(let r of this.painters.values())for(let o of r.columns)await(o.load&&o.load(e))}async drawPre(e,{draw:r,drawAll:o,abort:i,force:n=!1}={}){class a extends Error{}class s extends Error{}let l=Gn(e,f=>f.type),c=Object.keys(l);for(let f of c){let u=this.getPainter(f);for(let d of u.columns)try{d.drawHandle=await d.draw(l[f],{drawAll(){if(o)throw new a},abort(){throw new s},force:n})}catch(p){if(p instanceof a)return o();if(p instanceof s){if(i)return i()}else throw p}}return r==null?void 0:r()}async drawNode(e,r,{isLabeling:o=!1}={}){let n=await(await this.viewPainter.drawRow(async a=>{for(let s of this.getPainter(e.type).parts)await a.addTemplatePart(e,r,s,o)})).draw();return{nodeIndex:r,nodeUid:e.uid,content:n.content,highlightPositions:n.highlightPositions}}async drawNodeLabeling(e,r){var i,n;let o=[];for(let a of this.getPainter(e.type).labelingParts){if(typeof a=="string"){o.push({content:a,highlightPositions:[]});continue}let s=[a.column,...(n=(i=a.modifiers)==null?void 0:i.map(m=>m.name==="&"?m.column:""))!=null?n:[]].filter(m=>typeof m!="string"),l=await(0,$w.default)(s,async m=>{var h;return!((h=m.drawHandle)!=null&&h.labelVisible)||await m.drawHandle.labelVisible({node:e,nodeIndex:r})});if(!l.length)continue;let c=l.every(m=>{var h;return(h=m.drawHandle)==null?void 0:h.labelOnly}),f=l.filter(async m=>{var h;return!((h=m.drawHandle)!=null&&h.labelOnly)}),u=await this.viewPainter.drawRow(async m=>{m.add(l.map(h=>h.label).join(" & ")+(c?"":":"),{hl:CO}),m.add(" ");for(let h of f)await m.addColumn(e,r,h,!0)}),{highlightPositions:d,content:p}=await u.draw({flexible:!1});o.push({content:p,highlightPositions:d})}return o}};var Gw=require("coc.nvim");var tn=require("coc.nvim");var Kr=Symbol("rendererSource"),ms=class{constructor(e,r=e.explorer,o=e.source){this.view=e;this.explorer=r;this.source=o;this.requestedRenderNodes=new Set}nodeAndChildrenRange(e){var n,a;let r=this.view.flattenedNodes.findIndex(s=>s.uid===e.uid);if(r===-1)return;let o=(n=e.level)!=null?n:0,i=this.view.flattenedNodes.length-1;for(let s=r+1,l=this.view.flattenedNodes.length;s<l;s++)if(((a=this.view.flattenedNodes[s].level)!=null?a:0)<=o){i=s-1;break}return{startIndex:r,endIndex:i}}async drawNodes(e){let r=ue(await Promise.all(e.map(async i=>{let n=this.view.flattenedNodes.findIndex(s=>s.uid===i.uid);if(n<0)return;let a=this.view.flattenedNodes[n];if(!!a)return this.view.sourcePainters.drawNode(a,n)}))),o=this.view.startLineIndex;return{drawnList:r,get contents(){return r.map(i=>i.content)},get highlightPositions(){return ye(r.map(i=>i.highlightPositions.map(n=>S({lineIndex:o+i.nodeIndex},n))))}}}async emitRequestRenderNodesNotifier(){if(this.requestedRenderNodes.size<=0)return;let e=Array.from(this.requestedRenderNodes);return this.requestedRenderNodes.clear(),this.renderNodesNotifier(e)}async renderPathsNotifier(e){if(this.view.isHelpUI)return E.noop();let r=e instanceof Set?Array.from(e):e;if(!r.length)return E.noop();let o=n=>this.view.flattenedNodes.filter(a=>a.fullpath&&n.includes(a.fullpath)),i=r.map(n=>typeof n=="string"?{nodes:o([n])}:{nodes:o([...n.paths]),withParents:n.withParents,withChildren:n.withChildren});return this.renderNodesNotifier(i)}async renderNodesNotifier(e){let o=(e instanceof Set?Array.from(e):e).map(n=>{var a,s;return"uid"in n?{nodes:[n],withParents:!1,withChildren:!1}:{nodes:[...n.nodes],withParents:(a=n.withParents)!=null?a:!1,withChildren:(s=n.withChildren)!=null?s:!1}}),i=[];for(let n of o){if(i.push(...n.nodes),n.withParents)for(let a of n.nodes)i.push(...this.view.flattenParents(a));if(n.withChildren)for(let a of n.nodes)i.push(...this.view.flattenNode(a))}return i.length?await this.view.sourcePainters.drawPre(i,{draw:async()=>{let{drawnList:n,highlightPositions:a}=await this.drawNodes(i),s=Pw(n);return await this.source.events.fire("drawn"),E.create(()=>{s.forEach(l=>{this.view.setLinesNotifier(l.drawnList.map(c=>c.content),l.nodeIndexStart,l.nodeIndexEnd+1).notify()}),this.source.highlight.addHighlightsNotify(a),tn.workspace.isVim&&tn.workspace.nvim.command("redraw",!0)})},drawAll:()=>this.renderNotifier(),abort:()=>E.noop()}):E.noop()}async renderNotifier({node:e=this.view.rootNode,force:r=!1}={}){if(this.view.isHelpUI)return E.noop();let o=this.nodeAndChildrenRange(e);if(!o&&!e.isRoot)return E.noop();let{startIndex:i,endIndex:n}=o||{startIndex:0,endIndex:this.view.flattenedNodes.length-1},a=n-i+1,s=this.view.flattenNode(e),l=s.length;this.view.flattenedNodes=this.view.flattenedNodes.slice(0,i).concat(s).concat(this.view.flattenedNodes.slice(n+1)),l<a&&this.explorer.locator.mark.removeLines(this.view.startLineIndex+l+1,this.view.startLineIndex+a+1),this.source.locator.mark.offsetAfterLine(l-a,this.view.endLineIndex),await this.view.sourcePainters.drawPre(s,{force:r});let{contents:c,highlightPositions:f}=await this.drawNodes(s);await this.source.events.fire("drawn");let u=this.view.currentSourceIndex(),d=this.explorer.sources.length-1===u;return E.create(()=>{this.explorer.setLinesNotifier(c,this.view.startLineIndex+i,d&&e.isRoot?-1:this.view.startLineIndex+i+a).notify(),this.source.highlight.addHighlightsNotify(f),tn.workspace.isVim&&tn.workspace.nvim.command("redraw",!0)})}};var si=Symbol("rendererExplorer"),hs=class{constructor(e,r=e.explorer){this.view=e;this.explorer=r;this.renderMutex=new Gw.Mutex}async runQueue(e){let r=await this.renderMutex.acquire();setTimeout(()=>{r&&(r(),r=void 0,v.error("view.sync timeout, force render, view.sync may cause deadlock due to recursive calls"))},5e3);try{return await e()}finally{r(),r=void 0}}rendererSources(){return this.explorer.sources.map(e=>e.view[Kr])}async renderAllNotifier(){let e=await Promise.all(this.rendererSources().map(r=>r.renderNotifier({force:!0})));return E.combine(e)}};var gs=class{constructor(e){this.viewSource=e;this.internal=(()=>{let e={records:new Map,store(r){return e.records.has(r.uid)||e.records.set(r.uid,{expanded:!1,compact:"uncompact"}),e.records.get(r.uid)},clear(){e.records.clear()},get(r,o){return e.store(r)[o]},set(r,o,i){e.store(r)[o]=i}};return e})();let r=e.source.context,o=e.config.get("expandStores");typeof o=="boolean"?this.enabled=o:"includes"in o?this.enabled=o.includes.includes(this.viewSource.source.sourceType):"excludes"in o?this.enabled=!o.excludes.includes(this.viewSource.source.sourceType):this.enabled=!0,r.subscriptions.push(e.source.explorer.events.on("open-pre",()=>{this.enabled||this.internal.clear()}))}setExpanded(e,r){r?this.expand(e):this.collapse(e)}expand(e){this.internal.set(e,"expanded",!0)}collapse(e){this.internal.set(e,"expanded",!1)}isExpanded(e){return this.internal.get(e,"expanded")}setCompact(e,r){this.internal.set(e,"compact",r)}getCompact(e){return this.internal.get(e,"compact")}};var lr=class{constructor(e,r,o){this.source=e;this.columnRegistrar=r;this.rootNode=o;this.flattenedNodes=[];this.startLineIndex=0;this.endLineIndex=0;this.rootExpandedForOpen=!1;this.explorer=this.source.explorer,this.nodeStores=new gs(this),this.sourcePainters=new ps(this.source,this.columnRegistrar),this[Kr]=new ms(this)}get isHelpUI(){return this.explorer.view.isHelpUI}get config(){return this.source.config}async sync(e){return await this.explorer.view[si].runQueue(()=>e(this[Kr]))}requestRenderNodes(e){for(let r of e)this[Kr].requestedRenderNodes.add(r)}dispose(){this.sourcePainters.dispose()}bootInit(e){this.rootExpandedForOpen=e}bootOpen(){this.nodeStores.setExpanded(this.rootNode,this.rootExpandedForOpen)}async load(e){await this.sourcePainters.load(e)}async parseTemplate(e,r,o){return await this.sourcePainters.parseTemplate(e,r,o)}get currentLineIndex(){return this.explorer.view.currentLineIndex-this.startLineIndex}currentNode(){return this.flattenedNodes[this.currentLineIndex]}currentSourceIndex(){let e=this.explorer.sources.indexOf(this.source);return e===-1?void 0:e}getNodeByLine(e){return this.flattenedNodes[e]}getLineByNode(e){if(e){let r=this.flattenedNodes.findIndex(o=>o.uid===e.uid);return r===-1?void 0:r}else return 0}setLinesNotifier(e,r,o){return this.explorer.setLinesNotifier(e,this.startLineIndex+r,this.startLineIndex+o)}replaceNodeInSibling(e,r){var o;if((o=e.parent)!=null&&o.children){let i=e.parent.children.indexOf(e);i!==-1&&(e.parent.children.splice(i,1,r),r.level=e.level,r.parent=e.parent,r.prevSiblingNode=e.prevSiblingNode,r.nextSiblingNode=e.nextSiblingNode)}}flattenParents(e){let r=e,o=[];for(;r.parent;)o.push(r.parent),r=r.parent;return o}flattenNode(e){var i,n,a;let r=[],o=[e];for(;o.length;){let s=o.shift();if(!s.isRoot){let l=this.nodeStores.getCompact(s);if(l==="compact"){if(!s.compactedNodes&&((i=s.children)==null?void 0:i.length)===1&&s.children[0].expandable){let c=s.children[0],f=[s,c];for(;((n=c.children)==null?void 0:n.length)===1&&c.children[0].expandable;)this.nodeStores.setCompact(c,"compact"),c=c.children[0],f.push(c);this.nodeStores.setCompact(c,"compact");let u=zs(c);u.name=f.map(d=>d.name).join("/"),u.compactedNodes=f,u.compactedLastNode=c,this.replaceNodeInSibling(s,u),s=u}}else if(l==="uncompact"&&s.compactedNodes){let c=s.compactedNodes[0];for(let f of s.compactedNodes)this.nodeStores.setCompact(f,"uncompact");this.replaceNodeInSibling(s,c),s=c}}if(r.push(s),s.children)for(let l=s.children.length-1;l>=0;l--)s.children[l].parent=s,s.children[l].level=((a=s.level)!=null?a:0)+1,o.unshift(s.children[l])}return r}isExpanded(e){return this.nodeStores.isExpanded(e)}async expandRender(e){this.isHelpUI||!this.isExpanded(e)||!e.children||await this.sync(async r=>{let o=r.nodeAndChildrenRange(e);if(!o)return;let{startIndex:i,endIndex:n}=o,a=this.flattenNode(e);await this.sourcePainters.drawPre(a,{draw:async()=>{this.flattenedNodes=this.flattenedNodes.slice(0,i).concat(a).concat(this.flattenedNodes.slice(n+1)),this.source.locator.mark.offsetAfterLine(a.length-1-(n-i),i);let{contents:s,highlightPositions:l}=await r.drawNodes(a);await this.source.events.fire("drawn"),St.workspace.nvim.pauseNotification(),this.setLinesNotifier(s,i,n+1).notify(),this.source.highlight.addHighlightsNotify(l),St.workspace.isVim&&St.workspace.nvim.command("redraw",!0),await St.workspace.nvim.resumeNotification()},drawAll:async()=>(await r.renderNotifier()).run()})})}async expandRecursive(e,r){var s,l,c,f;let o=this.config.get("autoExpandOptions"),i=(s=r.compact)!=null?s:o.includes("compact"),n=(l=r.uncompact)!=null?l:o.includes("uncompact"),a=(c=r.recursiveSingle)!=null?c:o.includes("recursiveSingle")||i;if(e.expandable){let u=(f=r.depth)!=null?f:1,d=this.isExpanded(e);if(this.nodeStores.expand(e),e.children||(e.children=await this.source.loadInitedChildren(e,{recursiveExpanded:!0})),u>this.config.get("autoExpandMaxDepth"))return;let p=e.children.length===1&&e.children[0].expandable,m=this.nodeStores.getCompact(e);m==="uncompact"?p&&i&&this.nodeStores.setCompact(e,"compact"):m==="compact"&&(d&&n?this.nodeStores.setCompact(e,"uncompact"):this.nodeStores.setCompact(e,"compact")),(r.recursive||p&&a)&&await Promise.all(e.children.map(async h=>{await this.expandRecursive(h,U(S({},r),{depth:u+1}))}))}}async expand(e,r={}){var o;await this.expandRecursive(e,r),((o=r.render)==null||o)&&await this.expandRender(e)}async collapseRender(e){this.isHelpUI||this.isExpanded(e)||await this.sync(async r=>{let o=r.nodeAndChildrenRange(e);!o||await this.sourcePainters.drawPre([e],{draw:async()=>{let{startIndex:i,endIndex:n}=o;this.flattenedNodes.splice(i+1,n-i),this.explorer.locator.mark.removeLines(this.startLineIndex+i+1,this.startLineIndex+n),this.source.locator.mark.offsetAfterLine(-(n-i),n);let a=await this.source.locator.gotoLineIndexNotifier(i,0),{contents:s,highlightPositions:l}=await r.drawNodes([e]);await this.source.events.fire("drawn"),St.workspace.nvim.pauseNotification(),this.setLinesNotifier(s,i,n+1).notify(),this.source.highlight.addHighlightsNotify(l),a.notify(),St.workspace.isVim&&St.workspace.nvim.command("redraw",!0),await St.workspace.nvim.resumeNotification()},drawAll:async()=>(await r.renderNotifier()).run()})})}async collapseRecursive(e,r){if(e.expandable){this.nodeStores.collapse(e);let o=e.children;if(!o)return;if(e.children=void 0,r||this.config.get("autoCollapseOptions").includes("recursive"))for(let i of o)await this.collapseRecursive(i,r)}}async collapse(e,{recursive:r=!1}={}){await this.collapseRecursive(e,r),await this.collapseRender(e)}async renderNodes(e){return await this.sync(async r=>{await(await r.renderNodesNotifier(e)).run()})}async renderPaths(e){await this.sync(async r=>{await(await r.renderPathsNotifier(e)).run()})}async render(e){await this.sync(async r=>{var o;await((o=await r.renderNotifier(e))==null?void 0:o.run())})}};Kr;var Dc=require("coc.nvim");var ws=class extends Jo{constructor(r,o){super(r);this.owner=r;this.source=this.owner;this.global=o}registeredActions(){return new Map([...this.global.actions,...this.actions])}registeredAction(r){return this.actions.get(r)||this.global.actions.get(r)}async doActionExp(r,o,i={}){var f,u;let n=(f=i.mode)!=null?f:"n",a=(u=i.isSubAction)!=null?u:!1,s,l=o,c={mode:n,isSubAction:!0};try{if(Array.isArray(r))for(let d=0;d<r.length;d++){d!==0&&(l=[this.source.view.currentNode()]);let p=r[d];if(Array.isArray(p)){await this.doActionExp(p,l,c);continue}if(p.name===Ur.name){let h=this.source.config.get("mapping.action.wait.timeout");if(h===0||s||a)continue;s=await this.global.waitActionMutex.acquire(),setTimeout(()=>{s&&(v.warn(`action(${JSON.stringify(r)}) timeout`),s(),s=void 0)},h);continue}let m=zo[p.name];if(m){let[h,g]=Ao(l,T=>m.filter(this.source,T,p.args)),[x,b]=[r[d+1],r[d+2]];d+=2,h.length&&await this.doActionExp(x,h,c),g.length&&await this.doActionExp(b,g,c)}else await this.doActionExp(p,l,c)}else r.name!==ir.name&&await this.doAction(r.name,l,r.args,n)}finally{s==null||s(),s=void 0}}async doAction(r,o,i=[],n="n"){let a=this.registeredAction(r);if(!a)return;let{select:s=!1,render:l=!1,reload:c=!1}=a.options,f=Array.isArray(o)?o:[o],u=this.source;try{if(s===!0){let d=Oi([...f,...u.selectedNodes]);u.selectedNodes.clear(),u.view.requestRenderNodes(d),await a.callback.call(u,{source:u,nodes:d,args:i,mode:n})}else if(s===!1)await a.callback.call(u,{source:u,nodes:[f[0]],args:i,mode:n});else if(s==="visual")await a.callback.call(u,{source:u,nodes:f,args:i,mode:n});else if(s==="keep"){let d=Oi([...f,...u.selectedNodes]);await a.callback.call(u,{source:u,nodes:d,args:i,mode:n})}}finally{c?await u.load(u.view.rootNode):l&&await u.view.render()}}async listActionMenu(r){var s;let o=this.registeredActions(),i=this.source,n=await et.getReversedMappings(i.sourceType),a=await Gr(this.source.explorer,$g,ye([...o.entries()].filter(([l])=>l!=="actionMenu").sort(([l],[c])=>l.localeCompare(c)).map(([l,{callback:c,options:f,description:u}])=>{var h;let d=n[l],p=d?(h=d.vmap)!=null?h:d.all:"",m=[{name:l,key:p,description:u,callback:async()=>{await a.waitExplorerShow(),await c.call(i,{source:i,nodes:r,args:[],mode:"n"})}}];return f.menus&&m.push(...Mt.getNormalizeMenus(f.menus).map(g=>{var I;let x=`${l}:${g.args}`,b=n[x],T=b?(I=b.vmap)!=null?I:b.all:"";return{name:x,key:T,description:`${u} ${g.description}`,callback:async()=>{await a.waitExplorerShow(),await c.call(i,{source:i,nodes:r,args:await g.actionArgs(),mode:"n"})}}})),m})));(s=a.waitExplorerShow())==null||s.catch(v.error)}};var xs=class{constructor(e,r){this.source=e;this.hlSrcId=r}addHighlightsNotify(e){this.source.explorer.highlight.addHighlightsNotify(this.hlSrcId,e)}clearHighlightsNotify(e,r){this.source.explorer.highlight.clearHighlightsNotify(this.hlSrcId,e,r)}};var bs=class{constructor(e){this.source=e;this.explorer=e.explorer}get view(){return this.source.view}add(e,r){this.explorer.locator.mark.add(e,this.view.startLineIndex+r)}remove(e,r){this.explorer.locator.mark.remove(e,this.view.startLineIndex+r)}offsetAfterLine(e,r){this.explorer.locator.mark.offsetLines(e,this.view.startLineIndex+r+1),this.view.endLineIndex+=e;let o=this.view.currentSourceIndex();o!==void 0&&this.explorer.sources.slice(o+1).forEach(i=>{i.view.startLineIndex+=e,i.view.endLineIndex+=e})}};var ys=class{constructor(e){this.source=e;this.explorer=this.source.explorer,this.mark=new bs(e)}get view(){return this.source.view}async gotoLineIndex(e,r){return(await this.gotoLineIndexNotifier(e,r)).run()}gotoLineIndexNotifier(e,r){return e<0&&(e=0),e>=this.source.height&&(e=this.source.height-1),this.explorer.locator.gotoLineIndexNotifier(this.view.startLineIndex+e,r)}async gotoRoot({col:e}={}){return(await this.gotoLineIndexNotifier(0,e)).run()}gotoRootNotifier({col:e}={}){return this.gotoLineIndexNotifier(0,e)}async gotoNode(e,r={}){return(await this.gotoNodeNotifier(e,r)).run()}async gotoNodeNotifier(e,r={}){return this.gotoNodeUidNotifier(e.uid,r)}async gotoNodeUid(e,r={}){return(await this.gotoNodeUidNotifier(e,r)).run()}async gotoNodeUidNotifier(e,{lineIndex:r,col:o=0}={}){let i=this.view.flattenedNodes.findIndex(n=>n.uid===e);return i!==-1?this.gotoLineIndexNotifier(i,o):r!==void 0?this.gotoLineIndexNotifier(r,o):E.noop()}};var cr=class{constructor(e,r){this.sourceType=e;this.explorer=r;this.width=0;this.showHidden=!1;this.selectedNodes=new Set;this.nvim=Dc.workspace.nvim;this.bufManager=this.explorer.explorerManager.bufManager;this.events=new ht(v);this.action=new ws(this,this.explorer.action);this.locator=new ys(this);this.disposables=[];this.isDisposed=!1;this.config=this.explorer.config;this.icons=(e=>({get expanded(){return e.config.get("icon.expanded")||(e.config.get("icon.enableNerdfont")?"\uF44B":"-")},get collapsed(){return e.config.get("icon.collapsed")||(e.config.get("icon.enableNerdfont")?"\uF44A":"+")},get selected(){return e.config.get("icon.selected")},get hidden(){return e.config.get("icon.hidden")},get link(){return e.config.get("icon.link")},get readonly(){return e.config.get("icon.readonly")||(e.config.get("icon.enableNerdfont")?"\uF023":"RO")}}))(this);this.helper=(e=>({getUid(r){return ha(r.toString(),e.sourceType)}}))(this);this.context=this.explorer.context,this.highlight=new xs(this,`coc-explorer-${e}`)}get root(){return Dc.workspace.cwd}set root(e){}static get enabled(){return!0}dispose(){this.isDisposed=!0,this.view.dispose(),this.disposables.forEach(e=>e.dispose())}get height(){return this.view.flattenedNodes.length}bootInit(e){Promise.resolve(this.init()).catch(v.error),this.view.bootInit(e)}async bootOpen(e){await this.open(e),this.view.bootOpen()}async openedNotifier(e,r){return E.noop()}async copyToClipboard(e){await this.nvim.call("setreg",["+",e]),await this.nvim.call("setreg",['"',e])}isSelectedAny(){return this.selectedNodes.size!==0}isSelectedNode(e){return this.selectedNodes.has(e)}async loadInitedChildren(e,r){let o=await this.loadChildren(e,r);return await Promise.all(o.map(async(i,n)=>{var a;i.level=((a=e.level)!=null?a:0)+1,i.parent=e,i.prevSiblingNode=o[n-1],i.nextSiblingNode=o[n+1],(r==null?void 0:r.recursiveExpanded)&&i.expandable&&this.view.isExpanded(i)&&(i.children=await this.loadInitedChildren(i,r))})),o}async load(e,r){await this.view.sync(async o=>(await this.loadNotifier(o,e,r)).run())}async loadNotifier(e,r,{render:o=!0,force:i=!1}={}){return this.isDisposed?E.noop():(await this.explorer.refreshWidth(),this.selectedNodes=new Set,this.view.isExpanded(r)?r.children=await this.loadInitedChildren(r,{recursiveExpanded:!0,force:i}):r.children=void 0,await this.events.fire("loaded",r),await this.view.load(r),o?e.renderNotifier({node:r,force:i}):E.noop())}};var Uw=require("coc.nvim"),Bc=class{constructor(){this.registeredSources={}}registerSource(e,r){return this.registeredSources[e]=r,Uw.Disposable.create(()=>{delete this.registeredSources[e]})}async enabled(e){return this.registeredSources[e]?await this.registeredSources[e].enabled:!1}createSource(e,r,o){if(!this.registeredSources[e])throw new Error(`explorer source(${e}) not found`);let i=new this.registeredSources[e](e,r);return i.bootInit(o),i}},Ct=new Bc;var vs={bufferRootTemplate:R.registerOption("buffer-root-template",{getDefault:()=>C.get("buffer.root.template")}),bufferChildTemplate:R.registerOption("buffer-child-template",{getDefault:()=>C.get("buffer.child.template")}),bufferChildLabelingTemplate:R.registerOption("buffer-child-labeling-template",{getDefault:()=>C.get("buffer.child.labelingTemplate")})};var qw=require("coc.nvim");function Vw(t){let{nvim:e}=qw.workspace,r=t.owner;t.addNodeAction("drop",async({node:o})=>{if(!o.hidden){let n=await e.call("getbufinfo",o.bufnr);if(n.length&&n[0].windows.length){let a=await r.explorer.tryQuitOnOpenNotifier(),s=n[0].windows[0];e.pauseNotification(),e.call("win_gotoid",s,!0),a.notify(),await e.resumeNotification();return}}let i=await r.explorer.tryQuitOnOpenNotifier();e.pauseNotification(),e.command(`buffer ${o.bufnr}`,!0),i.notify(),await e.resumeNotification()},"open buffer by drop command",{select:!0}),t.addNodeAction("delete",async({node:o})=>{if(pa()&&(await oe.curTabDelBufnr(o.bufnr),oe.existBufnr(o.bufnr))){let i=await Fh(o.bufnr);await Ta(i);return}r.bufManager.modified(o.fullpath,{directory:!1})&&await ze("Buffer is being modified, delete it?")!=="yes"||(await r.bufManager.removeBufNode(o,{skipModified:!0,bwipeout:!1,directory:!1}),await r.load(o,{force:!0}))},"delete buffer",{select:!0}),t.addNodeAction("deleteForever",async({node:o})=>{r.bufManager.modified(o.fullpath,{directory:!1})&&await ze("Buffer is being modified, wipeout it?")!=="yes"||(await r.bufManager.removeBufNode(o,{skipModified:!0,bwipeout:!0,directory:!1}),await r.load(o,{force:!0}))},"bwipeout buffer",{select:!0})}var Yw=require("coc.nvim"),fr=class{constructor(){this.registeredColumns=new Map}async initColumn(e,r,o){var s,l;if(/\d+/.test(o))return parseInt(o,10);let i=(s=this.registeredColumns.get(e))==null?void 0:s.get(o);if(!i)throw Error(`column(${o}) not found`);let n={label:o},a=[];if(Object.assign(n,i.createColumn({source:r,column:n,subscriptions:a}),{subscriptions:a}),n.inited)return n;if(!(n.available&&!await n.available()))return await((l=n.init)==null?void 0:l.call(n)),n.inited=!0,n}registerColumn(e,r,o){return this.registeredColumns.has(e)||this.registeredColumns.set(e,new Map),this.registeredColumns.get(e).set(r,{createColumn:o}),Yw.Disposable.create(()=>{this.registeredColumns.get(e).delete(r)})}};var Wc=class extends fr{},V=new Wc;V.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:be.expandIcon})}}}}));V.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[BUFFER]",{hl:be.title})}}}}));V.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:be.hidden})}}}}));var zw=t=>{let e=r=>({icon:t.get(`git.icon.rootStatus.${r}`),name:r});return{[0]:{icon:"",name:"staged"},[5]:e("stashed"),[1]:e("ahead"),[2]:e("behind"),[3]:e("conflicted"),[4]:e("untracked"),[6]:e("modified"),[7]:e("added"),[8]:e("renamed"),[9]:e("deleted")}},Es=t=>{let e=r=>({icon:t.get(`git.icon.status.${r}`),name:r});return{["*"]:e("mixed"),[" "]:e("unmodified"),["M"]:e("modified"),["A"]:e("added"),["D"]:e("deleted"),["R"]:e("renamed"),["C"]:e("copied"),["U"]:e("unmerged"),["?"]:e("untracked"),["!"]:e("ignored")}};var Xw=require("coc.nvim"),Qw=_(Fi());var je=D.linkGroup.bind(D),Jw=t=>{D.watchColorScheme(t,async()=>{let r=await us(["String","Character","Number","Boolean","Float","Identifier","Function","Statement","Conditional","Repeat","Label","Operator","Keyword","Exception","PreProc","Include","Define","Macro","PreCondit","Type","StorageClass","Structure","Typedef","Special","SpecialChar","Tag","Delimiter","SpecialComment","Debug","Todo"]),o=ue(Object.values(r).map(s=>{var f;let l=s.guifg;if(!l)return;let c=(f=s.ctermfg)!=null?f:Qw.default.rgb.ansi256([l.red,l.green,l.blue]);return{guifg:l,ctermfg:c}})),{nvim:i}=Xw.workspace;i.pauseNotification();let n=zl(Ca(18,204,90,1),o,s=>s.guifg);n&&i.command(`highlight default CocExplorerGitPathChange_Internal ctermfg=${n.ctermfg} guifg=#${Hi(n.guifg)}`,!0);let a=zl(Ca(209,177,15,1),o,s=>s.guifg);a&&i.command(`highlight default CocExplorerGitContentChange_Internal ctermfg=${n.ctermfg} guifg=#${Hi(a.guifg)}`,!0),await i.resumeNotification()}).catch(v.error)},rn=je("GitPathChange","CocExplorerGitPathChange_Internal"),Kw=je("GitContentChange","CocExplorerGitContentChange_Internal"),me={renamed:je("GitRenamed",rn.group),copied:je("GitCopied",rn.group),added:je("GitAdded",rn.group),untracked:je("GitUntracked",rn.group),unmerged:je("GitUnmerged",rn.group),mixed:je("GitMixed",Kw.group),modified:je("GitModified",Kw.group),deleted:je("GitDeleted",Ee.ErrorColor),ignored:je("GitIgnored",Ee.CommentColor),staged:je("GitStaged",Ee.CommentColor),unstaged:je("GitUnstaged","Operator")},Zw=t=>{switch(t){case"*":return me.mixed;case"M":return me.modified;case"A":return me.added;case"D":return me.deleted;case"R":return me.renamed;case"C":return me.copied;case"U":return me.unmerged;case"?":return me.untracked}};var ur=require("coc.nvim"),on=_(require("path"));var Fc=require("coc.nvim"),ex=_(require("path"));var Ns=class{constructor(){this.sourcesBinding=new Map;this.prevErrorMixedCount=new Map;this.prevWarningMixedCount=new Map;this.reloadDebounceSubject=Ha(e=>e.pipe($r(e.pipe(at(500))),rr(async r=>{let o=new Set(r.flat());await this.reload([...o])})))}get sources(){return[...this.sourcesBinding.keys()]}get refTotalCount(){return se([...this.sourcesBinding.values()].map(e=>e.refCount.total))}get diagnosticTypes(){let e=[],r=[...this.sourcesBinding.values()].map(o=>o.refCount);return r.some(o=>o.error>0)&&e.push("error"),r.some(o=>o.warning>0)&&e.push("warning"),e}bind(e,r){let o=Vn(this.sourcesBinding,e,()=>({refCount:{error:0,warning:0,total:0}}));return o.refCount[r]+=1,o.refCount.total+=1,o.refCount.total===1&&(this.registeredForSourceDisposable=this.registerForSource(e)),this.refTotalCount===1&&(this.registeredDisposable=this.register()),Fc.Disposable.create(()=>{var i,n;o.refCount[r]-=1,o.refCount.total-=1,o.refCount.total===0&&((i=this.registeredForSourceDisposable)==null||i.dispose(),this.registeredForSourceDisposable=void 0),this.refTotalCount===0&&((n=this.registeredDisposable)==null||n.dispose(),this.registeredDisposable=void 0)})}register(){return lt.on("CocDiagnosticChange",()=>{this.reloadDebounceSubject.next(this.sources)})}registerForSource(e){let r=e.events.on("loaded",async i=>{("isRoot"in i?e.root:i.expandable?i.fullpath:i.fullpath&&ex.default.dirname(i.fullpath))&&this.reloadDebounceSubject.next([e])}),o=e.events.on("drawn",()=>{for(let[i,n]of e.view.flattenedNodes.entries()){if(!n.fullpath)continue;let a=K.getMixedError(n.fullpath),s=K.getMixedWarning(n.fullpath),l=!1,c=!1;if(a||s){let f=!(n.expandable&&e.view.isExpanded(n));a&&f&&(l=!0),s&&f&&(c=!0)}l?e.locator.mark.add("diagnosticError",i):e.locator.mark.remove("diagnosticError",i),c?e.locator.mark.add("diagnosticWarning",i):e.locator.mark.remove("diagnosticWarning",i)}});return Fc.Disposable.create(()=>{r.dispose(),o.dispose()})}async reload(e){let r=this.diagnosticTypes;await K.reload(r);let o=new Set;if(r.includes("error")){for(let[n]of this.prevErrorMixedCount)o.add(n);let i=new Map(K.getMixedErrors());for(let[n]of i)o.add(n);this.prevErrorMixedCount=i}if(r.includes("warning")){for(let[n]of this.prevWarningMixedCount)o.add(n);let i=new Map(K.getMixedWarnings());for(let[n]of i)o.add(n);this.prevWarningMixedCount=i}for(let i of e)await i.view.renderPaths(o)}};var jc=class{constructor(){this.errorMixedCountCache=new Map;this.warningMixedCountCache=new Map;this.binder=new Ns}bindColumn(e,r){let o=new Set(r),i=[];for(let n of o)i.push(this.binder.bind(e,n));return ur.Disposable.create(()=>{(0,ur.disposeAll)(i)})}async reload(e){let r=new Set(e),o=new Map,i=new Map;for(let n of await ur.diagnosticManager.getDiagnosticList()){let a=n.location.uri,s=le(ur.Uri.parse(a).fsPath);if(n.severity==="Error"){let l=o.get(s);o.set(s,(l!=null?l:0)+1)}else{let l=i.get(s);i.set(s,(l!=null?l:0)+1)}}r.has("error")&&this.reloadMixedErrors(o),r.has("warning")&&this.reloadMixedWarnings(i)}reloadMixedErrors(e){let r=new Map;for(let[o,i]of e){let n=o.split(on.default.sep);for(let a=1;a<=n.length;a++){let s=n.slice(0,a).join(on.default.sep),l=r.get(s);r.set(s,(l!=null?l:0)+i)}}this.errorMixedCountCache=r}reloadMixedWarnings(e){let r=new Map;for(let[o,i]of e){let n=o.split(on.default.sep);for(let a=1;a<=n.length;a++){let s=n.slice(0,a).join(on.default.sep),l=r.get(s);r.set(s,(l!=null?l:0)+i)}}this.warningMixedCountCache=r}getMixedErrors(){return this.errorMixedCountCache}getMixedWarnings(){return this.warningMixedCountCache}getMixedError(e){return this.errorMixedCountCache.get(e)}getMixedWarning(e){return this.warningMixedCountCache.get(e)}},K=new jc;var eo=require("coc.nvim"),Is=_(require("fs")),eb=require("os"),Os=_(require("path"));var tx=D.linkGroup.bind(D),It={diagnosticError:tx("DiagnosticError",Ee.CocErrorSignColor),diagnosticWarning:tx("DiagnosticWarning",Ee.CocWarningSignColor)};var rx=require("child_process"),dr=require("coc.nvim"),ox=require("events"),ix=_(Ro()),nx=_(require("path")),ax=_(require("readline"));var Hc=class extends ox.EventEmitter{constructor(){super(...arguments);this.processes=[]}start(r,o,i,n){let a=i.length;for(let s of i){let l=(0,rx.spawn)(r,o,{cwd:s});this.processes.push(l),l.on("error",d=>{this.emit("error",d.message)});let c=ax.default.createInterface(l.stdout),f=dr.Range.create(0,0,0,0),u=n.length>0;l.stderr.on("data",d=>{console.error(d.toString("utf8"))}),c.on("line",d=>{let p=nx.default.join(s,d);if(u&&n.some(h=>(0,ix.default)(p,h)))return;let m=dr.Location.create(dr.Uri.file(p).toString(),f);this.emit("data",{label:d,location:m})}),c.on("close",()=>{a=a-1,a===0&&this.emit("end")})}}dispose(){for(let r of this.processes)r.killed||r.kill()}},IO=dr.workspace.getConfiguration("list.source.files");async function OO(t){let e=[];if(await Di("fd"))return e.push("--color","never"),t.showIgnores&&e.push("--no-ignore"),t.showHidden&&e.push("--hidden"),t.recursive||e.push("--max-depth","1"),{name:"fd",args:e};if(We)return e.push("/a-D","/B"),t.recursive&&e.push("/S"),{name:"dir",args:e};if(await Di("find"))return e.push("."),t.recursive||e.push("-maxdepth","1"),{name:"find",args:e};throw new Error("Unable to find command for files list.")}var sx=or({name:"explorerFiles",defaultAction:"reveal",async loadItems(t){if(!t.rootPath)return;let e=await OO(t);if(!e)return;let r=new Hc,o=IO.get("excludePatterns",[]);return r.start(e.name,e.args,[t.rootPath],o),r},init(){this.addLocationActions(),this.addAction("reveal",async({arg:t,item:e})=>{let r=await this.convertLocation(e.location);t.revealCallback&&await t.revealCallback(r)})}});var nn={fileRootTemplate:R.registerOption("file-root-template",{getDefault:()=>C.get("file.root.template")}),fileRootLabelingTemplate:R.registerOption("file-root-labeling-template",{getDefault:()=>C.get("file.root.labelingTemplate")}),fileChildTemplate:R.registerOption("file-child-template",{getDefault:()=>C.get("file.child.template")}),fileChildLabelingTemplate:R.registerOption("file-child-labeling-template",{getDefault:()=>C.get("file.child.labelingTemplate")})};var Xc=_(vx());var Xr=require("coc.nvim"),Ge=_(require("path"));var Ex=require("coc.nvim");var Nx=or({name:"explorerDrives",defaultAction:"do",async loadItems(t){return t.map(e=>({label:e.name,data:e}))},doHighlight(){let{nvim:t}=Ex.workspace;t.pauseNotification(),t.command("syntax match CocExplorerDriveName /\\v^[\\w:]+/",!0),t.command("highlight default link CocExplorerDriveName PreProc",!0),t.resumeNotification().catch(v.error)},init(){this.addAction("do",async({item:t})=>{await t.data.callback(t.data.name)})}});var Kc=require("coc.nvim");var Tx=or({defaultAction:"do",name:"ExplorerWorkspaceFolders",async loadItems(t){return Kc.workspace.folderPaths.map(e=>({label:e,data:{path:e,callback:()=>{t==null||t.action.doAction("cd",[],[e]).catch(v.error)}}}))},init(){this.addAction("do",({item:t})=>{t.data.callback()})},doHighlight(){let{nvim:t}=Kc.workspace;t.pauseNotification(),t.command("syntax match CocExplorerWorkspaceFolder /\\v^.*/",!0),t.command("highlight default link CocExplorerWorkspaceFolder PreProc",!0),t.resumeNotification().catch(v.error)}});function Sx(t){let{nvim:e}=Xr.workspace,r=t.owner;t.addNodeAction("gotoParent",async()=>{var a;if(r.root==="")return;let n=(a=r.view.currentNode())==null?void 0:a.uid;/^[A-Za-z]:[\\/]$/.test(r.root)?r.root="":(r.root=Ge.default.dirname(r.root),await r.cd(r.root)),await r.view.expand(r.view.rootNode),n&&await r.locator.gotoNodeUid(n)},"change directory to parent directory"),t.addNodeAction("rootStrategies",({args:n})=>{let a=n[0];a&&(r.rootStrategies=a.split(","))},"change root strategies",{args:[{name:"root strategies",description:`root strategies of ${os.join(" | ")}`}],menus:{"workspace,cwd,sourceBuffer,reveal":"default",keep:"keep current root"}}),t.addNodeAction("resolveRoot",async({args:n,node:a})=>{var c;let s=n[0],l=await((c=r.explorer.rooter)==null?void 0:c.resolveRoot(s,r.rootStrategies));l&&await t.doAction("cd",a,[l])},"resolve and change directory to root",{args:[{name:"reveal path",description:"path string"}],menus:{path:{description:"use custom path",args:"<reveal-path>",async actionArgs(){var n,a;return[await Ke("input a reveal path:",(a=(n=r.view.currentNode())==null?void 0:n.fullpath)!=null?a:"","file")]}}}}),t.addNodeAction("reveal",async({node:n,args:a})=>{var f;let s=a[0],l,c="";if(/\d+/.test(s))l=parseInt(s,10),l===0&&(l=await Xe());else{let u=s!=null?s:"previousWindow",d={select:async()=>{await Sa(r.explorer.config,r.sourceType,{onSelect:async p=>{l=await Na(p)}})},sourceWindow:async()=>{l=await Na(await r.explorer.sourceWinnr())},previousBuffer:async()=>{l=await r.explorer.explorerManager.previousBufnr.get()},previousWindow:async()=>{l=await Na(await r.explorer.explorerManager.prevWinnrByPrevWindowID())},path:async()=>{var p,m;c=a[1],c||(c=await Ke("Input a reveal path:",(m=(p=r.view.currentNode())==null?void 0:p.fullpath)!=null?m:"","file"))}};await((f=d[u])==null?void 0:f.call(d))}if(l){let u=await e.call("getbufinfo",[l]);if(!u[0]||!u[0].name)return;c=u[0].name}!c||(va(r.root,c)||await t.doAction("resolveRoot",n,[c]),await r.view.sync(async u=>{var g;let p=((g=a[1])!=null?g:"").includes("compact")||void 0,[m,h]=await r.revealNodeByPathNotifier(u,c,{compact:p});m&&await E.runAll(h)}))},"reveal buffer in explorer",{args:[{name:"target",description:`bufnr number | ${pw.join(" | ")}`}],menus:{"0":"use current buffer","0:compact":"use current buffer and compact",select:"use select windows UI",previousBuffer:"use last used buffer",previousWindow:"use last used window",sourceWindow:"use the window where explorer opened",path:{description:"use custom path",args:"path:<path>",async actionArgs(){return["path"]}}}}),t.addNodeAction("cd",async({node:n,args:a})=>{let s=async c=>{await r.cd(c),r.root=c,await r.view.expand(r.view.rootNode)},l=a[0];l!==void 0?await s(l):n.directory&&await s(n.fullpath)},"change directory to current node",{args:[{name:"path"}],menus:{path:{description:"",args:"<path>",async actionArgs(){var n,a;return[await Ke("input a cd path:",(a=(n=r.view.currentNode())==null?void 0:n.fullpath)!=null?a:"","file")]}}}}),t.addNodeAction("workspaceFolders",async()=>{await Gr(r.explorer,Tx,r,["--normal"])},"change directory to current node"),t.addNodeAction("drop",async({node:n})=>{if(!n.directory){let a=await r.explorer.tryQuitOnOpenNotifier();e.pauseNotification(),e.command(`drop ${n.fullpath}`,!0),a.notify(),await e.resumeNotification()}},"open file by drop command",{select:!0}),t.addNodesAction("copyFilepath",async({nodes:n})=>{await r.copyToClipboard(n?n.map(a=>a.fullpath).join(`
`):r.root),Xr.window.showMessage("Copy filepath to clipboard")},"copy full filepath to clipboard"),t.addNodesAction("copyRelativeFilepath",async({nodes:n})=>{await r.copyToClipboard(n?n.map(a=>Ge.default.relative(r.root,a.fullpath)).join(`
`):r.root),Xr.window.showMessage("Copy relative filepath to clipboard")},"copy relative filepath to clipboard"),t.addNodesAction("copyFilename",async({nodes:n})=>{await r.copyToClipboard(n?n.map(a=>a.name).join(`
`):Ge.default.basename(r.root)),Xr.window.showMessage("Copy filename to clipboard")},"copy filename to clipboard");let o={args:[{name:"type",description:`${hw.join(" | ")}, default: toggle`}],menus:{toggle:"toggle mark",append:"append mark",replace:"remove all mark then add one mark"}},i={args:[{name:"type",description:`${gw.join(" | ")}, default: clear`}],menus:{keepCopy:"keep copy mark",clear:"clear copy and cut mark"}};t.addNodesAction("copyFile",async({nodes:n,args:a})=>{var l;let s=(l=a[0])!=null?l:"toggle";if(s==="replace"){r.view.requestRenderNodes([...r.copiedNodes,...r.cutNodes]),r.copiedNodes.clear(),r.cutNodes.clear();for(let c of n)r.copiedNodes.add(c)}else if(s==="toggle")for(let c of n)r.copiedNodes.has(c)?r.copiedNodes.delete(c):r.copiedNodes.add(c);else if(s==="append")for(let c of n)r.copiedNodes.add(c);r.view.requestRenderNodes(n)},"copy file for paste",o),t.addNodesAction("cutFile",async({nodes:n,args:a})=>{var l;let s=(l=a[0])!=null?l:"toggle";if(s==="replace"){r.view.requestRenderNodes([...r.copiedNodes,...r.cutNodes]),r.copiedNodes.clear(),r.cutNodes.clear();for(let c of n)r.cutNodes.add(c)}else if(s==="toggle")for(let c of n)r.cutNodes.has(c)?r.cutNodes.delete(c):r.cutNodes.add(c);else if(s==="append")for(let c of n)r.cutNodes.add(c);r.view.requestRenderNodes(n)},"cut file for paste",o),t.addNodeAction("pasteFile",async({node:n,args:a})=>{var c;let s=(c=a[0])!=null?c:"keepCopy";if(r.copiedNodes.size<=0&&r.cutNodes.size<=0){Xr.window.showMessage("Copied files or cut files is empty","error");return}let l=r.getPutTargetDir(n);if(r.copiedNodes.size>0){let f=[...r.copiedNodes];await Br("paste",f.map(u=>({source:u.fullpath,target:Ge.default.join(l,Ge.default.basename(u.fullpath))})),Fl),r.view.requestRenderNodes(f),s==="clear"&&r.copiedNodes.clear()}if(r.cutNodes.size>0){let f=[...r.cutNodes];await Br("paste",f.map(u=>({source:u.fullpath,target:Ge.default.join(l,Ge.default.basename(u.fullpath))})),Wl),r.cutNodes.clear()}await r.load(r.view.rootNode)},"paste files to here",i),t.addNodesAction("delete",async({nodes:n})=>{if(n.some(s=>r.bufManager.modified(s.fullpath,{directory:s.directory}))&&await ze("Buffer is being modified, discard it?")!=="yes")return;let a=n.map(s=>s.fullpath).join(`
`);if(await ze(`Move these files or directories to trash?
${a}`)==="yes"){await xa(n.map(s=>s.fullpath));for(let s of n)await r.bufManager.remove(s.fullpath,{skipModified:!0,bwipeout:!0,directory:s.directory})}},"move file or directory to trash",{reload:!0}),t.addNodesAction("deleteForever",async({nodes:n})=>{if(n.some(s=>r.bufManager.modified(s.fullpath,{directory:s.directory}))&&await ze("Buffer is being modified, discard it?")!=="yes")return;let a=n.map(s=>s.fullpath).join(`
`);if(await ze(`Delete these files or directories permanently?
${a}`)==="yes")for(let s of n)await Nh(s.fullpath),await r.bufManager.remove(s.fullpath,{skipModified:!0,bwipeout:!0,directory:s.directory})},"delete file or directory permanently",{reload:!0}),t.addNodeAction("addFile",async({node:n,args:a})=>{let s,l="Input a new filename:";if(a[0]?s=a[0]:s=await Ke(l,"","file"),s=s==null?void 0:s.trim(),!s)return;if(["/","\\"].includes(s[s.length-1])){await t.doAction("addDirectory",n,[s]);return}let c=r.getPutTargetNode(n),f=Ge.default.join(c.fullpath,s);await Br("add file",[{source:void 0,target:f}],async(u,d)=>{await yh(d)}),await r.view.sync(async u=>{var h;let d=(h=c.parent)!=null?h:c,p=await r.loadNotifier(u,d),[,m]=await r.revealNodeByPathNotifier(u,f.replace(/(\/|\\)$/,""),{startNode:d});await E.runAll([p,...m])})},"add a new file"),t.addNodeAction("addDirectory",async({node:n,args:a})=>{var f;let s=(f=a[0])!=null?f:await Ke("Input a new directory name:","","file");if(s=s.trim().replace(/(\/|\\)*$/g,""),!s)return;let l=r.getPutTargetNode(n),c=Ge.default.join(l.fullpath,s);await Br("add directory",[{source:void 0,target:c}],async(u,d)=>{await Wo(d)}),await r.view.sync(async u=>{var h;let d=(h=l.parent)!=null?h:l,p=await r.loadNotifier(u,d),[,m]=await r.revealNodeByPathNotifier(u,c,{startNode:d});await E.runAll([p,...m])})},"add a new directory"),t.addNodeAction("rename",async({node:n})=>{if(r.bufManager.modified(n.fullpath,{directory:n.directory})&&await ze("Buffer is being modified, discard it?")!=="yes")return;let a;a=await Ke(`Rename: ${n.fullpath} ->`,n.fullpath,"file"),a=a==null?void 0:a.trim(),a&&(await Br("rename",[{source:n.fullpath,target:a}],Wl),await r.bufManager.replace(n.fullpath,a,{skipModified:!0,bwipeout:!0,directory:n.directory}))},"rename a file or directory",{reload:!0}),t.addNodesAction("systemExecute",async({nodes:n})=>{n?await Promise.all(n.map(a=>(0,Xc.default)(a.fullpath))):await(0,Xc.default)(r.root)},"use system application open file or directory"),We&&t.addNodeAction("listDrive",async()=>{let n=await ba();await Gr(r.explorer,Nx,n.map(a=>({name:a,callback:async s=>{r.root=s,await r.view.expand(r.view.rootNode)}})),["--normal","--number-select"])},"list drives"),t.addNodeAction("search",async({node:n,args:a})=>{var u;let s=((u=a[0])!=null?u:"").split("|"),l=s.includes("recursive"),c=s.includes("strict"),f=s.includes("noIgnore");await r.searchByCocList(n.isRoot?n.fullpath:Ge.default.dirname(n.fullpath),{recursive:l,noIgnore:f,strict:c})},"search by coc-list, the ignore function requires the fd command",{args:[{name:"search options",description:xw.join(" | ")}],menus:{noIgnore:"no ignore",recursive:"recursively","recursive|noIgnore":"recursively and no ignore",strict:"exact match","recursive|strict":"recursively and strict"}}),t.addNodeAction("searchRecursive",async({node:n})=>{v.error('searchRecursive action has been deprecated, please use "search:recursive" instead of it'),await r.searchByCocList(Ge.default.dirname(n.fullpath),{recursive:!0,noIgnore:!1,strict:!1})},"search by coc-list recursively"),t.addNodeAction("toggleOnlyGitChange",async()=>{r.showOnlyGitChange=!r.showOnlyGitChange,await r.view.sync(async n=>{let a=await r.loadNotifier(n,r.view.rootNode,{force:!0});e.pauseNotification(),r.highlight.clearHighlightsNotify(),a==null||a.notify(),await e.resumeNotification()})},"toggle visibility of git change node",{reload:!0})}var Qc=class extends fr{},O=new Qc;O.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:P.expandIcon})}}}}));O.registerColumn("root","git",({source:t,subscriptions:e})=>{let r=zw(t.config);return{init(){e.push(B.bindColumn(t))},async draw(){return{labelVisible({node:o}){var i;return!!((i=B.getRootStatus(o.fullpath))!=null&&i.formats.length)},async available(){return await B.cmd.available()},drawNode(o,{node:i,isLabeling:n}){let a=B.getRootStatus(i.fullpath);if(a!=null&&a.formats.length){let s=[];for(let c of a.formats)n?s.push(`${r[c].name}(${r[c].icon})`):s.push(r[c].icon);let l=a.allStaged?me.staged:me.unstaged;n?o.add(s.join(" & "),{hl:l}):o.add(`{${s.join("")}}`,{hl:l})}}}}}});O.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[FILE]",{hl:P.title})}}}}));O.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:P.hidden})}}}}));var Cx=_(require("path"));O.registerColumn("root","root",({source:t})=>({draw(){return{drawNode(e){e.add(Cx.default.basename(t.root),{hl:P.rootName})}}}}));O.registerColumn("root","fullpath",()=>({draw(){return{drawNode(t,{node:e,isLabeling:r}){t.add(Qt(e.fullpath),{hl:r?P.directory:P.fullpath})}}}}));O.registerColumn("child","git",({source:t,subscriptions:e})=>{let r=new ut(t.config),o=Es(t.config),i=(n,a,s)=>{var l;return a?me.staged:(l=r.getHighlight(n,s,["git"]))!=null?l:me.unstaged};return{init(){e.push(B.bindColumn(t))},async available(){return await B.cmd.available()},async draw(){return{async labelVisible({node:n}){let a=B.getMixedStatus(n.fullpath,n.directory);return a?a.x!==" "||a.y!==" ":!1},drawNode(n,{node:a,nodeIndex:s,isLabeling:l}){let c=(u,d)=>{let p=i(a.fullpath,d,a.directory);l?n.add(`${o[u].name}(${o[u].icon})`,{hl:p}):n.add(o[u].icon,{hl:p})},f=B.getMixedStatus(a.fullpath,a.directory);f?(c(f.x,!0),l&&n.add(" "),c(f.y,!1),f.x==="!"?(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s)):(t.locator.mark.add("git",s),f.x!==" "?t.locator.mark.add("gitStaged",s):t.locator.mark.remove("gitStaged",s),f.y!==" "?t.locator.mark.add("gitUnstaged",s):t.locator.mark.remove("gitUnstaged",s))):(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s))}}}}});O.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));var dt=class{},Ix={};function pr(t,e){Ix[t]=e}var Jc=new Map;function Ox(t){if(!Jc.has(t)){let e=Ix[t];if(!e)return;Jc.set(t,e())}return Jc.get(t)}var Ax=_(Fi());var WO="./icons.nerdfont.schema.json",FO={folderClosed:{code:"\uE5FF",color:"#00afaf"},folderOpened:{code:"\uE5FE",color:"#00afaf"},folderSymlink:{code:"\uF482",color:"#00afaf"},folderNpm:{code:"\u4B8E",color:"#00afaf"},file:{code:"\uF15B",color:"#999999"},fileSymlink:{code:"\uF481",color:"#999999"},fileHidden:{code:"\uF016",color:"#999999"},excel:{code:"\uF71A",color:"#207245"},word:{code:"\uF72B",color:"#185abd"},ppt:{code:"\uF726",color:"#cb4a32"},stylus:{code:"\uE600",color:"#8dc149"},sass:{code:"\uE603",color:"#f55385"},html:{code:"\uE60E",color:"#e37933"},xml:{code:"\uE60E","code.origin":"\uFABF",color:"#e37933"},ejs:{code:"\uE618",color:"#cbcb41"},css:{code:"\uE614",color:"#519aba"},webpack:{code:"\uFC29",color:"#519aba"},markdown:{code:"\uE609",color:"#519aba"},json:{code:"\uE60B",color:"#cbcb41"},javascript:{code:"\uE60C",color:"#cbcb41"},javascriptreact:{code:"\uE7BA",color:"#519aba"},ruby:{code:"\uE791",color:"#cc3e44"},php:{code:"\uE608",color:"#a074c4"},python:{code:"\uE606",color:"#519aba"},coffee:{code:"\uE61B",color:"#cbcb41"},mustache:{code:"\uE60F",color:"#e37933"},conf:{code:"\uE615",color:"#6d8086"},image:{code:"\uE60D",color:"#a074c4"},ico:{code:"\uE60D",color:"#cbcb41"},twig:{code:"\uE61C",color:"#8dc149"},c:{code:"\uE61D",color:"#519aba"},h:{code:"\uF0FD",color:"#a074c4"},haskell:{code:"\uE61F",color:"#a074c4"},lua:{code:"\uE620",color:"#519aba"},java:{code:"\uE738",color:"#cc3e44"},kotlin:{code:"\u0138",color:"#5674d4"},terminal:{code:"\uE795",color:"#4d5a5e"},ml:{code:"\u03BB",color:"#e37933"},diff:{code:"\uE728",color:"#41535b"},sql:{code:"\uE706",color:"#f55385"},clojure:{code:"\uE768",color:"#8dc149"},edn:{code:"\uE76A",color:"#519aba"},scala:{code:"\uE737",color:"#cc3e44"},go:{code:"\uE627",color:"#519aba"},dart:{code:"\uE798",color:"#03589C"},firefox:{code:"\uE745",color:"#e37933"},vs:{code:"\uE70C",color:"#854CC7"},perl:{code:"\uE769",color:"#519aba"},rss:{code:"\uE619",color:"#fb9d3b"},csharp:{code:"\uF81A",color:"#519aba"},fsharp:{code:"\uE7A7",color:"#519aba"},rust:{code:"\uE7A8",color:"#519aba"},dlang:{code:"\uE7AF",color:"#cc3e44"},erlang:{code:"\uE7B1",color:"#A90533"},elixir:{code:"\uE62D",color:"#a074c4"},elm:{code:"\uE62C",color:"#519aba"},mix:{code:"\uE62D",color:"#cc3e44"},vim:{code:"\uE62B",color:"#019833"},ai:{code:"\uE7B4",color:"#cbcb41"},psd:{code:"\uE7B8",color:"#519aba"},psb:{code:"\uE7B8",color:"#519aba"},typescript:{code:"\uE628",color:"#519aba"},typescriptreact:{code:"\uE7BA",color:"#519aba"},julia:{code:"\uE624",color:"#a074c4"},puppet:{code:"\uF499",color:"#cbcb41"},vue:{code:"\uFD42",color:"#8dc149"},swift:{code:"\uE755",color:"#e37933"},git:{code:"\uE725",color:"#41535b"},bashrc:{code:"\uE615",color:"#4d5a5e"},favicon:{code:"\uE623",color:"#cbcb41"},docker:{code:"\uE7B0",color:"#519aba"},gruntfile:{code:"\uE611",color:"#e37933"},gulpfile:{code:"\uE610",color:"#cc3e44"},dropbox:{code:"\uE707",color:"#0061FE"},license:{code:"\uE60A",color:"#cbcb41"},procfile:{code:"\uE607",color:"#a074c4"},jquery:{code:"\uE750",color:"#1B75BB"},angular:{code:"\uE753",color:"#E23237"},backbone:{code:"\uE752",color:"#0071B5"},requirejs:{code:"\uE770",color:"#F44A41"},materialize:{code:"\uE7B6",color:"#EE6E73"},mootools:{code:"\uE78F",color:"#ECECEC"},vagrant:{code:"\uF2B8",color:"#1563FF"},svg:{code:"\uFC1F",color:"#FFB13B"},font:{code:"\uF031",color:"#999999"},text:{code:"\uF15C",color:"#999999"},archive:{code:"\uF53B",color:"#cc3e44"},lock:{code:"\uF023",color:"#999999"}},jO={styl:"stylus",sass:"sass",scss:"sass",htm:"html",html:"html",slim:"html",xml:"xml",xaml:"xml",ejs:"ejs",css:"css",less:"css",md:"markdown",mdx:"markdown",markdown:"markdown",rmd:"markdown",lock:"lock",json:"json",js:"javascript",cjs:"javascript",mjs:"javascript",es6:"javascript",jsx:"javascriptreact",rb:"ruby",ru:"ruby",php:"php",py:"python",pyc:"python",pyo:"python",pyd:"python",coffee:"coffee",mustache:"mustache",hbs:"mustache",config:"conf",conf:"conf",ini:"conf",yml:"conf",yaml:"conf",toml:"conf",jpg:"image",jpeg:"image",bmp:"image",png:"image",gif:"image",webp:"image",ico:"ico",twig:"twig",cpp:"c","c++":"c",cxx:"c",cc:"c",cp:"c",c:"c",h:"h",hh:"h",hpp:"h",hxx:"h",hs:"haskell",lhs:"haskell",lua:"lua",java:"java",jar:"java",kt:"kotlin",kts:"kotlin",sh:"terminal",fish:"terminal",bash:"terminal",zsh:"terminal",ksh:"terminal",csh:"terminal",awk:"terminal",ps1:"terminal",bat:"terminal",cmd:"terminal",ml:"ml",mli:"ml",diff:"diff",db:"sql",sql:"sql",dump:"sql",accdb:"sql",clj:"clojure",cljc:"clojure",cljs:"clojure",edn:"edn",scala:"scala",go:"go",dart:"dart",xul:"firefox",pl:"perl",pm:"perl",t:"perl",rss:"rss",sln:"vs",suo:"vs",csproj:"vs",cs:"csharp",fsscript:"fsharp",fsx:"fsharp",fs:"fsharp",fsi:"fsharp",rs:"rust",rlib:"rust",d:"dlang",erl:"erlang",hrl:"erlang",ex:"elixir",eex:"elixir",exs:"elixir",exx:"elixir",leex:"elixir",vim:"vim",ai:"ai",psd:"psd",psb:"psd",ts:"typescript",tsx:"javascriptreact",jl:"julia",pp:"puppet",vue:"vue",elm:"elm",swift:"swift",xcplayground:"swift",svg:"svg",otf:"font",ttf:"font",fnt:"font",txt:"text",text:"text",zip:"archive",tar:"archive",gz:"archive",gzip:"archive",rar:"archive","7z":"archive",iso:"archive",doc:"word",docx:"word",docm:"word",csv:"excel",xls:"excel",xlsx:"excel",xlsm:"excel",ppt:"ppt",pptx:"ppt",pptm:"ppt"},HO={gruntfile:"gruntfile",gulpfile:"gulpfile",gemfile:"ruby",guardfile:"ruby",capfile:"ruby",rakefile:"ruby",gradlew:"terminal",mix:"mix",dropbox:"dropbox",vimrc:"vim",".vimrc":"vim",".gvimrc":"vim",_vimrc:"vim",_gvimrc:"vim",license:"license",procfile:"procfile",Vagrantfile:"vagrant","docker-compose.yml":"docker",".gitconfig":"git",".gitignore":"git",webpack:"webpack",".bashrc":"bashrc",".zshrc":"bashrc",".bashprofile":"bashrc","favicon.ico":"favicon",dockerfile:"docker",".dockerignore":"docker"},$O={".*jquery.*.js$":"jquery",".*angular.*.js$":"angular",".*backbone.*.js$":"backbone",".*require.*.js$":"requirejs",".*materialize.*.js$":"materialize",".*materialize.*.css$":"materialize",".*mootools.*.js$":"mootools"},GO={".git":"git",node_modules:"javascript"},UO={},Px={$schema:WO,icons:FO,extensions:jO,filenames:HO,patternMatches:$O,dirnames:GO,dirPatternMatches:UO};var X=Px,ci=C.get("icon.customIcons",{});Object.assign(X.icons,ci.icons);Object.assign(X.extensions,ci.extensions);Object.assign(X.filenames,ci.filenames);Object.assign(X.dirnames,ci.dirnames);Object.assign(X.patternMatches,ci.patternMatches);Object.assign(X.dirPatternMatches,ci.dirPatternMatches);var an={};Object.entries(X.icons).forEach(([t,e])=>{let r=Gi(e.color);if(!r)return;let i=`ctermfg=${Ax.default.rgb.ansi256([r.red,r.green,r.blue])} guifg=${e.color}`;an[t]=D.createGroup(`FileIconNerdfont_${t}`,i)});var Zc=class extends dt{async loadIcons(e){var o;let r=[];for(let i of e){let n=i.isDirectory?this.getDirectoryIcon(i):this.getFileIcon(i);n&&(n.highlight=(o=an[n.name])==null?void 0:o.group,r.push({icon:n,target:i}))}return r}nerdfontToIcon(e){if(X.icons[e])return S({name:e},X.icons[e])}getFileIcon(e){let{fullname:r,basename:o,extensions:i}=e,n=i[i.length-1];if(Ze(X.filenames,o)){let s=X.filenames[o];return this.nerdfontToIcon(s)}if(Ze(X.filenames,r)){let s=X.filenames[r];return this.nerdfontToIcon(s)}let a=Object.entries(X.patternMatches).find(([s])=>new RegExp(s).test(r));if(a){let s=a[1];return this.nerdfontToIcon(s)}if(Ze(X.extensions,n)){let s=X.extensions[n];return this.nerdfontToIcon(s)}}getDirectoryIcon(e){let{basename:r,fullname:o}=e;if(Ze(X.dirnames,r)){let n=X.dirnames[r];return this.nerdfontToIcon(n)}if(Ze(X.dirnames,o)){let n=X.dirnames[o];return this.nerdfontToIcon(n)}let i=Object.entries(X.dirPatternMatches).find(([n])=>new RegExp(n).test(o));if(i){let n=i[1];return this.nerdfontToIcon(n)}}};pr("builtin",()=>new Zc);var _x=require("coc.nvim");var ef=class extends dt{escapeLuaString(e,r="'"){return e&&e.replace(/\\/g,"\\").replace(new RegExp(r,"g"),"\\'")}async loadIcons(e){let r=[];for(let o of e){if(o.isDirectory)continue;let i=o.extensions[o.extensions.length-1],n=await _x.workspace.nvim.call("luaeval",["{require'nvim-web-devicons'.get_icon(_A[1], _A[2])}",[o.fullname,i]]),[a,s]=n;!a||r.push({target:o,icon:{code:a,highlight:s}})}return r}};pr("nvim-web-devicons",()=>new ef);var Mx=require("coc.nvim");var tf=class extends dt{async loadIcons(e){let r=[];return await Promise.all(e.map(async o=>{if(o.isDirectory)return;let i=await Mx.workspace.nvim.call("WebDevIconsGetFileTypeSymbol",[o.fullname,!1]);!i||r.push({target:o,icon:{code:i}})})),r}};pr("vim-devicons",()=>new tf);var kx=require("coc.nvim");var rf=class extends dt{async loadIcons(e){let r=[];return await Promise.all(e.map(async o=>{let i=await kx.workspace.nvim.call("nerdfont#find",[o.fullname,o.isDirectory]);!i||r.push({target:o,icon:{code:i}})})),r}};pr("nerdfont.vim",()=>new rf);function qO(t){return t.map(e=>U(S({fullname:e.fullname},ya(e.fullname.toLowerCase())),{isDirectory:e.isDirectory,hidden:e.hidden,expanded:e.expanded}))}async function sn(t,e){let r=qO(e),o=Ox(t);if(!o)return;let i=await o.loadIcons(r),[n,a]=Ao(i,f=>f.target.isDirectory),s=Un(n,f=>f.target.fullname),l=Un(a,f=>f.target.fullname),c={files:new Map,directories:new Map};for(let f of e)if(Ze(s,f.fullname))c.directories.set(f.fullname,s[f.fullname].icon);else if(Ze(l,f.fullname))c.files.set(f.fullname,l[f.fullname].icon);else if(f.isDirectory){let u=f.expanded?X.icons.folderOpened.code:X.icons.folderClosed.code;c.directories.set(f.fullname,{code:u})}else{let u=f.hidden?X.icons.fileHidden.code:X.icons.file.code;c.files.set(f.fullname,{code:u})}return c}async function Rx(t,e){if(t.get("icon.enableVimDevicons"))return v.error('The configuration `explorer.icon.enableVimDevicons` has been deprecated, please use `{"explorer.icon.enableNerdFont": true, "explorer.icon.source": "vim-devicons"}` instead of it'),sn("vim-devicons",e);if(!t.get("icon.enableNerdfont"))return;let i=t.get("icon.source");return sn(i,e)}O.registerColumn("child","icon",({source:t})=>({async draw(e){let r=e.map(i=>{var n,a;return{fullname:(a=(n=i.compactedLastNode)==null?void 0:n.name)!=null?a:i.name,hidden:i.hidden,isDirectory:i.directory,expanded:i.directory?t.view.isExpanded(i):void 0}}),o=await Rx(t.config,r);return{async drawNode(i,{node:n}){var a,s,l;if(n.directory){let c=t.view.isExpanded(n)?P.directoryExpanded:P.directoryCollapsed,f=o==null?void 0:o.directories.get((s=(a=n.compactedLastNode)==null?void 0:a.name)!=null?s:n.name);f?i.add(f.code,{hl:c}):i.add(t.view.isExpanded(n)?t.icons.expanded:t.icons.collapsed,{hl:c})}else{let c=o==null?void 0:o.files.get(n.name);c&&i.add(c.code,{hl:(l=c.highlight)!=null?l:an.file})}}}}}));O.registerColumn("child","filename",({source:t,subscriptions:e})=>{let r=new ut(t.config),o=(n,a)=>{var s;return(s=r.getHighlight(n,a,["diagnosticError","diagnosticWarning","git"]))!=null?s:a?P.directory:P.filename},i=[];return r.enabledErrorStatus&&i.push("error"),r.enabledWarningStatus&&i.push("warning"),{init(){e.push(K.bindColumn(t,i),B.bindColumn(t))},draw(){return{async drawNode(n,{node:a}){n.add(a.name,{hl:o(a.fullpath,a.directory),unicode:!0})}}}}});O.registerColumn("child","linkIcon",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.symbolicLink&&e.add(t.icons.link,{hl:P.linkTarget})}}}}));O.registerColumn("child","link",()=>({draw(){return{labelVisible:({node:t})=>t.symbolicLink,async drawNode(t,{node:e}){let r=e.symbolicLink?await vh(e.fullpath).then(o=>o).catch(()=>""):"";r&&t.add(r,{hl:P.linkTarget,unicode:!0})}}}}));var Lx=_(require("path"));O.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){e.directory?t.add(Qt(e.fullpath)+Lx.default.sep,{hl:P.directory}):t.add(e.fullpath)}}}}));function VO(t){var o,i;let e="";if((o=t.parent)!=null&&o.isRoot)return e;t.nextSiblingNode===void 0?e="\u2514 ":e="\u2502 ";let r=t.parent;for(;r&&!((i=r.parent)!=null&&i.isRoot);)r.nextSiblingNode===void 0?e=`  ${e}`:e=`\u2502 ${e}`,r=r.parent;return e}O.registerColumn("child","indent",({source:t})=>({draw(){let e=t.config.get("icon.enableNerdfont"),r=(()=>{let o=t.getColumnConfig("indent.indentLine");return e&&o===void 0?!0:o})();return{drawNode(o,{node:i}){var n;r?o.add(VO(i),{hl:P.indentLine}):o.add(t.getColumnConfig("indent.chars").repeat(((n=i.level)!=null?n:0)-1))}}}}));O.registerColumn("child","clip",({source:t})=>({draw(){let e=t.getColumnConfig("clip.copy"),r=t.getColumnConfig("clip.cut");return t.config.get("icon.enableNerdfont")?(e=e!=null?e:"\uF68E",r=r!=null?r:"\uF68F"):(e=e!=null?e:"C",r=r!=null?r:"X"),{drawNode(o,{node:i}){let n=t.copiedNodes.has(i)?e:t.cutNodes.has(i)?r:"";n&&o.add(n,{hl:P.clip})}}}}));var Fx=_(Wx());O.registerColumn("child","size",()=>({draw(){return{labelVisible:({node:t})=>!t.directory,drawNode(t,{node:e}){e.lstat&&t.add((0,Fx.default)(e.lstat.size),{hl:P.size})}}}}));O.registerColumn("child","readonly",({source:t})=>({draw(){return{labelOnly:!0,labelVisible:({node:e})=>e.readonly,drawNode(e,{node:r}){r.readonly&&e.add(r.readonly?t.icons.readonly:"",{hl:P.readonly})}}}}));O.registerColumn("child","modified",({source:t,subscriptions:e})=>({async init(){t.explorer.isFloating||e.push(t.bufManager.onModifiedDebounce(r=>t.view.renderPaths(r)))},draw(){return{labelOnly:!0,labelVisible:({node:r})=>t.bufManager.modified(r.fullpath,{directory:r.directory}),drawNode(r,{node:o,nodeIndex:i}){let n=t.bufManager.modified(o.fullpath,{directory:o.directory&&!t.view.isExpanded(o)});r.add(n?"+":"",{hl:P.readonly}),n?t.locator.mark.add("modified",i):t.locator.mark.remove("modified",i)}}}}));function he(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function j(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function ne(t){j(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function of(t,e){j(2,arguments);var r=ne(t).getTime(),o=he(e);return new Date(r+o)}function nf(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function af(t){return j(1,arguments),t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function sf(t){if(j(1,arguments),!af(t)&&typeof t!="number")return!1;var e=ne(t);return!isNaN(Number(e))}var QO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},JO=function(t,e,r){var o,i=QO[t];return typeof i=="string"?o=i:e===1?o=i.one:o=i.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+o:o+" ago":o},jx=JO;function ln(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,o=t.formats[r]||t.formats[t.defaultWidth];return o}}var ZO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},e1={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},t1={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},r1={date:ln({formats:ZO,defaultWidth:"full"}),time:ln({formats:e1,defaultWidth:"full"}),dateTime:ln({formats:t1,defaultWidth:"full"})},Hx=r1;var o1={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},i1=function(t,e,r,o){return o1[t]},$x=i1;function Qr(t){return function(e,r){var o=r||{},i=o.context?String(o.context):"standalone",n;if(i==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=o.width?String(o.width):a;n=t.formattingValues[s]||t.formattingValues[a]}else{var l=t.defaultWidth,c=o.width?String(o.width):t.defaultWidth;n=t.values[c]||t.values[l]}var f=t.argumentCallback?t.argumentCallback(e):e;return n[f]}}var n1={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},a1={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},s1={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},l1={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},c1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},f1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},u1=function(t,e){var r=Number(t),o=r%100;if(o>20||o<10)switch(o%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},d1={ordinalNumber:u1,era:Qr({values:n1,defaultWidth:"wide"}),quarter:Qr({values:a1,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Qr({values:s1,defaultWidth:"wide"}),day:Qr({values:l1,defaultWidth:"wide"}),dayPeriod:Qr({values:c1,defaultWidth:"wide",formattingValues:f1,defaultFormattingWidth:"wide"})},Gx=d1;function Jr(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.width,i=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],n=e.match(i);if(!n)return null;var a=n[0],s=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(s)?m1(s,function(u){return u.test(a)}):p1(s,function(u){return u.test(a)}),c;c=t.valueCallback?t.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var f=e.slice(a.length);return{value:c,rest:f}}}function p1(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function m1(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function lf(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=e.match(t.matchPattern);if(!o)return null;var i=o[0],n=e.match(t.parsePattern);if(!n)return null;var a=t.valueCallback?t.valueCallback(n[0]):n[0];a=r.valueCallback?r.valueCallback(a):a;var s=e.slice(i.length);return{value:a,rest:s}}}var h1=/^(\d+)(th|st|nd|rd)?/i,g1=/\d+/i,w1={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},x1={any:[/^b/i,/^(a|c)/i]},b1={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},y1={any:[/1/i,/2/i,/3/i,/4/i]},v1={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},E1={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},N1={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},T1={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},S1={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},C1={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},I1={ordinalNumber:lf({matchPattern:h1,parsePattern:g1,valueCallback:function(t){return parseInt(t,10)}}),era:Jr({matchPatterns:w1,defaultMatchWidth:"wide",parsePatterns:x1,defaultParseWidth:"any"}),quarter:Jr({matchPatterns:b1,defaultMatchWidth:"wide",parsePatterns:y1,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Jr({matchPatterns:v1,defaultMatchWidth:"wide",parsePatterns:E1,defaultParseWidth:"any"}),day:Jr({matchPatterns:N1,defaultMatchWidth:"wide",parsePatterns:T1,defaultParseWidth:"any"}),dayPeriod:Jr({matchPatterns:S1,defaultMatchWidth:"any",parsePatterns:C1,defaultParseWidth:"any"})},Ux=I1;var O1={code:"en-US",formatDistance:jx,formatLong:Hx,formatRelative:$x,localize:Gx,match:Ux,options:{weekStartsOn:0,firstWeekContainsDate:1}},qx=O1;function cf(t,e){j(2,arguments);var r=he(e);return of(t,-r)}var P1=864e5;function ff(t){j(1,arguments);var e=ne(t),r=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var o=e.getTime(),i=r-o;return Math.floor(i/P1)+1}function hr(t){j(1,arguments);var e=1,r=ne(t),o=r.getUTCDay(),i=(o<e?7:0)+o-e;return r.setUTCDate(r.getUTCDate()-i),r.setUTCHours(0,0,0,0),r}function cn(t){j(1,arguments);var e=ne(t),r=e.getUTCFullYear(),o=new Date(0);o.setUTCFullYear(r+1,0,4),o.setUTCHours(0,0,0,0);var i=hr(o),n=new Date(0);n.setUTCFullYear(r,0,4),n.setUTCHours(0,0,0,0);var a=hr(n);return e.getTime()>=i.getTime()?r+1:e.getTime()>=a.getTime()?r:r-1}function uf(t){j(1,arguments);var e=cn(t),r=new Date(0);r.setUTCFullYear(e,0,4),r.setUTCHours(0,0,0,0);var o=hr(r);return o}var A1=6048e5;function df(t){j(1,arguments);var e=ne(t),r=hr(e).getTime()-uf(e).getTime();return Math.round(r/A1)+1}function gr(t,e){j(1,arguments);var r=e||{},o=r.locale,i=o&&o.options&&o.options.weekStartsOn,n=i==null?0:he(i),a=r.weekStartsOn==null?n:he(r.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=ne(t),l=s.getUTCDay(),c=(l<a?7:0)+l-a;return s.setUTCDate(s.getUTCDate()-c),s.setUTCHours(0,0,0,0),s}function fn(t,e){j(1,arguments);var r=ne(t),o=r.getUTCFullYear(),i=e||{},n=i.locale,a=n&&n.options&&n.options.firstWeekContainsDate,s=a==null?1:he(a),l=i.firstWeekContainsDate==null?s:he(i.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var c=new Date(0);c.setUTCFullYear(o+1,0,l),c.setUTCHours(0,0,0,0);var f=gr(c,e),u=new Date(0);u.setUTCFullYear(o,0,l),u.setUTCHours(0,0,0,0);var d=gr(u,e);return r.getTime()>=f.getTime()?o+1:r.getTime()>=d.getTime()?o:o-1}function pf(t,e){j(1,arguments);var r=e||{},o=r.locale,i=o&&o.options&&o.options.firstWeekContainsDate,n=i==null?1:he(i),a=r.firstWeekContainsDate==null?n:he(r.firstWeekContainsDate),s=fn(t,e),l=new Date(0);l.setUTCFullYear(s,0,a),l.setUTCHours(0,0,0,0);var c=gr(l,e);return c}var _1=6048e5;function mf(t,e){j(1,arguments);var r=ne(t),o=gr(r,e).getTime()-pf(r,e).getTime();return Math.round(o/_1)+1}function W(t,e){for(var r=t<0?"-":"",o=Math.abs(t).toString();o.length<e;)o="0"+o;return r+o}var M1={y:function(t,e){var r=t.getUTCFullYear(),o=r>0?r:1-r;return W(e==="yy"?o%100:o,e.length)},M:function(t,e){var r=t.getUTCMonth();return e==="M"?String(r+1):W(r+1,2)},d:function(t,e){return W(t.getUTCDate(),e.length)},a:function(t,e){var r=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(t,e){return W(t.getUTCHours()%12||12,e.length)},H:function(t,e){return W(t.getUTCHours(),e.length)},m:function(t,e){return W(t.getUTCMinutes(),e.length)},s:function(t,e){return W(t.getUTCSeconds(),e.length)},S:function(t,e){var r=e.length,o=t.getUTCMilliseconds(),i=Math.floor(o*Math.pow(10,r-3));return W(i,e.length)}},Ot=M1;var fi={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},k1={G:function(t,e,r){var o=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(o,{width:"abbreviated"});case"GGGGG":return r.era(o,{width:"narrow"});case"GGGG":default:return r.era(o,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){var o=t.getUTCFullYear(),i=o>0?o:1-o;return r.ordinalNumber(i,{unit:"year"})}return Ot.y(t,e)},Y:function(t,e,r,o){var i=fn(t,o),n=i>0?i:1-i;if(e==="YY"){var a=n%100;return W(a,2)}return e==="Yo"?r.ordinalNumber(n,{unit:"year"}):W(n,e.length)},R:function(t,e){var r=cn(t);return W(r,e.length)},u:function(t,e){var r=t.getUTCFullYear();return W(r,e.length)},Q:function(t,e,r){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(o);case"QQ":return W(o,2);case"Qo":return r.ordinalNumber(o,{unit:"quarter"});case"QQQ":return r.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,e,r){var o=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(o);case"qq":return W(o,2);case"qo":return r.ordinalNumber(o,{unit:"quarter"});case"qqq":return r.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,e,r){var o=t.getUTCMonth();switch(e){case"M":case"MM":return Ot.M(t,e);case"Mo":return r.ordinalNumber(o+1,{unit:"month"});case"MMM":return r.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(o,{width:"wide",context:"formatting"})}},L:function(t,e,r){var o=t.getUTCMonth();switch(e){case"L":return String(o+1);case"LL":return W(o+1,2);case"Lo":return r.ordinalNumber(o+1,{unit:"month"});case"LLL":return r.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(o,{width:"wide",context:"standalone"})}},w:function(t,e,r,o){var i=mf(t,o);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):W(i,e.length)},I:function(t,e,r){var o=df(t);return e==="Io"?r.ordinalNumber(o,{unit:"week"}):W(o,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):Ot.d(t,e)},D:function(t,e,r){var o=ff(t);return e==="Do"?r.ordinalNumber(o,{unit:"dayOfYear"}):W(o,e.length)},E:function(t,e,r){var o=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return r.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(o,{width:"short",context:"formatting"});case"EEEE":default:return r.day(o,{width:"wide",context:"formatting"})}},e:function(t,e,r,o){var i=t.getUTCDay(),n=(i-o.weekStartsOn+8)%7||7;switch(e){case"e":return String(n);case"ee":return W(n,2);case"eo":return r.ordinalNumber(n,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,o){var i=t.getUTCDay(),n=(i-o.weekStartsOn+8)%7||7;switch(e){case"c":return String(n);case"cc":return W(n,e.length);case"co":return r.ordinalNumber(n,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){var o=t.getUTCDay(),i=o===0?7:o;switch(e){case"i":return String(i);case"ii":return W(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(o,{width:"short",context:"formatting"});case"iiii":default:return r.day(o,{width:"wide",context:"formatting"})}},a:function(t,e,r){var o=t.getUTCHours(),i=o/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){var o=t.getUTCHours(),i;switch(o===12?i=fi.noon:o===0?i=fi.midnight:i=o/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){var o=t.getUTCHours(),i;switch(o>=17?i=fi.evening:o>=12?i=fi.afternoon:o>=4?i=fi.morning:i=fi.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){var o=t.getUTCHours()%12;return o===0&&(o=12),r.ordinalNumber(o,{unit:"hour"})}return Ot.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Ot.H(t,e)},K:function(t,e,r){var o=t.getUTCHours()%12;return e==="Ko"?r.ordinalNumber(o,{unit:"hour"}):W(o,e.length)},k:function(t,e,r){var o=t.getUTCHours();return o===0&&(o=24),e==="ko"?r.ordinalNumber(o,{unit:"hour"}):W(o,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Ot.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Ot.s(t,e)},S:function(t,e){return Ot.S(t,e)},X:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return Yx(n);case"XXXX":case"XX":return Zr(n);case"XXXXX":case"XXX":default:return Zr(n,":")}},x:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"x":return Yx(n);case"xxxx":case"xx":return Zr(n);case"xxxxx":case"xxx":default:return Zr(n,":")}},O:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Vx(n,":");case"OOOO":default:return"GMT"+Zr(n,":")}},z:function(t,e,r,o){var i=o._originalDate||t,n=i.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Vx(n,":");case"zzzz":default:return"GMT"+Zr(n,":")}},t:function(t,e,r,o){var i=o._originalDate||t,n=Math.floor(i.getTime()/1e3);return W(n,e.length)},T:function(t,e,r,o){var i=o._originalDate||t,n=i.getTime();return W(n,e.length)}};function Vx(t,e){var r=t>0?"-":"+",o=Math.abs(t),i=Math.floor(o/60),n=o%60;if(n===0)return r+String(i);var a=e||"";return r+String(i)+a+W(n,2)}function Yx(t,e){if(t%60===0){var r=t>0?"-":"+";return r+W(Math.abs(t)/60,2)}return Zr(t,e)}function Zr(t,e){var r=e||"",o=t>0?"-":"+",i=Math.abs(t),n=W(Math.floor(i/60),2),a=W(i%60,2);return o+n+r+a}var zx=k1;function Kx(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}}function Xx(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}}function R1(t,e){var r=t.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return Kx(t,e);var n;switch(o){case"P":n=e.dateTime({width:"short"});break;case"PP":n=e.dateTime({width:"medium"});break;case"PPP":n=e.dateTime({width:"long"});break;case"PPPP":default:n=e.dateTime({width:"full"});break}return n.replace("{{date}}",Kx(o,e)).replace("{{time}}",Xx(i,e))}var L1={p:Xx,P:R1},Qx=L1;var D1=["D","DD"],B1=["YY","YYYY"];function Jx(t){return D1.indexOf(t)!==-1}function Zx(t){return B1.indexOf(t)!==-1}function hf(t,e,r){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"))}var W1=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,F1=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,j1=/^'([^]*?)'?$/,H1=/''/g,$1=/[a-zA-Z]/;function wr(t,e,r){j(2,arguments);var o=String(e),i=r||{},n=i.locale||qx,a=n.options&&n.options.firstWeekContainsDate,s=a==null?1:he(a),l=i.firstWeekContainsDate==null?s:he(i.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var c=n.options&&n.options.weekStartsOn,f=c==null?0:he(c),u=i.weekStartsOn==null?f:he(i.weekStartsOn);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!n.localize)throw new RangeError("locale must contain localize property");if(!n.formatLong)throw new RangeError("locale must contain formatLong property");var d=ne(t);if(!sf(d))throw new RangeError("Invalid time value");var p=nf(d),m=cf(d,p),h={firstWeekContainsDate:l,weekStartsOn:u,locale:n,_originalDate:d},g=o.match(F1).map(function(x){var b=x[0];if(b==="p"||b==="P"){var T=Qx[b];return T(x,n.formatLong,h)}return x}).join("").match(W1).map(function(x){if(x==="''")return"'";var b=x[0];if(b==="'")return G1(x);var T=zx[b];if(T)return!i.useAdditionalWeekYearTokens&&Zx(x)&&hf(x,e,t),!i.useAdditionalDayOfYearTokens&&Jx(x)&&hf(x,e,t),T(m,x,n.localize,h);if(b.match($1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return x}).join("");return g}function G1(t){return t.match(j1)[1].replace(H1,"'")}O.registerColumn("child","timeModified",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat&&e.add(wr(r.lstat.mtime,t.config.get("datetime.format")),{hl:P.timeModified})}}}}));O.registerColumn("child","timeCreated",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat&&e.add(wr(r.lstat.ctime,t.config.get("datetime.format")),{hl:P.timeCreated})}}}}));O.registerColumn("child","timeAccessed",({source:t})=>({draw(){return{drawNode(e,{node:r}){r.lstat?e.add(wr(r.lstat.atime,t.config.get("datetime.format")),{hl:P.timeAccessed}):e.add("                 ")}}}}));var xr=t=>({displayMax:t.get("diagnostic.displayMax"),enableSubscriptNumber:t.get("diagnostic.enableSubscriptNumber")}),br=(t,e)=>t>e.displayMax?"\u2717":e.enableSubscriptNumber?tu(t):t.toString();O.registerColumn("child","diagnosticError",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["error"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedError(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedError(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:P.diagnosticError});return}!a||i.directory&&t.view.isExpanded(i)||o.add(br(a,r),{hl:P.diagnosticError})}}}}});O.registerColumn("child","diagnosticWarning",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["warning"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedWarning(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedWarning(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:P.diagnosticWarning});return}!a||i.expandable&&t.view.isExpanded(i)||o.add(br(a,r),{hl:P.diagnosticWarning})}}}}});var ie=D.linkGroup.bind(D),gf=ie("FileDirectory","Directory"),P={title:ie("FileRoot","Constant"),hidden:ie("FileHidden",Ee.CommentColor),rootName:ie("FileRootName","Identifier"),expandIcon:ie("FileExpandIcon","Directory"),fullpath:ie("FileFullpath",Ee.CommentColor),filename:ie("FileFilename","None"),directory:gf,directoryExpanded:ie("FileDirectoryExpanded",gf.group),directoryCollapsed:ie("FileDirectoryCollapsed",gf.group),linkTarget:ie("FileLinkTarget",Ee.CommentColor),indentLine:ie("IndentLine",Ee.CommentColor),clip:ie("FileClip","Statement"),size:ie("FileSize","Constant"),readonly:ie("FileReadonly","Operator"),modified:ie("FileModified","Operator"),timeAccessed:ie("TimeAccessed","Identifier"),timeModified:ie("TimeModified","Identifier"),timeCreated:ie("TimeCreated","Identifier"),diagnosticError:ie("FileDiagnosticError",It.diagnosticError.group),diagnosticWarning:ie("FileDiagnosticWarning",It.diagnosticWarning.group),filenameDiagnosticError:ie("FileFilenameDiagnosticError","CocErrorSign"),filenameDiagnosticWarning:ie("FileFilenameDiagnosticWarning","CocWarningSign")},wf=class extends cr{constructor(){super(...arguments);this.scheme="file";this.showHidden=this.config.get("file.showHiddenFiles");this.showOnlyGitChange=!1;this.copiedNodes=new Set;this.cutNodes=new Set;this.view=new lr(this,O,{type:"root",isRoot:!0,uid:this.helper.getUid(Os.default.sep),name:"root",fullpath:(0,eb.homedir)(),expandable:!0,directory:!0,readonly:!0,executable:!1,readable:!0,writable:!0,hidden:!1,symbolicLink:!0,lstat:void 0});this.rootStrategies=[]}get root(){return this.view.rootNode.fullpath}set root(r){this.view.rootNode.uid=this.helper.getUid(r),this.view.rootNode.fullpath=r,this.view.rootNode.children=void 0}getHiddenRules(){return this.config.get("file.hiddenRules")}isHidden(r){let o=this.getHiddenRules(),{basename:i,extensions:n}=ya(r),a=n[n.length-1];return o.filenames.includes(i)||o.extensions.includes(a)||o.patternMatches.some(s=>new RegExp(s).test(r))}isGitChange(r,o){return!!B.getMixedStatus(`${r.fullpath}/${o}`,!1)}getColumnConfig(r,o){return this.config.get(`file.column.${r}`,o)}async init(){Dl(this.config)&&this.disposables.push(Vr(async r=>{r!==this.explorer.bufnr&&(!this.explorer.visible()||this.explorer.isFloating||await this.view.sync(async o=>{var s;let i=(s=this.bufManager.getBufferNode(r))==null?void 0:s.fullpath;if(!i)return;let[n,a]=await this.revealNodeByPathNotifier(o,i);n&&await E.runAll(a)}))},200)),this.disposables.push(this.events.on("loaded",()=>{this.copiedNodes.clear(),this.cutNodes.clear()})),Sx(this.action)}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(nn.fileRootTemplate),await this.explorer.args.value(nn.fileRootLabelingTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(nn.fileChildTemplate),await this.explorer.args.value(nn.fileChildLabelingTemplate)),this.root=this.explorer.root,this.rootStrategies=this.explorer.argValues.rootStrategies}async cd(r){let{nvim:o}=this,i=await o.call("fnameescape",r),n,a=this.config.get("file.tabCD");a!==void 0?(v.error("explorer.file.tabCD has been deprecated, please use explorer.file.cdCommand instead of it"),a?n="tcd":n="cd"):n=this.config.get("file.cdCommand"),n==="tcd"?(eo.workspace.isNvim||await o.call("exists",[":tcd"]))&&(await o.command(`tcd ${i}`),eo.window.showMessage(`Tab's CWD is: ${r}`)):n==="cd"&&(await o.command(`cd ${i}`),eo.window.showMessage(`CWD is: ${r}`))}async openedNotifier(r,o){let i=this.explorer.args,n=await this.explorer.revealPath();if(!n)return o?this.locator.gotoRootNotifier({col:1}):E.noop();let a=i.has(Ae.reveal);if(Dl(this.config)||ma(this.config,this.explorer.argValues.revealWhenOpen)||a){let[s,l]=await this.revealNodeByPathNotifier(r,n);if(s!==void 0)return E.combine(l);if(o)return E.combine([...l,await this.locator.gotoRootNotifier({col:1})])}else if(o)return this.locator.gotoRootNotifier({col:1});return E.noop()}getPutTargetNode(r){return r.isRoot?this.view.rootNode:r.expandable&&this.view.isExpanded(r)?r:r.parent?r.parent:this.view.rootNode}getPutTargetDir(r){return this.getPutTargetNode(r).fullpath}async searchByCocList(r,{recursive:o,noIgnore:i,strict:n}){var l;let a=n?["--strict"]:[],s=await Gr(this.explorer,sx,{showHidden:this.showHidden,showIgnores:i,rootPath:r,recursive:o,revealCallback:async c=>{await s.waitExplorerShow(),await this.view.sync(async f=>{let[,u]=await this.revealNodeByPathNotifier(f,eo.Uri.parse(c.uri).fsPath);await E.runAll(u)})}},a);(l=s.waitExplorerShow())==null||l.catch(v.error)}filterForReveal(r,o){var a,s;let i=this.config.get("file.reveal.filter"),n=r.slice(o.length);for(let l of(a=i.literals)!=null?a:[])if(n.includes(l))return!0;for(let l of(s=i.patterns)!=null?s:[])if(new RegExp(l).test(n))return!0;return!1}async revealNodeByPathNotifier(r,o,{startNode:i=this.view.rootNode,goto:n=!0,render:a=!0,compact:s}={}){if(o=le(o),this.filterForReveal(o,i.fullpath))return[void 0,[]];let l=[],c=async(u,{startNode:d,goto:p,render:m})=>{if(u===d.fullpath)return d;if(d.directory&&u.startsWith(d.fullpath+Os.default.sep)){let h,g=m&&!this.view.isExpanded(d);d.children||(d.children=await this.loadInitedChildren(d));for(let x of d.children)if(h=await c(u,{startNode:x,goto:!1,render:g?!1:m}),h){await this.view.expand(d,{compact:s,uncompact:!1,render:!1});break}if(h){if(g){let x=await r.renderNotifier({node:d});x&&l.push(x)}p&&(l.push(await this.locator.gotoNodeNotifier(h)),l.push(E.create(()=>this.nvim.command("redraw!",!0))))}return h}};return[await c(o,{startNode:i,goto:n,render:a}),l]}sortFiles(r){return r.sort((o,i)=>o.directory&&!i.directory?-1:i.directory&&!o.directory?1:o.name.localeCompare(i.name))}async loadChildren(r){let o;We&&r.fullpath===""?o=await ba():o=await Fo(r.fullpath);let i=await Promise.all(o.map(async n=>{try{if(this.showOnlyGitChange&&!this.isGitChange(r,n))return;let a=this.isHidden(n);if(!this.showHidden&&a)return;let s=le(Os.default.join(r.fullpath,n)),l=await Dr(s).catch(()=>{}),c=await Lr(s).catch(()=>{}),f=await Bi(s,Is.default.constants.X_OK),u=await Bi(s,Is.default.constants.W_OK),d=await Bi(s,Is.default.constants.R_OK),p=We&&/^[A-Za-z]:[\\/]$/.test(s)?!0:l?l.isDirectory():!1;return{type:"child",uid:this.helper.getUid(s),expandable:p,name:n,fullpath:s,directory:p,readonly:!u&&d,executable:f,readable:d,writable:u,hidden:a,symbolicLink:c?c.isSymbolicLink():!1,lstat:c||void 0}}catch(a){v.error(a)}}));return this.sortFiles(i.filter(n=>!!n))}};Ct.registerSource("file",wf);var ut=class{constructor(e){let r="filename.colored.enable",o=e.get(r,!1)===!0;this.enabledGitStatus=o||e.get(`${r}.git`,!1),this.enabledErrorStatus=o||e.get(`${r}.diagnosticError`,!1),this.enabledWarningStatus=o||e.get(`${r}.diagnosticWarning`,!1)}getGitHighlight(e){return e.x==="!"?me.ignored:Zw(e.y)}getHighlight(e,r,o){for(let i of o)if(i==="diagnosticWarning"){if(this.enabledWarningStatus&&K.getMixedWarning(e))return P.diagnosticWarning}else if(i==="diagnosticError"){if(this.enabledErrorStatus&&K.getMixedError(e))return P.diagnosticError}else if(i==="git"&&this.enabledGitStatus){let n=B.getMixedStatus(e,r);if(n)return this.getGitHighlight(n)}}};V.registerColumn("child","git",({source:t,subscriptions:e})=>{let r=new ut(t.config),o=Es(t.config),i=(n,a)=>{var s;return a?me.staged:(s=r.getHighlight(n,!1,["git"]))!=null?s:me.unstaged};return{init(){e.push(B.bindColumn(t))},async available(){return await B.cmd.available()},async draw(){return{async labelVisible({node:n}){let a=B.getMixedStatus(n.fullpath,!1);return a?a.x!==" "||a.y!==" ":!1},drawNode(n,{node:a,nodeIndex:s,isLabeling:l}){let c=(u,d)=>{let p=i(a.fullpath,d);l?n.add(`${o[u].name}(${o[u].icon})`,{hl:p}):n.add(o[u].icon,{hl:p})},f=B.getMixedStatus(a.fullpath,!1);f?(c(f.x,!0),l&&n.add(" "),c(f.y,!1),f.x==="!"?(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s)):(t.locator.mark.add("git",s),f.x!==" "?t.locator.mark.add("gitStaged",s):t.locator.mark.remove("gitStaged",s),f.y!==" "?t.locator.mark.add("gitUnstaged",s):t.locator.mark.remove("gitUnstaged",s))):(t.locator.mark.remove("git",s),t.locator.mark.remove("gitStaged",s),t.locator.mark.remove("gitUnstaged",s))}}}}});V.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));V.registerColumn("child","name",({source:t})=>{let e=new ut(t.config),r=(o,i)=>{var n;return(n=e.getHighlight(o,!1,["diagnosticError","diagnosticWarning","git"]))!=null?n:i?be.nameVisible:void 0};return{draw(){return{drawNode(o,{node:i}){o.add(i.name,{hl:r(i.fullpath,i.visible)})}}}}});V.registerColumn("child","bufname",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.bufname,{hl:be.bufname})}}}}));V.registerColumn("child","modified",({source:t})=>({draw(){return{labelVisible({node:e}){return e.modified||!e.modifiable},drawNode(e,{node:r,nodeIndex:o}){let i=r.modified?"+":r.modifiable?"":"-";i&&e.add(i,{hl:be.modified}),r.modified?t.locator.mark.add("modified",o):t.locator.mark.remove("modified",o)}}}}));V.registerColumn("child","bufnr",()=>{let t=0;return{draw(e,{drawAll:r,abort:o}){let i=Po(e.map(n=>n.bufnrStr.length));return i?(t!==i&&(t=i,r()),{drawNode(n,{node:a}){n.add(a.bufnrStr.padStart(t),{hl:be.bufnr})}}):o()}}});V.registerColumn("child","diagnosticError",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["error"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedError(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedError(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:It.diagnosticError});return}!a||o.add(br(a,r),{hl:It.diagnosticError})}}}}});V.registerColumn("child","diagnosticWarning",({source:t,subscriptions:e})=>{let r=xr(t.config);return{init(){e.push(K.bindColumn(t,["warning"]))},draw(){return{labelVisible:({node:o})=>!!K.getMixedWarning(o.fullpath),drawNode(o,{node:i,isLabeling:n}){let a=K.getMixedWarning(i.fullpath);if(n){o.add((a!=null?a:0).toString(),{hl:It.diagnosticWarning});return}!a||o.add(br(a,r),{hl:It.diagnosticWarning})}}}}});V.registerColumn("child","readonly",({source:t})=>({draw(){return{labelOnly:!0,labelVisible:({node:e})=>e.readonly,drawNode(e,{node:r}){r.readonly&&e.add(r.readonly?t.icons.readonly:"",{hl:be.readonly})}}}}));V.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){t.add(Qt(e.fullpath),{hl:be.fullpath})}}}}));var Pt=D.linkGroup.bind(D),be={title:Pt("BufferRoot","Constant"),hidden:Pt("BufferHidden",Ee.CommentColor),expandIcon:Pt("BufferExpandIcon","Directory"),nameVisible:Pt("BufferNameVisible","String"),bufname:Pt("BufferBufname",Ee.CommentColor),modified:Pt("BufferModified","Operator"),bufnr:Pt("BufferBufnr","Special"),readonly:Pt("BufferReadonly","Operator"),fullpath:Pt("BufferFullpath",Ee.CommentColor)},xf=class extends cr{constructor(){super(...arguments);this.showHidden=this.config.get("file.showHiddenBuffers");this.view=new lr(this,V,{type:"root",isRoot:!0,expandable:!0,uid:this.helper.getUid("0"),bufnr:0,bufnrStr:"0",bufname:"",fullpath:"",name:"",unlisted:!0,current:!1,previous:!1,visible:!1,hidden:!1,modifiable:!1,readonly:!0,terminal:!1,modified:!1,readErrors:!1})}async init(){this.disposables.push(this.bufManager.onReloadDebounce(async()=>{!this.explorer.visible()||await this.load(this.view.rootNode)}),this.bufManager.onModifiedDebounce(async()=>{!this.explorer.visible()||await this.load(this.view.rootNode)})),this.tabId=await oe.currentTabId(),Vw(this.action)}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(vs.bufferRootTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(vs.bufferChildTemplate),await this.explorer.args.value(vs.bufferChildLabelingTemplate))}async loadChildren(r,{force:o=!1}={}){o&&await this.bufManager.reload();let i=pa(),n=this.bufManager.bufferNodes;if(this.showHidden)return[...n];if(i){let a=this.tabId?oe.get(this.tabId):await oe.currentTabContainer(),s=[];return a!=null&&a.bufnrs&&(s=[...a.bufnrs]),n.filter(l=>s.includes(l.bufnr)&&!l.unlisted)}else return n.filter(a=>!a.unlisted)}};Ct.registerSource("buffer",xf);var yr=require("coc.nvim"),vf=_(require("path"));var Ps={bookmarkRootTemplate:R.registerOption("bookmark-root-template",{getDefault:()=>C.get("bookmark.root.template")}),bookmarkChildTemplate:R.registerOption("bookmark-child-template",{getDefault:()=>C.get("bookmark.child.template")}),bookmarkChildLabelingTemplate:R.registerOption("bookmark-child-labeling-template",{getDefault:()=>C.get("bookmark.child.labelingTemplate")})};var bf=class extends fr{},ce=new bf;ce.registerColumn("root","icon",({source:t})=>({draw(){return{drawNode(e,{node:r}){e.add(t.view.isExpanded(r)?t.icons.expanded:t.icons.collapsed,{hl:Te.expandIcon})}}}}));ce.registerColumn("root","title",()=>({draw(){return{drawNode(t){t.add("[BOOKMARK]",{hl:Te.title})}}}}));ce.registerColumn("root","hidden",({source:t})=>({draw(){return{drawNode(e){e.add(t.showHidden?t.icons.hidden:"",{hl:Te.hidden})}}}}));ce.registerColumn("child","selection",({source:t})=>({draw(){return{drawNode(e,{node:r}){t.isSelectedNode(r)&&e.add(t.icons.selected)}}}}));ce.registerColumn("child","position",()=>({draw(){return{drawNode(t,{node:e}){t.add(`line: ${e.lnum}`,{hl:Te.position})}}}}));ce.registerColumn("child","filename",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.name,{hl:Te.filename})}}}}));ce.registerColumn("child","fullpath",()=>({draw(){return{drawNode(t,{node:e}){t.add(Qt(e.fullpath),{hl:Te.fullpath})}}}}));ce.registerColumn("child","line",()=>({draw(){return{drawNode(t,{node:e}){t.add(e.line,{hl:Te.line})}}}}));ce.registerColumn("child","annotation",()=>({draw(){return{drawNode(t,{node:e}){e.annotation&&t.add(e.annotation,{hl:Te.annotation})}}}}));var yf=_(require("path"));var un=class{constructor(e){this.filepath=e}async load(){let e=yf.default.dirname(this.filepath),r=await Dr(e).catch(()=>null);if(!r||!r.isDirectory())return{};try{let o=await Eh(this.filepath,{encoding:"utf8"});return JSON.parse(o.trim())}catch{return{}}}async fetch(e){let r=await this.load();if(!e)return r;let o=e.split(".");for(let i of o){if(typeof r[i]>"u")return;r=r[i]}return r}async exists(e){let r=await this.load(),o=e.split(".");for(let i of o){if(typeof r[i]>"u")return!1;r=r[i]}return!0}async push(e,r){let o=await this.load()||{},i=o,n=e.split("."),a=n.length;if(i===null){let s=yf.default.dirname(this.filepath);await Wo(s),i=o}for(let s=0;s<a;s++){let l=n[s];if(s===a-1){i[l]=r,await ga(this.filepath,JSON.stringify(o,null,2));break}typeof i[l]>"u"&&(i[l]={}),i=i[l]}}async delete(e){let r=await this.load(),o=r,i=e.split("."),n=i.length;for(let a=0;a<n&&!(typeof r[i[a]]>"u");a++){if(a===n-1){delete r[i[a]],await ga(this.filepath,JSON.stringify(o,null,2));break}r=r[i[a]]}}async clear(){let e=await Dr(this.filepath).catch(()=>null);!e||!e.isFile()||await ga(this.filepath,"{}")}};function tb(t){return decodeURIComponent(t)}var to=D.linkGroup.bind(D),Te={title:to("BookmarkRoot","Constant"),hidden:to("BookmarkHidden","Commment"),expandIcon:to("BookmarkExpandIcon","Directory"),filename:to("BookmarkFilename","String"),fullpath:to("BookmarkFullpath","Special"),position:to("BookmarkPosition","Comment"),line:D.createGroup("BookmarkLine","ctermbg=27 ctermfg=0 guibg=#1593e5 guifg=#ffffff"),annotation:to("BookmarkAnnotation","Comment")},Ef=class extends cr{constructor(){super(...arguments);this.view=new lr(this,ce,{type:"root",isRoot:!0,expandable:!0,uid:this.helper.getUid("0"),name:"",fullpath:"",lnum:-1,line:"",annotation:void 0})}static get enabled(){return yr.extensions.getExtensionState("coc-bookmark")==="activated"}async init(){this.disposables.push(lt.on("CocBookmarkChange",$a(500,async()=>{await this.load(this.view.rootNode)})))}async open(){await this.view.parseTemplate("root",await this.explorer.args.value(Ps.bookmarkRootTemplate)),await this.view.parseTemplate("child",await this.explorer.args.value(Ps.bookmarkChildTemplate),await this.explorer.args.value(Ps.bookmarkChildLabelingTemplate)),this.view.rootNode.fullpath=this.explorer.root}async loadChildren(r){var l;let o=yr.workspace.env.extensionRoot,i=vf.default.join(o,"coc-bookmark-data/bookmark.json"),a=await new un(i).load(),s=[];for(let[c,f]of Object.entries(a)){let u=le(tb(c));if(!(!this.showHidden&&!u.startsWith(r.fullpath)||!await wa(u)))for(let d of Object.keys(f).map(p=>Number(p)).sort((p,m)=>p-m)){let p=f[d];s.push({type:"child",uid:this.helper.getUid(`${u}:${d}`),fullpath:u,name:vf.default.basename(u),lnum:d,location:yr.Location.create(u,yr.Range.create(d,-1,d,-1)),line:p.line,annotation:(l=p.annotation)==null?void 0:l.toString()})}}return s}};Ct.registerSource("bookmark",Ef);var As=class{constructor(e){this.explorer=e;this.isHelpUI=!1;this.currentLineIndex=0;this[si]=new hs(this)}async sync(e){return await e(this[si])}get flattenedNodes(){return this.explorer.sources.reduce((e,r)=>e.concat(r.view.flattenedNodes),[])}async refreshLineIndex(){let e=await this.explorer.win;if(e){let r=await e.cursor;this.currentLineIndex=r[0]-1}}async currentSource(){return this.explorer.sources[await this.currentSourceIndex()]}async currentSourceIndex(){let e=this.currentLineIndex;return this.explorer.sources.findIndex(r=>e>=r.view.startLineIndex&&e<r.view.endLineIndex)}async currentNode(){let e=await this.currentSource();if(e){let r=this.currentLineIndex-e.view.startLineIndex;return e.view.flattenedNodes[r]}}async emitRequestRenderNodes(){await this.sync(async e=>{let r=await Promise.all(e.rendererSources().map(o=>o.emitRequestRenderNodesNotifier()));await E.runAll(r)})}};si;var pt=class{constructor(e,r,o,i,n){this.explorerID=e;this.explorerManager=r;this.bufnr=o;this.borderBufnr=i;this.config=n;this.nvim=Ue.workspace.nvim;this.contentWidth=0;this.action=new Za(this);this.highlight=new ss(this);this.view=new As(this);this.locator=new fs(this);this.events=new ht(v);this.firstOpened=!1;this.disposables=[];this.isHide=!1;this.context=r.context,this.buffer=this.nvim.createBuffer(this.bufnr),this.inited=new Qo("inited",this.buffer),this.sourceWinid=new Qo("sourceWinid",this.buffer),this.sourceBufnr=new Qo("sourceBufnr",this.buffer),this.floatingPreview=new ns(this),i&&this.disposables.push(Fe("BufWinLeave",async a=>{a===o&&await Ul([i]).run()})),Nw(this.action)}static genExplorerPosition(e,r){var s,l,c;let o=0,i=0,n=0,a=0;if(e.position.name!=="floating")o=(s=r==null?void 0:r[0])!=null?s:e.width;else{o=(l=r==null?void 0:r[0])!=null?l:e.floatingWidth,i=(c=r==null?void 0:r[1])!=null?c:e.floatingHeight;let[f,u]=[Ue.workspace.env.columns,Ue.workspace.env.lines-Ue.workspace.env.cmdheight];o<=0&&(o=f+o),i<=0&&(i=u+i);let d=e.floatingPosition;d==="left-center"?(n=0,a=(u-i)/2):d==="center"?(n=(f-o)/2,a=(u-i)/2):d==="right-center"?(n=f-o,a=(u-i)/2):d==="center-top"?(n=(f-o)/2,a=0):[n,a]=d}return{width:o,height:i,top:a,left:n}}static async create(e,r,o){e.maxExplorerID+=1;let{width:i,height:n,top:a,left:s}=this.genExplorerPosition(r),[l,c]=await Ue.workspace.nvim.call("coc_explorer#open_explorer",[e.maxExplorerID,r.position,{width:i,height:n,left:s,top:a,focus:r.focus,border_enable:o.get("floating.border.enable"),border_chars:o.get("floating.border.chars"),title:o.get("floating.border.title")}]),f=new pt(e.maxExplorerID,e,l,c,o);return await f.inited.set(!0),f}dispose(){this.floatingPreview.dispose(),this.disposables.forEach(e=>e.dispose())}get root(){if(!this.root_)throw Error("Explorer root not initialized yet");return this.root_}get args(){if(!this.args_)throw Error("Explorer args not initialized yet");return this.args_}get argValues(){if(!this.argValues_)throw Error("Explorer argValues not initialized yet");return this.argValues_}get isFloating(){if(this.isFloating_===void 0)throw Error("Explorer isFloating not initialized yet");return this.isFloating_}get sources(){if(!this.sources_)throw Error("Explorer sources not initialized yet");return this.sources_}get height(){return se(this.sources.map(e=>e.height))}get win(){return this.winid.then(Vl)}get winnr(){return ji(this.bufnr)}get winid(){return this.winnr.then(ql)}get borderWin(){return this.borderWinid.then(Vl)}get borderWinnr(){return ji(this.borderBufnr)}get borderWinid(){return this.borderWinnr.then(ql)}async sourceWinnr(){let e=await this.sourceWinid.get();if(!e)return;let r=await this.nvim.call("win_id2win",[e]);if(!(r<=0||(await this.explorerManager.winnrs()).includes(r)))return r}async sourceBufnrBySourceWinid(){let e=await this.sourceWinid.get();if(!e)return;let r=await this.nvim.call("winbufnr",[e]);if(!(r<=0))return r}async sourceBuffer(){let e=await this.sourceBufnr.get();if(!!e)return this.nvim.createBuffer(e)}visible(){let e=this.explorerManager.bufManager.getBufferNode(this.bufnr);return e==null?void 0:e.visible}async refreshWidth(){let e=await this.win;if(!e)return;let r=async(o,i)=>{if(i<=0){let n;if(o==="win-width"?(n=await e.width,(await e.getOption("relativenumber")||await e.getOption("number"))&&(n-=await e.getOption("numberwidth"))):o==="vim-width"&&(n=await Ue.workspace.nvim.eval("&columns")),n)return this.contentWidth=n+i,!0}else return this.contentWidth=i,!0;return!1};this.isFloating&&await r("win-width",this.argValues.floatingContentWidth)||await r(this.argValues.contentWidthType,this.argValues.contentWidth)}async resize(e){let r=pt.genExplorerPosition(this.argValues,e),{top:o,left:i,width:n,height:a}=r;await this.nvim.call("coc_explorer#resize",[this.bufnr,this.argValues.position,{width:n,height:a,left:i,top:o,border_bufnr:this.borderBufnr,border_enable:this.config.get("floating.border.enable"),border_chars:this.config.get("floating.border.chars"),title:this.config.get("floating.border.title")}])}async focus(){let e=await this.win;return e?(await this.nvim.command(`${await e.number}wincmd w`),await this.resize(),!0):!1}async resume(e){let{width:r,height:o,top:i,left:n}=pt.genExplorerPosition(e);await this.nvim.call("coc_explorer#resume",[this.bufnr,e.position,{width:r,height:o,left:n,top:i,focus:e.focus,border_bufnr:this.borderBufnr,border_enable:this.config.get("floating.border.enable"),border_chars:this.config.get("floating.border.chars"),title:this.config.get("floating.border.title")}])}async open(e,r,o){let i;this.firstOpened?i=!1:(i=!0,this.firstOpened=!0),i&&await this.events.fire("first-open-pre"),await this.events.fire("open-pre"),await Ya("CocExplorerOpenPre"),this.rooter=r.open(this),this.view.isHelpUI&&await this.quitHelp(),await this.highlight.bootSyntax();let n=await this.initArgs(e,this.rooter);for(let a of this.sources)await a.bootOpen(o);await this.view.sync(async a=>{let s=[];n&&s.push(this.clearLinesNotifier()),s.push(await this.loadAllNotifier(a),...await Promise.all(a.rendererSources().map(l=>l.source.openedNotifier(l,o)))),await E.runAll(s),await Ya("CocExplorerOpenPost"),await this.events.fire("open-post"),i&&await this.events.fire("first-open-post")})}async tryQuitOnOpenNotifier(){return this.argValues.quitOnOpen||this.isFloating?this.quitNotifier():E.noop()}async tryQuitOnOpen(){return E.run(this.tryQuitOnOpenNotifier())}async hide(){this.isHide=!0,await this.quit(!0)}async show(){this.isHide&&(this.isHide=!1,await this.resume(this.argValues))}async quitNotifier(e=!1){e||await Ya("CocExplorerQuitPre");let r=await this.sourceWinnr(),o=await Xe();return E.create(()=>{r&&this.bufnr===o&&this.nvim.command(`${r}wincmd w`,!0),Ul([this.bufnr]).notify(),e||dc("CocExplorerQuitPost").notify()})}async quit(e=!1){return E.run(await this.quitNotifier(e))}async initRoot(e,r){let o=e.rootUri;if(o){this.root_=le(o);return}let i;ma(this.config,this.argValues.revealWhenOpen)&&(i=await this.revealPath());let n=await r.resolveRoot(i,this.argValues.rootStrategies);if(n){this.root_=le(n);return}this.root_=le(Ue.workspace.cwd)}async initArgs(e,r){var s;this.args_=e,this.argValues_=await e.values(Ae),await this.initRoot(this.argValues_,r);let o=await e.value(Ae.sources);if(!o)return!1;let i=await(0,rb.default)(o,l=>Ct.enabled(l.name)),n=JSON.stringify(i);if(this.prevArgSourcesEnabledJson&&this.prevArgSourcesEnabledJson===n)return!1;this.prevArgSourcesEnabledJson=n,(0,Ue.disposeAll)((s=this.sources_)!=null?s:[]),this.sources_=i.map(l=>Ct.createSource(l.name,this,l.expand));let a=await this.args_.value(Ae.position);return this.isFloating_=a.name==="floating",!0}async revealPath(){var r,o;let e=await this.args.value(Ae.reveal);if(e)return e;{let i=await this.sourceBuffer();if(i)return(o=(r=this.explorerManager.bufManager.getBufferNode(i.id))==null?void 0:r.fullpath)!=null?o:void 0}}async getSelectedOrCursorLineIndexes(e){await this.view.refreshLineIndex();let r=new Set;if(e==="v"){let o=await Ue.window.getSelectedRange("v");if(o){let i=o.start.line,n=o.end.character!==0?o.end.line:o.end.line-1;for(let a=i;a<=n;a++)r.add(a);return r}}return r.add(this.view.currentLineIndex),r}findSourceByLineIndex(e){let r=this.sources.findIndex(o=>e<o.view.endLineIndex);if(r===-1){let o=this.sources.length-1;return{source:this.sources[o],sourceIndex:o}}else return{source:this.sources[r],sourceIndex:r}}lineIndexesGroupBySource(e){let r=new Map;for(let o of e){let{source:i,sourceIndex:n}=this.findSourceByLineIndex(o),a=r.get(n);a||(a={source:i,lineIndexes:[o]},r.set(n,a)),a.lineIndexes.push(o)}return[...r.values()]}setLinesNotifier(e,r,o){return E.create(()=>{this.nvim.call("coc_explorer#util#buf_set_lines_skip_cursor",[this.bufnr,r,o,!1,e],!0)})}clearLinesNotifier(){return this.setLinesNotifier([],0,-1)}async loadAllNotifier(e,{render:r=!0}={}){this.locator.mark.removeAll();let o=await Promise.all(e.rendererSources().map(i=>i.source.loadNotifier(i,i.view.rootNode,{render:!1})));return r&&o.push(await e.renderAllNotifier()),E.combine(o)}async render(){return this.view.sync(e=>E.run(e.renderAllNotifier()))}async showHelp(e){return Ww(this,e)}async quitHelp(){return _c(this)}};var Nf=require("coc.nvim"),vr=_(require("path"));var _s=class{constructor(e){this.workspaceRoot=e}open(e){return new Tf(this.workspaceRoot,e)}},Tf=class{constructor(e,r){this.workspaceRoot=e;this.explorer=r;this.customRoots={};let o=this,i=null,n=async()=>(i===null&&(i=await o.resolveBufFullpath()),i);this.roots={keep:()=>{},workspace:()=>e,cwd:()=>Nf.workspace.cwd,sourceBuffer:()=>n(),reveal:a=>a?vr.default.dirname(a):void 0}}async resolveRootByPatterns(e,r,o){let n=le(e).split(vr.default.sep);if(o){for(;n.length>0;){let a=n.join(vr.default.sep);if(await jl(a,r))return a;n.pop()}return}else{let a=[n.shift()];for(let s of n){a.push(s);let l=a.join(vr.default.sep);if(await jl(l,r))return l}return}}async resolveRootBy(e,r){var n;let o=r,i="custom:";if(os.includes(o))return this.roots[o](e);if(o.startsWith(i)){let a=o.slice(i.length),l=this.explorer.config.get("root.customRules")[a],c=Nf.workspace.cwd,f=await this.roots.sourceBuffer();if(f&&(c=f.endsWith(vr.default.sep)?f:vr.default.dirname(f)),l)return await this.resolveRootByPatterns(c,l.patterns,(n=l.bottomUp)!=null?n:!1)}v.error(`${r} is not supported`)}async resolveRoot(e,r){if(!r.includes("keep"))for(let o of r){let i=await this.resolveRootBy(e,o);if(!!i&&(!e||va(i,e)))return i}}async resolveBufFullpath(){var i;let e=await this.explorer.sourceBuffer();if(!e||await e.getVar("&buftype")==="nofile")return;let o=(i=this.explorer.explorerManager.bufManager.getBufferNode(e.id))==null?void 0:i.fullpath;if(!!o)return le(vr.default.dirname(o))}};var Ms=class{constructor(e,r){this.context=e;this.bufManager=r;this.filetype="coc-explorer";this.previousBufnr=new Ji("previousBufnr");this.previousWindowID=new Ji("previousWindowID");this.maxExplorerID=0;this.nvim=ro.workspace.nvim;this.events=new ht(v);this.waitInited=Yi(jg(this.events,"inited"));Xe().then(this.updatePrevCtxVars.bind(this)).catch(v.error),this.context.subscriptions.push(Vr(async o=>{await this.updatePrevCtxVars(o)},0)),this.context.subscriptions.push(ro.Disposable.create(()=>(0,ro.disposeAll)(this.explorers())))}async updatePrevCtxVars(e){if(!this.bufnrs().includes(e)){let r=await this.nvim.call("bufname");if(r.startsWith("list://")||r.startsWith("[coc-explorer]"))return;if(await this.nvim.getVar("&filetype")!==this.filetype){await this.previousBufnr.set(e);let i=await this.nvim.call("win_getid");await this.previousWindowID.set(i===-1?void 0:i)}}}async prevWinnrByPrevBufnr(){let e=await this.previousBufnr.get();if(!e)return;let r=await this.nvim.call("bufwinnr",[e]);if(!(r<=0||(await this.winnrs()).includes(r)))return r}async prevWinnrByPrevWindowID(){let e=await this.previousWindowID.get();if(!e)return;let r=await this.nvim.call("win_id2win",[e]);if(!(r<=0||(await this.winnrs()).includes(r)))return r}bufnrs(){return this.explorers().map(e=>e.bufnr)}async winids(){return ue(await Promise.all(this.explorers().map(e=>e.winid)))}async winnrs(){let e=await oe.currentTabContainer(),r=e==null?void 0:e.all();return r?(await Promise.all(r.map(i=>i.winnr))).filter(i=>i!==void 0):[]}explorers(){let e=[];for(let r of oe.values())e.push(...r.all());return e}async currentExplorer(){return this.explorerByBufnr(await Xe())}async explorerByWinid(e){for(let r of this.explorers())if(await r.winid===e)return r}explorerByBufnr(e){return this.explorers().find(r=>r.bufnr===e)}async inExplorer(){return await this.currentExplorer()!==void 0}async open(e){var h;await this.waitInited;let r=!0,o=da(),i=ph(o),n=await R.parse(e,o),a=await n.values(Ae),s=a.position;if(s.name==="floating"&&!Lh())throw new Error("not support floating position in vim");let l=a.quit,c=s.name==="tab"?await oe.currentTabMaxId()+1:await oe.currentTabId(),f=oe.get(c),u=f.getExplorer(s);if(u&&l){await u.quit();return}let d=await this.nvim.call("win_getid"),p=await Xe(),m=new _s(ro.workspace.root);if(!u||!await this.nvim.call("bufexists",[u.bufnr]))u=await pt.create(this,a,i),f.setExplorer(s,u);else if(!await u.inited.get())await this.nvim.command(`bwipeout! ${u.bufnr}`),u=await pt.create(this,a,i),f.setExplorer(s,u);else{if(!await u.win)a.position.name==="floating"&&!await((h=await u.sourceBuffer())==null?void 0:h.loaded)?(await this.nvim.command(`bwipeout! ${u.bufnr}`),u=await pt.create(this,a,i),f.setExplorer(s,u)):await u.resume(a);else{if(await n.value(Ae.toggle)){await u.quit();return}if(await n.value(Ae.focus)){await u.focus();return}}r=!1}await u.sourceWinid.set(d),await u.sourceBufnr.set(p),await u.open(n,m,r)}};var ob=require("coc.nvim");var ks=class extends ob.BasicList{constructor(r){super(r);this.name="explPresets";this.defaultAction="do";this.description="explorer presets";this.addAction("do",async o=>{this.nvim.command(`CocCommand explorer --preset ${o.data.name}`).catch(v.error)})}async loadItems(r){return[...(await Xa(da())).keys()].map(i=>({label:i,data:{name:i}}))}doHighlight(){let{nvim:r}=this;r.pauseNotification(),r.command("syntax match CocExplorerPreset /.*/",!0),r.command("highlight default link CocExplorerPreset PreProc",!0),r.resumeNotification().catch(v.error)}};var Ls=require("coc.nvim"),Sf=_(require("path"));var ib=require("coc.nvim");function nb(t,e){if(t[0]==="leaf")return{type:t[0],winid:t[1],parent:e};{let r={type:t[0],children:[]};return r.children=t[1].map((o,i)=>nb(o,{group:r,indexInParent:i})),r}}var Rs=class{constructor(e){this.root=e}static async create(){let e=await ib.workspace.nvim.call("winlayout",[]);return new this(nb(e))}static getFirstLeafWinid(e){return e.type==="leaf"?e.winid:this.getFirstLeafWinid(e.children[0])}findWinid(e,r=this.root){if(r.type==="leaf"){if(r.winid===e)return r}else for(let o of r.children){let i=this.findWinid(e,o);if(i)return i}}findClosest(e,r){let o=new Set([e]),i=[e];for(;i.length;){let n=i.shift();if(n.type==="leaf"){if(r.includes(n.winid))return n}else for(let a of n.children)if(!o.has(a)){i.push(a),o.add(a);continue}n.parent&&!o.has(n.parent.group)&&(i.push(n.parent.group),o.add(n.parent.group))}}};function dn(t,e){return Ls.commands.registerCommand(t,v.asyncCatch(e),void 0,!0)}async function ab(t,e){if(t==="closest"){let r=await Rs.create(),o=await Ls.workspace.nvim.eval("win_getid(winnr())");if(o<=-1)return;let i=r.findWinid(o);if(!i)return;let n=await e.winids();if(!n.length)return;let a=r.findClosest(i,n);if(a)return e.explorerByWinid(a.winid);{let s=await oe.currentTabContainer(),l=s==null?void 0:s.floating;if(await(l==null?void 0:l.winnr)!==void 0)return l}}else return t===0?e.currentExplorer():e.explorerByBufnr(t)}async function sb(t,e){if(t==="current")return e.view.currentLineIndex;if(typeof t=="number")return t;if(Array.isArray(t)){let[r,o,i]=t;if(r==="relative"){let n=i?e.sources.find(a=>a.sourceType===i):await e.view.currentSource();if(n)return n.view.startLineIndex+o}}}async function U1(t,e){var n;let r=await sb(t,e);if(!r)return[void 0,void 0];let o=e.sources.find(a=>r>=a.view.startLineIndex&&r<a.view.endLineIndex);if(!o)return[void 0,void 0];let i=r-o.view.startLineIndex;return[o,(n=o.view.flattenedNodes[i])!=null?n:void 0]}function lb(t,e){async function r(o,i,n=["current"],a="n",s=1){let l=await ab(o,e);if(!l)return;await l.view.refreshLineIndex();let c=ue(await Promise.all(n.map(async f=>await sb(f,l))));await l.action.doActionExp(qr(i),{mode:a,count:s,lineIndexes:c}).catch(v.error)}t.subscriptions.push(dn("explorer.doAction",r),dn("explorer.doCodeAction",async(o,i,n)=>{let a=await r(0,{name:i,args:await n()});return await Yo.add(o),a}),dn("explorer.getNodeInfo",async(o,i="current")=>{let n=await ab(o,e);if(!n)return;await n.view.refreshLineIndex();let[,a]=await U1(i,n);if(!!a)return U(S({},a),{compactedNodes:void 0,parent:void 0,children:void 0,prevSiblingNode:void 0,nextSiblingNode:void 0})}),dn("explorer.getIcon",async(o,i=!1,n)=>{let a=Sf.default.basename(o),s=i?"directories":"files",c=await sn("builtin",[{fullname:a,isDirectory:i,expanded:n,hidden:!1}]);return c==null?void 0:c[s].get(a)}),dn("explorer.getIcons",async o=>{let i={},n=o.map(l=>{let c=Sf.default.basename(l.filepath);return i[c]=l.filepath,{fullname:c,isDirectory:l.isDirectory,expanded:l.isExpanded,hidden:!1}}),a=await sn("builtin",n);if(!a)return;let s={files:{},directories:{}};for(let[l,c]of a.files)s.files[i[l]]=c;for(let[l,c]of a.directories)s.directories[i[l]]=c;return s}))}var q1=t=>{let{subscriptions:e}=t,{nvim:r}=Er.workspace,o=C.get("debug");v.level=o?"debug":"info",D.createGroup("SelectUI","ctermbg=27 ctermfg=0 guibg=#1593e5 guifg=#ffffff");let i=D.linkGroup("NormalFloat","NormalFloat");D.linkGroup("NormalFloatBorder",i.group),Er.listManager.registerList(new ks(r));let n=new Ka(t),a=new Ms(t,n);lb(t,a),ct.preload().catch(v.error),e.push(Er.commands.registerCommand("explorer",v.asyncCatch((...s)=>{a.open(s).catch(v.error)})),Er.languages.registerCodeActionProvider(["coc-explorer"],new Va(a),"coc-explorer")),(async()=>{await Qf(t),await Xi.register(t),await Dh(t.extensionPath),await r.command("runtime plugin/coc_explorer.vim"),Jw(e),Hw(e),await Lw(t,a),await a.events.fire("inited"),await oe.initedEmitter.fire(),n.reload().catch(v.error),await oe.register()})().catch(v.error)};0&&(module.exports={activate});
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
